import{c as Mn,u as Yu,r as Bn,j as L,B as ia,P as Qu,T as Ct,s as Zu,ah as Xu}from"./index-CL14asXn.js";import{I as ef}from"./InputOutputLayout.component-2nQ5MSfz.js";import{C as tf}from"./CodeEditor.component-B0O-GlEp.js";import{S as rf}from"./index-XRM7WuMU.js";import{R as nf}from"./ArrowRightOutlined-HowPytUt.js";import{L as Et}from"./index-Bvb3zhba.js";import"./editorWorker-CA1WEzK_.js";import"./gapSize-U1swVQyS.js";import"./row-CBWABfhz.js";import"./useShowArrow-DiEGc7f5.js";import"./DownOutlined-BiTJ3hY-.js";import"./useForceUpdate-CS2awsVR.js";import"./index-BeRW1Gfk.js";/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var na;(function(r){(function(e){var t=typeof globalThis=="object"?globalThis:typeof Mn=="object"?Mn:typeof self=="object"?self:typeof this=="object"?this:u(),i=n(r);typeof t.Reflect<"u"&&(i=n(t.Reflect,i)),e(i,t),typeof t.Reflect>"u"&&(t.Reflect=r);function n(l,p){return function(A,S){Object.defineProperty(l,A,{configurable:!0,writable:!0,value:S}),p&&p(A,S)}}function s(){try{return Function("return this;")()}catch{}}function a(){try{return(0,eval)("(function() { return this; })()")}catch{}}function u(){return s()||a()}})(function(e,t){var i=Object.prototype.hasOwnProperty,n=typeof Symbol=="function",s=n&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",a=n&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",u=typeof Object.create=="function",l={__proto__:[]}instanceof Array,p=!u&&!l,A={create:u?function(){return xn(Object.create(null))}:l?function(){return xn({__proto__:null})}:function(){return xn({})},has:p?function(d,v){return i.call(d,v)}:function(d,v){return v in d},get:p?function(d,v){return i.call(d,v)?d[v]:void 0}:function(d,v){return d[v]}},S=Object.getPrototypeOf(Function),z=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Gu(),N=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Wu(),f=typeof WeakMap=="function"?WeakMap:qu(),y=n?Symbol.for("@reflect-metadata:registry"):void 0,b=Lu(),m=Fu(b);function k(d,v,g,B){if(_(g)){if(!Jo(d))throw new TypeError;if(!Yo(v))throw new TypeError;return Vu(d,v)}else{if(!Jo(d))throw new TypeError;if(!Z(v))throw new TypeError;if(!Z(B)&&!_(B)&&!kt(B))throw new TypeError;return kt(B)&&(B=void 0),g=Te(g),Ru(d,v,g,B)}}e("decorate",k);function I(d,v){function g(B,M){if(!Z(B))throw new TypeError;if(!_(M)&&!$u(M))throw new TypeError;zo(d,v,B,M)}return g}e("metadata",I);function q(d,v,g,B){if(!Z(g))throw new TypeError;return _(B)||(B=Te(B)),zo(d,v,g,B)}e("defineMetadata",q);function Mr(d,v,g){if(!Z(v))throw new TypeError;return _(g)||(g=Te(g)),Ho(d,v,g)}e("hasMetadata",Mr);function _r(d,v,g){if(!Z(v))throw new TypeError;return _(g)||(g=Te(g)),wn(d,v,g)}e("hasOwnMetadata",_r);function ir(d,v,g){if(!Z(v))throw new TypeError;return _(g)||(g=Te(g)),Lo(d,v,g)}e("getMetadata",ir);function Ou(d,v,g){if(!Z(v))throw new TypeError;return _(g)||(g=Te(g)),Fo(d,v,g)}e("getOwnMetadata",Ou);function ju(d,v){if(!Z(d))throw new TypeError;return _(v)||(v=Te(v)),Go(d,v)}e("getMetadataKeys",ju);function Tu(d,v){if(!Z(d))throw new TypeError;return _(v)||(v=Te(v)),Wo(d,v)}e("getOwnMetadataKeys",Tu);function Pu(d,v,g){if(!Z(v))throw new TypeError;if(_(g)||(g=Te(g)),!Z(v))throw new TypeError;_(g)||(g=Te(g));var B=nr(v,g,!1);return _(B)?!1:B.OrdinaryDeleteMetadata(d,v,g)}e("deleteMetadata",Pu);function Vu(d,v){for(var g=d.length-1;g>=0;--g){var B=d[g],M=B(v);if(!_(M)&&!kt(M)){if(!Yo(M))throw new TypeError;v=M}}return v}function Ru(d,v,g,B){for(var M=d.length-1;M>=0;--M){var re=d[M],X=re(v,g,B);if(!_(X)&&!kt(X)){if(!Z(X))throw new TypeError;B=X}}return B}function Ho(d,v,g){var B=wn(d,v,g);if(B)return!0;var M=Sn(v);return kt(M)?!1:Ho(d,M,g)}function wn(d,v,g){var B=nr(v,g,!1);return _(B)?!1:Ko(B.OrdinaryHasOwnMetadata(d,v,g))}function Lo(d,v,g){var B=wn(d,v,g);if(B)return Fo(d,v,g);var M=Sn(v);if(!kt(M))return Lo(d,M,g)}function Fo(d,v,g){var B=nr(v,g,!1);if(!_(B))return B.OrdinaryGetOwnMetadata(d,v,g)}function zo(d,v,g,B){var M=nr(g,B,!0);M.OrdinaryDefineOwnMetadata(d,v,g,B)}function Go(d,v){var g=Wo(d,v),B=Sn(d);if(B===null)return g;var M=Go(B,v);if(M.length<=0)return g;if(g.length<=0)return M;for(var re=new N,X=[],$=0,O=g;$<O.length;$++){var P=O[$],V=re.has(P);V||(re.add(P),X.push(P))}for(var D=0,H=M;D<H.length;D++){var P=H[D],V=re.has(P);V||(re.add(P),X.push(P))}return X}function Wo(d,v){var g=nr(d,v,!1);return g?g.OrdinaryOwnMetadataKeys(d,v):[]}function qo(d){if(d===null)return 1;switch(typeof d){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return d===null?1:6;default:return 6}}function _(d){return d===void 0}function kt(d){return d===null}function Du(d){return typeof d=="symbol"}function Z(d){return typeof d=="object"?d!==null:typeof d=="function"}function Mu(d,v){switch(qo(d)){case 0:return d;case 1:return d;case 2:return d;case 3:return d;case 4:return d;case 5:return d}var g="string",B=Qo(d,s);if(B!==void 0){var M=B.call(d,g);if(Z(M))throw new TypeError;return M}return _u(d)}function _u(d,v){var g,B;{var M=d.toString;if(Ur(M)){var B=M.call(d);if(!Z(B))return B}var g=d.valueOf;if(Ur(g)){var B=g.call(d);if(!Z(B))return B}}throw new TypeError}function Ko(d){return!!d}function Uu(d){return""+d}function Te(d){var v=Mu(d);return Du(v)?v:Uu(v)}function Jo(d){return Array.isArray?Array.isArray(d):d instanceof Object?d instanceof Array:Object.prototype.toString.call(d)==="[object Array]"}function Ur(d){return typeof d=="function"}function Yo(d){return typeof d=="function"}function $u(d){switch(qo(d)){case 3:return!0;case 4:return!0;default:return!1}}function An(d,v){return d===v||d!==d&&v!==v}function Qo(d,v){var g=d[v];if(g!=null){if(!Ur(g))throw new TypeError;return g}}function Zo(d){var v=Qo(d,a);if(!Ur(v))throw new TypeError;var g=v.call(d);if(!Z(g))throw new TypeError;return g}function Xo(d){return d.value}function ea(d){var v=d.next();return v.done?!1:v}function ta(d){var v=d.return;v&&v.call(d)}function Sn(d){var v=Object.getPrototypeOf(d);if(typeof d!="function"||d===S||v!==S)return v;var g=d.prototype,B=g&&Object.getPrototypeOf(g);if(B==null||B===Object.prototype)return v;var M=B.constructor;return typeof M!="function"||M===d?v:M}function Hu(){var d;!_(y)&&typeof t.Reflect<"u"&&!(y in t.Reflect)&&typeof t.Reflect.defineMetadata=="function"&&(d=zu(t.Reflect));var v,g,B,M=new f,re={registerProvider:X,getProvider:O,setProvider:V};return re;function X(D){if(!Object.isExtensible(re))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case d===D:break;case _(v):v=D;break;case v===D:break;case _(g):g=D;break;case g===D:break;default:B===void 0&&(B=new N),B.add(D);break}}function $(D,H){if(!_(v)){if(v.isProviderFor(D,H))return v;if(!_(g)){if(g.isProviderFor(D,H))return v;if(!_(B))for(var K=Zo(B);;){var Q=ea(K);if(!Q)return;var ke=Xo(Q);if(ke.isProviderFor(D,H))return ta(K),ke}}}if(!_(d)&&d.isProviderFor(D,H))return d}function O(D,H){var K=M.get(D),Q;return _(K)||(Q=K.get(H)),_(Q)&&(Q=$(D,H),_(Q)||(_(K)&&(K=new z,M.set(D,K)),K.set(H,Q))),Q}function P(D){if(_(D))throw new TypeError;return v===D||g===D||!_(B)&&B.has(D)}function V(D,H,K){if(!P(K))throw new Error("Metadata provider not registered.");var Q=O(D,H);if(Q!==K){if(!_(Q))return!1;var ke=M.get(D);_(ke)&&(ke=new z,M.set(D,ke)),ke.set(H,K)}return!0}}function Lu(){var d;return!_(y)&&Z(t.Reflect)&&Object.isExtensible(t.Reflect)&&(d=t.Reflect[y]),_(d)&&(d=Hu()),!_(y)&&Z(t.Reflect)&&Object.isExtensible(t.Reflect)&&Object.defineProperty(t.Reflect,y,{enumerable:!1,configurable:!1,writable:!1,value:d}),d}function Fu(d){var v=new f,g={isProviderFor:function(P,V){var D=v.get(P);return _(D)?!1:D.has(V)},OrdinaryDefineOwnMetadata:X,OrdinaryHasOwnMetadata:M,OrdinaryGetOwnMetadata:re,OrdinaryOwnMetadataKeys:$,OrdinaryDeleteMetadata:O};return b.registerProvider(g),g;function B(P,V,D){var H=v.get(P),K=!1;if(_(H)){if(!D)return;H=new z,v.set(P,H),K=!0}var Q=H.get(V);if(_(Q)){if(!D)return;if(Q=new z,H.set(V,Q),!d.setProvider(P,V,g))throw H.delete(V),K&&v.delete(P),new Error("Wrong provider for target.")}return Q}function M(P,V,D){var H=B(V,D,!1);return _(H)?!1:Ko(H.has(P))}function re(P,V,D){var H=B(V,D,!1);if(!_(H))return H.get(P)}function X(P,V,D,H){var K=B(D,H,!0);K.set(P,V)}function $(P,V){var D=[],H=B(P,V,!1);if(_(H))return D;for(var K=H.keys(),Q=Zo(K),ke=0;;){var ra=ea(Q);if(!ra)return D.length=ke,D;var Ku=Xo(ra);try{D[ke]=Ku}catch(Ju){try{ta(Q)}finally{throw Ju}}ke++}}function O(P,V,D){var H=B(V,D,!1);if(_(H)||!H.delete(P))return!1;if(H.size===0){var K=v.get(V);_(K)||(K.delete(D),K.size===0&&v.delete(K))}return!0}}function zu(d){var v=d.defineMetadata,g=d.hasOwnMetadata,B=d.getOwnMetadata,M=d.getOwnMetadataKeys,re=d.deleteMetadata,X=new f,$={isProviderFor:function(O,P){var V=X.get(O);return!_(V)&&V.has(P)?!0:M(O,P).length?(_(V)&&(V=new N,X.set(O,V)),V.add(P),!0):!1},OrdinaryDefineOwnMetadata:v,OrdinaryHasOwnMetadata:g,OrdinaryGetOwnMetadata:B,OrdinaryOwnMetadataKeys:M,OrdinaryDeleteMetadata:re};return $}function nr(d,v,g){var B=b.getProvider(d,v);if(!_(B))return B;if(g){if(b.setProvider(d,v,m))return m;throw new Error("Illegal state.")}}function Gu(){var d={},v=[],g=function(){function $(O,P,V){this._index=0,this._keys=O,this._values=P,this._selector=V}return $.prototype["@@iterator"]=function(){return this},$.prototype[a]=function(){return this},$.prototype.next=function(){var O=this._index;if(O>=0&&O<this._keys.length){var P=this._selector(this._keys[O],this._values[O]);return O+1>=this._keys.length?(this._index=-1,this._keys=v,this._values=v):this._index++,{value:P,done:!1}}return{value:void 0,done:!0}},$.prototype.throw=function(O){throw this._index>=0&&(this._index=-1,this._keys=v,this._values=v),O},$.prototype.return=function(O){return this._index>=0&&(this._index=-1,this._keys=v,this._values=v),{value:O,done:!0}},$}(),B=function(){function $(){this._keys=[],this._values=[],this._cacheKey=d,this._cacheIndex=-2}return Object.defineProperty($.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),$.prototype.has=function(O){return this._find(O,!1)>=0},$.prototype.get=function(O){var P=this._find(O,!1);return P>=0?this._values[P]:void 0},$.prototype.set=function(O,P){var V=this._find(O,!0);return this._values[V]=P,this},$.prototype.delete=function(O){var P=this._find(O,!1);if(P>=0){for(var V=this._keys.length,D=P+1;D<V;D++)this._keys[D-1]=this._keys[D],this._values[D-1]=this._values[D];return this._keys.length--,this._values.length--,An(O,this._cacheKey)&&(this._cacheKey=d,this._cacheIndex=-2),!0}return!1},$.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=d,this._cacheIndex=-2},$.prototype.keys=function(){return new g(this._keys,this._values,M)},$.prototype.values=function(){return new g(this._keys,this._values,re)},$.prototype.entries=function(){return new g(this._keys,this._values,X)},$.prototype["@@iterator"]=function(){return this.entries()},$.prototype[a]=function(){return this.entries()},$.prototype._find=function(O,P){if(!An(this._cacheKey,O)){this._cacheIndex=-1;for(var V=0;V<this._keys.length;V++)if(An(this._keys[V],O)){this._cacheIndex=V;break}}return this._cacheIndex<0&&P&&(this._cacheIndex=this._keys.length,this._keys.push(O),this._values.push(void 0)),this._cacheIndex},$}();return B;function M($,O){return $}function re($,O){return O}function X($,O){return[$,O]}}function Wu(){var d=function(){function v(){this._map=new z}return Object.defineProperty(v.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),v.prototype.has=function(g){return this._map.has(g)},v.prototype.add=function(g){return this._map.set(g,g),this},v.prototype.delete=function(g){return this._map.delete(g)},v.prototype.clear=function(){this._map.clear()},v.prototype.keys=function(){return this._map.keys()},v.prototype.values=function(){return this._map.keys()},v.prototype.entries=function(){return this._map.entries()},v.prototype["@@iterator"]=function(){return this.keys()},v.prototype[a]=function(){return this.keys()},v}();return d}function qu(){var d=16,v=A.create(),g=B();return function(){function O(){this._key=B()}return O.prototype.has=function(P){var V=M(P,!1);return V!==void 0?A.has(V,this._key):!1},O.prototype.get=function(P){var V=M(P,!1);return V!==void 0?A.get(V,this._key):void 0},O.prototype.set=function(P,V){var D=M(P,!0);return D[this._key]=V,this},O.prototype.delete=function(P){var V=M(P,!1);return V!==void 0?delete V[this._key]:!1},O.prototype.clear=function(){this._key=B()},O}();function B(){var O;do O="@@WeakMap@@"+$();while(A.has(v,O));return v[O]=!0,O}function M(O,P){if(!i.call(O,g)){if(!P)return;Object.defineProperty(O,g,{value:A.create()})}return O[g]}function re(O,P){for(var V=0;V<P;++V)O[V]=Math.random()*255|0;return O}function X(O){if(typeof Uint8Array=="function"){var P=new Uint8Array(O);return typeof crypto<"u"?crypto.getRandomValues(P):typeof msCrypto<"u"?msCrypto.getRandomValues(P):re(P,O),P}return re(new Array(O),O)}function $(){var O=X(d);O[6]=O[6]&79|64,O[8]=O[8]&191|128;for(var P="",V=0;V<d;++V){var D=O[V];(V===4||V===6||V===8)&&(P+="-"),D<16&&(P+="0"),P+=D.toString(16).toLowerCase()}return P}}function xn(d){return d.__=void 0,delete d.__,d}})})(na||(na={}));/*!
 * MIT License
 * 
 * Copyright (c) 2017-2024 Peculiar Ventures, LLC
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */const sf="[object ArrayBuffer]";class C{static isArrayBuffer(e){return Object.prototype.toString.call(e)===sf}static toArrayBuffer(e){return this.isArrayBuffer(e)?e:e.byteLength===e.buffer.byteLength||e.byteOffset===0&&e.byteLength===e.buffer.byteLength?e.buffer:this.toUint8Array(e.buffer).slice(e.byteOffset,e.byteOffset+e.byteLength).buffer}static toUint8Array(e){return this.toView(e,Uint8Array)}static toView(e,t){if(e.constructor===t)return e;if(this.isArrayBuffer(e))return new t(e);if(this.isArrayBufferView(e))return new t(e.buffer,e.byteOffset,e.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}static isEqual(e,t){const i=C.toUint8Array(e),n=C.toUint8Array(t);if(i.length!==n.byteLength)return!1;for(let s=0;s<i.length;s++)if(i[s]!==n[s])return!1;return!0}static concat(...e){let t;Array.isArray(e[0])&&!(e[1]instanceof Function)||Array.isArray(e[0])&&e[1]instanceof Function?t=e[0]:e[e.length-1]instanceof Function?t=e.slice(0,e.length-1):t=e;let i=0;for(const a of t)i+=a.byteLength;const n=new Uint8Array(i);let s=0;for(const a of t){const u=this.toUint8Array(a);n.set(u,s),s+=u.length}return e[e.length-1]instanceof Function?this.toView(n,e[e.length-1]):n.buffer}}const In="string",of=/^[0-9a-f\s]+$/i,af=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,cf=/^[a-zA-Z0-9-_]+$/;class sa{static fromString(e){const t=unescape(encodeURIComponent(e)),i=new Uint8Array(t.length);for(let n=0;n<t.length;n++)i[n]=t.charCodeAt(n);return i.buffer}static toString(e){const t=C.toUint8Array(e);let i="";for(let s=0;s<t.length;s++)i+=String.fromCharCode(t[s]);return decodeURIComponent(escape(i))}}class Pe{static toString(e,t=!1){const i=C.toArrayBuffer(e),n=new DataView(i);let s="";for(let a=0;a<i.byteLength;a+=2){const u=n.getUint16(a,t);s+=String.fromCharCode(u)}return s}static fromString(e,t=!1){const i=new ArrayBuffer(e.length*2),n=new DataView(i);for(let s=0;s<e.length;s++)n.setUint16(s*2,e.charCodeAt(s),t);return i}}class R{static isHex(e){return typeof e===In&&of.test(e)}static isBase64(e){return typeof e===In&&af.test(e)}static isBase64Url(e){return typeof e===In&&cf.test(e)}static ToString(e,t="utf8"){const i=C.toUint8Array(e);switch(t.toLowerCase()){case"utf8":return this.ToUtf8String(i);case"binary":return this.ToBinary(i);case"hex":return this.ToHex(i);case"base64":return this.ToBase64(i);case"base64url":return this.ToBase64Url(i);case"utf16le":return Pe.toString(i,!0);case"utf16":case"utf16be":return Pe.toString(i);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromString(e,t="utf8"){if(!e)return new ArrayBuffer(0);switch(t.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);case"utf16le":return Pe.fromString(e,!0);case"utf16":case"utf16be":return Pe.fromString(e);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToBase64(e){const t=C.toUint8Array(e);if(typeof btoa<"u"){const i=this.ToString(t,"binary");return btoa(i)}else return Buffer.from(t).toString("base64")}static FromBase64(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!R.isBase64(t))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return typeof atob<"u"?this.FromBinary(atob(t)):new Uint8Array(Buffer.from(t,"base64")).buffer}static FromBase64Url(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!R.isBase64Url(t))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(t.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e,t=R.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.FromBinary(e);case"utf8":return sa.fromString(e);case"utf16":case"utf16be":return Pe.fromString(e);case"utf16le":case"usc2":return Pe.fromString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToUtf8String(e,t=R.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.ToBinary(e);case"utf8":return sa.toString(e);case"utf16":case"utf16be":return Pe.toString(e);case"utf16le":case"usc2":return Pe.toString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromBinary(e){const t=e.length,i=new Uint8Array(t);for(let n=0;n<t;n++)i[n]=e.charCodeAt(n);return i.buffer}static ToBinary(e){const t=C.toUint8Array(e);let i="";for(let n=0;n<t.length;n++)i+=String.fromCharCode(t[n]);return i}static ToHex(e){const t=C.toUint8Array(e);let i="";const n=t.length;for(let s=0;s<n;s++){const a=t[s];a<16&&(i+="0"),i+=a.toString(16)}return i}static FromHex(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!R.isHex(t))throw new TypeError("Argument 'hexString' is not HEX encoded");t.length%2&&(t=`0${t}`);const i=new Uint8Array(t.length/2);for(let n=0;n<t.length;n=n+2){const s=t.slice(n,n+2);i[n/2]=parseInt(s,16)}return i.buffer}static ToUtf16String(e,t=!1){return Pe.toString(e,t)}static FromUtf16String(e,t=!1){return Pe.fromString(e,t)}static Base64Padding(e){const t=4-e.length%4;if(t<4)for(let i=0;i<t;i++)e+="=";return e}static formatString(e){return(e==null?void 0:e.replace(/[\n\r\t ]/g,""))||""}}R.DEFAULT_UTF8_ENCODING="utf8";function lf(...r){const e=r.map(n=>n.byteLength).reduce((n,s)=>n+s),t=new Uint8Array(e);let i=0;return r.map(n=>new Uint8Array(n)).forEach(n=>{for(const s of n)t[i++]=s}),t.buffer}function Dc(r,e){if(!(r&&e)||r.byteLength!==e.byteLength)return!1;const t=new Uint8Array(r),i=new Uint8Array(e);for(let n=0;n<r.byteLength;n++)if(t[n]!==i[n])return!1;return!0}/*!
 Copyright (c) Peculiar Ventures, LLC
*/function Pt(r,e){let t=0;if(r.length===1)return r[0];for(let i=r.length-1;i>=0;i--)t+=r[r.length-1-i]*Math.pow(2,e*i);return t}function pt(r,e,t=-1){const i=t;let n=r,s=0,a=Math.pow(2,e);for(let u=1;u<8;u++){if(r<a){let l;if(i<0)l=new ArrayBuffer(u),s=u;else{if(i<u)return new ArrayBuffer(0);l=new ArrayBuffer(i),s=i}const p=new Uint8Array(l);for(let A=u-1;A>=0;A--){const S=Math.pow(2,A*e);p[s-A-1]=Math.floor(n/S),n-=p[s-A-1]*S}return l}a*=Math.pow(2,e)}return new ArrayBuffer(0)}function _n(...r){let e=0,t=0;for(const s of r)e+=s.length;const i=new ArrayBuffer(e),n=new Uint8Array(i);for(const s of r)n.set(s,t),t+=s.length;return n}function Mc(){const r=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const u=r[0]===255&&r[1]&128,l=r[0]===0&&(r[1]&128)===0;(u||l)&&this.warnings.push("Needlessly long format")}const e=new ArrayBuffer(this.valueHex.byteLength),t=new Uint8Array(e);for(let u=0;u<this.valueHex.byteLength;u++)t[u]=0;t[0]=r[0]&128;const i=Pt(t,8),n=new ArrayBuffer(this.valueHex.byteLength),s=new Uint8Array(n);for(let u=0;u<this.valueHex.byteLength;u++)s[u]=r[u];return s[0]&=127,Pt(s,8)-i}function uf(r){const e=r<0?r*-1:r;let t=128;for(let i=1;i<8;i++){if(e<=t){if(r<0){const a=t-e,u=pt(a,8,i),l=new Uint8Array(u);return l[0]|=128,u}let n=pt(e,8,i),s=new Uint8Array(n);if(s[0]&128){const a=n.slice(0),u=new Uint8Array(a);n=new ArrayBuffer(n.byteLength+1),s=new Uint8Array(n);for(let l=0;l<a.byteLength;l++)s[l+1]=u[l];s[0]=0}return n}t*=Math.pow(2,8)}return new ArrayBuffer(0)}function ff(r,e){if(r.byteLength!==e.byteLength)return!1;const t=new Uint8Array(r),i=new Uint8Array(e);for(let n=0;n<t.length;n++)if(t[n]!==i[n])return!1;return!0}function ge(r,e){const t=r.toString(10);if(e<t.length)return"";const i=e-t.length,n=new Array(i);for(let a=0;a<i;a++)n[a]="0";return n.join("").concat(t)}/*!
 * Copyright (c) 2014, GMO GlobalSign
 * Copyright (c) 2015-2022, Peculiar Ventures
 * All rights reserved.
 * 
 * Author 2014-2019, Yury Strozhevsky
 * 
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 * 
 * * Redistributions of source code must retain the above copyright notice, this
 *   list of conditions and the following disclaimer.
 * 
 * * Redistributions in binary form must reproduce the above copyright notice, this
 *   list of conditions and the following disclaimer in the documentation and/or
 *   other materials provided with the distribution.
 * 
 * * Neither the name of the copyright holder nor the names of its
 *   contributors may be used to endorse or promote products derived from
 *   this software without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
 * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
 * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 * 
 */function Kr(){if(typeof BigInt>"u")throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function to(r){let e=0,t=0;for(let n=0;n<r.length;n++){const s=r[n];e+=s.byteLength}const i=new Uint8Array(e);for(let n=0;n<r.length;n++){const s=r[n];i.set(new Uint8Array(s),t),t+=s.byteLength}return i.buffer}function Je(r,e,t,i){return e instanceof Uint8Array?e.byteLength?t<0?(r.error="Wrong parameter: inputOffset less than zero",!1):i<0?(r.error="Wrong parameter: inputLength less than zero",!1):e.byteLength-t-i<0?(r.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):!0:(r.error="Wrong parameter: inputBuffer has zero length",!1):(r.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}class Ci{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return to(this.items)}}const sr=[new Uint8Array([1])],oa="0123456789",kn="name",aa="valueHexView",hf="isHexOnly",pf="idBlock",df="tagClass",yf="tagNumber",vf="isConstructed",gf="fromBER",mf="toBER",bf="local",he="",Oe=new ArrayBuffer(0),Ei=new Uint8Array(0),ur="EndOfContent",_c="OCTET STRING",Uc="BIT STRING";function _e(r){var e;return e=class extends r{constructor(...i){var n;super(...i);const s=i[0]||{};this.isHexOnly=(n=s.isHexOnly)!==null&&n!==void 0?n:!1,this.valueHexView=s.valueHex?C.toUint8Array(s.valueHex):Ei}get valueHex(){return this.valueHexView.slice().buffer}set valueHex(i){this.valueHexView=new Uint8Array(i)}fromBER(i,n,s){const a=i instanceof ArrayBuffer?new Uint8Array(i):i;if(!Je(this,a,n,s))return-1;const u=n+s;return this.valueHexView=a.subarray(n,u),this.valueHexView.length?(this.blockLength=s,u):(this.warnings.push("Zero buffer length"),n)}toBER(i=!1){return this.isHexOnly?i?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",Oe)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:R.ToHex(this.valueHexView)}}},e.NAME="hexBlock",e}class xt{constructor({blockLength:e=0,error:t=he,warnings:i=[],valueBeforeDecode:n=Ei}={}){this.blockLength=e,this.error=t,this.warnings=i,this.valueBeforeDecodeView=C.toUint8Array(n)}static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:R.ToHex(this.valueBeforeDecodeView)}}}xt.NAME="baseBlock";class ue extends xt{fromBER(e,t,i){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}ue.NAME="valueBlock";class $c extends _e(xt){constructor({idBlock:e={}}={}){var t,i,n,s;super(),e?(this.isHexOnly=(t=e.isHexOnly)!==null&&t!==void 0?t:!1,this.valueHexView=e.valueHex?C.toUint8Array(e.valueHex):Ei,this.tagClass=(i=e.tagClass)!==null&&i!==void 0?i:-1,this.tagNumber=(n=e.tagNumber)!==null&&n!==void 0?n:-1,this.isConstructed=(s=e.isConstructed)!==null&&s!==void 0?s:!1):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",Oe}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){const n=new Uint8Array(1);if(!e){let s=this.tagNumber;s&=31,t|=s,n[0]=t}return n.buffer}if(!this.isHexOnly){const n=pt(this.tagNumber,7),s=new Uint8Array(n),a=n.byteLength,u=new Uint8Array(a+1);if(u[0]=t|31,!e){for(let l=0;l<a-1;l++)u[l+1]=s[l]|128;u[a]=s[a-1]}return u.buffer}const i=new Uint8Array(this.valueHexView.byteLength+1);if(i[0]=t|31,!e){const n=this.valueHexView;for(let s=0;s<n.length-1;s++)i[s+1]=n[s]|128;i[this.valueHexView.byteLength]=n[n.length-1]}return i.buffer}fromBER(e,t,i){const n=C.toUint8Array(e);if(!Je(this,n,t,i))return-1;const s=n.subarray(t,t+i);if(s.length===0)return this.error="Zero buffer length",-1;switch(s[0]&192){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=(s[0]&32)===32,this.isHexOnly=!1;const u=s[0]&31;if(u!==31)this.tagNumber=u,this.blockLength=1;else{let l=1,p=this.valueHexView=new Uint8Array(255),A=255;for(;s[l]&128;){if(p[l-1]=s[l]&127,l++,l>=s.length)return this.error="End of input reached before message was fully decoded",-1;if(l===A){A+=255;const z=new Uint8Array(A);for(let N=0;N<p.length;N++)z[N]=p[N];p=this.valueHexView=new Uint8Array(A)}}this.blockLength=l+1,p[l-1]=s[l]&127;const S=new Uint8Array(l);for(let z=0;z<l;z++)S[z]=p[z];p=this.valueHexView=new Uint8Array(l),p.set(S),this.blockLength<=9?this.tagNumber=Pt(p,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(this.tagClass===1&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}$c.NAME="identificationBlock";class Hc extends xt{constructor({lenBlock:e={}}={}){var t,i,n;super(),this.isIndefiniteForm=(t=e.isIndefiniteForm)!==null&&t!==void 0?t:!1,this.longFormUsed=(i=e.longFormUsed)!==null&&i!==void 0?i:!1,this.length=(n=e.length)!==null&&n!==void 0?n:0}fromBER(e,t,i){const n=C.toUint8Array(e);if(!Je(this,n,t,i))return-1;const s=n.subarray(t,t+i);if(s.length===0)return this.error="Zero buffer length",-1;if(s[0]===255)return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=s[0]===128,this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(s[0]&128),this.longFormUsed===!1)return this.length=s[0],this.blockLength=1,t+this.blockLength;const a=s[0]&127;if(a>8)return this.error="Too big integer",-1;if(a+1>s.length)return this.error="End of input reached before message was fully decoded",-1;const u=t+1,l=n.subarray(u,u+a);return l[a-1]===0&&this.warnings.push("Needlessly long encoded length"),this.length=Pt(l,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=a+1,t+this.blockLength}toBER(e=!1){let t,i;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),e===!1&&(i=new Uint8Array(t),i[0]=128),t;if(this.longFormUsed){const n=pt(this.length,8);if(n.byteLength>127)return this.error="Too big length",Oe;if(t=new ArrayBuffer(n.byteLength+1),e)return t;const s=new Uint8Array(n);i=new Uint8Array(t),i[0]=n.byteLength|128;for(let a=0;a<n.byteLength;a++)i[a+1]=s[a];return t}return t=new ArrayBuffer(1),e===!1&&(i=new Uint8Array(t),i[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}Hc.NAME="lengthBlock";const T={};class ne extends xt{constructor({name:e=he,optional:t=!1,primitiveSchema:i,...n}={},s){super(n),this.name=e,this.optional=t,i&&(this.primitiveSchema=i),this.idBlock=new $c(n),this.lenBlock=new Hc(n),this.valueBlock=s?new s(n):new ue(n)}fromBER(e,t,i){const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?i:this.lenBlock.length);return n===-1?(this.error=this.valueBlock.error,n):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}toBER(e,t){const i=t||new Ci;t||Lc(this);const n=this.idBlock.toBER(e);if(i.write(n),this.lenBlock.isIndefiniteForm)i.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,i),i.write(new ArrayBuffer(2));else{const s=this.valueBlock.toBER(e);this.lenBlock.length=s.byteLength;const a=this.lenBlock.toBER(e);i.write(a),i.write(s)}return t?Oe:i.final()}toJSON(){const e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return e==="ascii"?this.onAsciiEncoding():R.ToHex(this.toBER())}onAsciiEncoding(){return`${this.constructor.NAME} : ${R.ToHex(this.valueBlock.valueBeforeDecodeView)}`}isEqual(e){if(this===e)return!0;if(!(e instanceof this.constructor))return!1;const t=this.toBER(),i=e.toBER();return ff(t,i)}}ne.NAME="BaseBlock";function Lc(r){if(r instanceof T.Constructed)for(const e of r.valueBlock.value)Lc(e)&&(r.lenBlock.isIndefiniteForm=!0);return!!r.lenBlock.isIndefiniteForm}class ro extends ne{constructor({value:e=he,...t}={},i){super(t,i),e&&this.fromString(e)}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}fromBER(e,t,i){const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?i:this.lenBlock.length);return n===-1?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}ro.NAME="BaseStringBlock";class Fc extends _e(ue){constructor({isHexOnly:e=!0,...t}={}){super(t),this.isHexOnly=e}}Fc.NAME="PrimitiveValueBlock";var zc;class Sr extends ne{constructor(e={}){super(e,Fc),this.idBlock.isConstructed=!1}}zc=Sr;T.Primitive=zc;Sr.NAME="PRIMITIVE";function wf(r,e){if(r instanceof e)return r;const t=new e;return t.idBlock=r.idBlock,t.lenBlock=r.lenBlock,t.warnings=r.warnings,t.valueBeforeDecodeView=r.valueBeforeDecodeView,t}function qt(r,e=0,t=r.length){const i=e;let n=new ne({},ue);const s=new xt;if(!Je(s,r,e,t))return n.error=s.error,{offset:-1,result:n};if(!r.subarray(e,e+t).length)return n.error="Zero buffer length",{offset:-1,result:n};let u=n.idBlock.fromBER(r,e,t);if(n.idBlock.warnings.length&&n.warnings.concat(n.idBlock.warnings),u===-1)return n.error=n.idBlock.error,{offset:-1,result:n};if(e=u,t-=n.idBlock.blockLength,u=n.lenBlock.fromBER(r,e,t),n.lenBlock.warnings.length&&n.warnings.concat(n.lenBlock.warnings),u===-1)return n.error=n.lenBlock.error,{offset:-1,result:n};if(e=u,t-=n.lenBlock.blockLength,!n.idBlock.isConstructed&&n.lenBlock.isIndefiniteForm)return n.error="Indefinite length form used for primitive encoding form",{offset:-1,result:n};let l=ne;switch(n.idBlock.tagClass){case 1:if(n.idBlock.tagNumber>=37&&n.idBlock.isHexOnly===!1)return n.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:n};switch(n.idBlock.tagNumber){case 0:if(n.idBlock.isConstructed&&n.lenBlock.length>0)return n.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:n};l=T.EndOfContent;break;case 1:l=T.Boolean;break;case 2:l=T.Integer;break;case 3:l=T.BitString;break;case 4:l=T.OctetString;break;case 5:l=T.Null;break;case 6:l=T.ObjectIdentifier;break;case 10:l=T.Enumerated;break;case 12:l=T.Utf8String;break;case 13:l=T.RelativeObjectIdentifier;break;case 14:l=T.TIME;break;case 15:return n.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:n};case 16:l=T.Sequence;break;case 17:l=T.Set;break;case 18:l=T.NumericString;break;case 19:l=T.PrintableString;break;case 20:l=T.TeletexString;break;case 21:l=T.VideotexString;break;case 22:l=T.IA5String;break;case 23:l=T.UTCTime;break;case 24:l=T.GeneralizedTime;break;case 25:l=T.GraphicString;break;case 26:l=T.VisibleString;break;case 27:l=T.GeneralString;break;case 28:l=T.UniversalString;break;case 29:l=T.CharacterString;break;case 30:l=T.BmpString;break;case 31:l=T.DATE;break;case 32:l=T.TimeOfDay;break;case 33:l=T.DateTime;break;case 34:l=T.Duration;break;default:{const p=n.idBlock.isConstructed?new T.Constructed:new T.Primitive;p.idBlock=n.idBlock,p.lenBlock=n.lenBlock,p.warnings=n.warnings,n=p}}break;case 2:case 3:case 4:default:l=n.idBlock.isConstructed?T.Constructed:T.Primitive}return n=wf(n,l),u=n.fromBER(r,e,n.lenBlock.isIndefiniteForm?t:n.lenBlock.length),n.valueBeforeDecodeView=r.subarray(i,i+n.blockLength),{offset:u,result:n}}function jt(r){if(!r.byteLength){const e=new ne({},ue);return e.error="Input buffer has zero length",{offset:-1,result:e}}return qt(C.toUint8Array(r).slice(),0,r.byteLength)}function Af(r,e){return r?1:e}class et extends ue{constructor({value:e=[],isIndefiniteForm:t=!1,...i}={}){super(i),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,i){const n=C.toUint8Array(e);if(!Je(this,n,t,i))return-1;if(this.valueBeforeDecodeView=n.subarray(t,t+i),this.valueBeforeDecodeView.length===0)return this.warnings.push("Zero buffer length"),t;let s=t;for(;Af(this.isIndefiniteForm,i)>0;){const a=qt(n,s,i);if(a.offset===-1)return this.error=a.result.error,this.warnings.concat(a.result.warnings),-1;if(s=a.offset,this.blockLength+=a.result.blockLength,i-=a.result.blockLength,this.value.push(a.result),this.isIndefiniteForm&&a.result.constructor.NAME===ur)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===ur?this.value.pop():this.warnings.push("No EndOfContent block encoded")),s}toBER(e,t){const i=t||new Ci;for(let n=0;n<this.value.length;n++)this.value[n].toBER(e,i);return t?Oe:i.final()}toJSON(){const e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(const t of this.value)e.value.push(t.toJSON());return e}}et.NAME="ConstructedValueBlock";var Gc;class pe extends ne{constructor(e={}){super(e,et),this.idBlock.isConstructed=!0}fromBER(e,t,i){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?i:this.lenBlock.length);return n===-1?(this.error=this.valueBlock.error,n):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}onAsciiEncoding(){const e=[];for(const i of this.valueBlock.value)e.push(i.toString("ascii").split(`
`).map(n=>`  ${n}`).join(`
`));const t=this.idBlock.tagClass===3?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return e.length?`${t} :
${e.join(`
`)}`:`${t} :`}}Gc=pe;T.Constructed=Gc;pe.NAME="CONSTRUCTED";class Wc extends ue{fromBER(e,t,i){return t}toBER(e){return Oe}}Wc.override="EndOfContentValueBlock";var qc;class io extends ne{constructor(e={}){super(e,Wc),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}qc=io;T.EndOfContent=qc;io.NAME=ur;var Kc;class dt extends ne{constructor(e={}){super(e,ue),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(e,t,i){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=i,t+i>e.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+i}toBER(e,t){const i=new ArrayBuffer(2);if(!e){const n=new Uint8Array(i);n[0]=5,n[1]=0}return t&&t.write(i),i}onAsciiEncoding(){return`${this.constructor.NAME}`}}Kc=dt;T.Null=Kc;dt.NAME="NULL";class Jc extends _e(ue){constructor({value:e,...t}={}){super(t),t.valueHex?this.valueHexView=C.toUint8Array(t.valueHex):this.valueHexView=new Uint8Array(1),e&&(this.value=e)}get value(){for(const e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=e?255:0}fromBER(e,t,i){const n=C.toUint8Array(e);return Je(this,n,t,i)?(this.valueHexView=n.subarray(t,t+i),i>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,Mc.call(this),this.blockLength=i,t+i):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}Jc.NAME="BooleanValueBlock";var Yc;class Ni extends ne{constructor(e={}){super(e,Jc),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}Yc=Ni;T.Boolean=Yc;Ni.NAME="BOOLEAN";class Qc extends _e(et){constructor({isConstructed:e=!1,...t}={}){super(t),this.isConstructed=e}fromBER(e,t,i){let n=0;if(this.isConstructed){if(this.isHexOnly=!1,n=et.prototype.fromBER.call(this,e,t,i),n===-1)return n;for(let s=0;s<this.value.length;s++){const a=this.value[s].constructor.NAME;if(a===ur){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(a!==_c)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,n=super.fromBER(e,t,i),this.blockLength=i;return n}toBER(e,t){return this.isConstructed?et.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}Qc.NAME="OctetStringValueBlock";var Zc;let ft=class Xc extends ne{constructor({idBlock:e={},lenBlock:t={},...i}={}){var n,s;(n=i.isConstructed)!==null&&n!==void 0||(i.isConstructed=!!(!((s=i.value)===null||s===void 0)&&s.length)),super({idBlock:{isConstructed:i.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!i.isIndefiniteForm},...i},Qc),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,i){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,i===0)return this.idBlock.error.length===0&&(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length===0&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){const s=(e instanceof ArrayBuffer?new Uint8Array(e):e).subarray(t,t+i);try{if(s.byteLength){const a=qt(s,0,s.byteLength);a.offset!==-1&&a.offset===i&&(this.valueBlock.value=[a.result])}}catch{}}return super.fromBER(e,t,i)}onAsciiEncoding(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?pe.prototype.onAsciiEncoding.call(this):`${this.constructor.NAME} : ${R.ToHex(this.valueBlock.valueHexView)}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const e=[];for(const t of this.valueBlock.value)t instanceof Xc&&e.push(t.valueBlock.valueHexView);return C.concat(e)}};Zc=ft;T.OctetString=Zc;ft.NAME=_c;class el extends _e(et){constructor({unusedBits:e=0,isConstructed:t=!1,...i}={}){super(i),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,i){if(!i)return t;let n=-1;if(this.isConstructed){if(n=et.prototype.fromBER.call(this,e,t,i),n===-1)return n;for(const u of this.value){const l=u.constructor.NAME;if(l===ur){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(l!==Uc)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const p=u.valueBlock;if(this.unusedBits>0&&p.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=p.unusedBits}return n}const s=C.toUint8Array(e);if(!Je(this,s,t,i))return-1;const a=s.subarray(t,t+i);if(this.unusedBits=a[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const u=a.subarray(1);try{if(u.byteLength){const l=qt(u,0,u.byteLength);l.offset!==-1&&l.offset===i-1&&(this.value=[l.result])}}catch{}}return this.valueHexView=a.subarray(1),this.blockLength=a.length,t+i}toBER(e,t){if(this.isConstructed)return et.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return Oe;const i=new Uint8Array(this.valueHexView.length+1);return i[0]=this.unusedBits,i.set(this.valueHexView,1),i.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}el.NAME="BitStringValueBlock";var tl;let ht=class extends ne{constructor({idBlock:e={},lenBlock:t={},...i}={}){var n,s;(n=i.isConstructed)!==null&&n!==void 0||(i.isConstructed=!!(!((s=i.value)===null||s===void 0)&&s.length)),super({idBlock:{isConstructed:i.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!i.isIndefiniteForm},...i},el),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(e,t,i){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,i)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return pe.prototype.onAsciiEncoding.call(this);{const e=[],t=this.valueBlock.valueHexView;for(const n of t)e.push(n.toString(2).padStart(8,"0"));const i=e.join("");return`${this.constructor.NAME} : ${i.substring(0,i.length-this.valueBlock.unusedBits)}`}}};tl=ht;T.BitString=tl;ht.NAME=Uc;var rl;function Sf(r,e){const t=new Uint8Array([0]),i=new Uint8Array(r),n=new Uint8Array(e);let s=i.slice(0);const a=s.length-1,u=n.slice(0),l=u.length-1;let p=0;const A=l<a?a:l;let S=0;for(let z=A;z>=0;z--,S++){switch(!0){case S<u.length:p=s[a-S]+u[l-S]+t[0];break;default:p=s[a-S]+t[0]}switch(t[0]=p/10,!0){case S>=s.length:s=_n(new Uint8Array([p%10]),s);break;default:s[a-S]=p%10}}return t[0]>0&&(s=_n(t,s)),s}function ca(r){if(r>=sr.length)for(let e=sr.length;e<=r;e++){const t=new Uint8Array([0]);let i=sr[e-1].slice(0);for(let n=i.length-1;n>=0;n--){const s=new Uint8Array([(i[n]<<1)+t[0]]);t[0]=s[0]/10,i[n]=s[0]%10}t[0]>0&&(i=_n(t,i)),sr.push(i)}return sr[r]}function xf(r,e){let t=0;const i=new Uint8Array(r),n=new Uint8Array(e),s=i.slice(0),a=s.length-1,u=n.slice(0),l=u.length-1;let p,A=0;for(let S=l;S>=0;S--,A++)switch(p=s[a-A]-u[l-A]-t,!0){case p<0:t=1,s[a-A]=p+10;break;default:t=0,s[a-A]=p}if(t>0)for(let S=a-l+1;S>=0;S--,A++)if(p=s[a-A]-t,p<0)t=1,s[a-A]=p+10;else{t=0,s[a-A]=p;break}return s.slice()}class no extends _e(ue){constructor({value:e,...t}={}){super(t),this._valueDec=0,t.valueHex&&this.setValueHex(),e!==void 0&&(this.valueDec=e)}setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=Mc.call(this)))}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this.valueHexView=new Uint8Array(uf(e))}get valueDec(){return this._valueDec}fromDER(e,t,i,n=0){const s=this.fromBER(e,t,i);if(s===-1)return s;const a=this.valueHexView;return a[0]===0&&a[1]&128?this.valueHexView=a.subarray(1):n!==0&&a.length<n&&(n-a.length>1&&(n=a.length+1),this.valueHexView=a.subarray(n-a.length)),s}toDER(e=!1){const t=this.valueHexView;switch(!0){case(t[0]&128)!==0:{const i=new Uint8Array(this.valueHexView.length+1);i[0]=0,i.set(t,1),this.valueHexView=i}break;case(t[0]===0&&(t[1]&128)===0):this.valueHexView=this.valueHexView.subarray(1);break}return this.toBER(e)}fromBER(e,t,i){const n=super.fromBER(e,t,i);return n===-1||this.setValueHex(),n}toBER(e){return e?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){const e=this.valueHexView.length*8-1;let t=new Uint8Array(this.valueHexView.length*8/3),i=0,n;const s=this.valueHexView;let a="",u=!1;for(let l=s.byteLength-1;l>=0;l--){n=s[l];for(let p=0;p<8;p++){if((n&1)===1)switch(i){case e:t=xf(ca(i),t),a="-";break;default:t=Sf(t,ca(i))}i++,n>>=1}}for(let l=0;l<t.length;l++)t[l]&&(u=!0),u&&(a+=oa.charAt(t[l]));return u===!1&&(a+=oa.charAt(0)),a}}rl=no;no.NAME="IntegerValueBlock";Object.defineProperty(rl.prototype,"valueHex",{set:function(r){this.valueHexView=new Uint8Array(r),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});var il;class Re extends ne{constructor(e={}){super(e,no),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return Kr(),BigInt(this.valueBlock.toString())}static fromBigInt(e){Kr();const t=BigInt(e),i=new Ci,n=t.toString(16).replace(/^-/,""),s=new Uint8Array(R.FromHex(n));if(t<0){const u=new Uint8Array(s.length+(s[0]&128?1:0));u[0]|=128;const p=BigInt(`0x${R.ToHex(u)}`)+t,A=C.toUint8Array(R.FromHex(p.toString(16)));A[0]|=128,i.write(A)}else s[0]&128&&i.write(new Uint8Array([0])),i.write(s);return new Re({valueHex:i.final()})}convertToDER(){const e=new Re({valueHex:this.valueBlock.valueHexView});return e.valueBlock.toDER(),e}convertFromDER(){return new Re({valueHex:this.valueBlock.valueHexView[0]===0?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}il=Re;T.Integer=il;Re.NAME="INTEGER";var nl;class Oi extends Re{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}nl=Oi;T.Enumerated=nl;Oi.NAME="ENUMERATED";class Un extends _e(ue){constructor({valueDec:e=-1,isFirstSid:t=!1,...i}={}){super(i),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,i){if(!i)return t;const n=C.toUint8Array(e);if(!Je(this,n,t,i))return-1;const s=n.subarray(t,t+i);this.valueHexView=new Uint8Array(i);for(let u=0;u<i&&(this.valueHexView[u]=s[u]&127,this.blockLength++,!!(s[u]&128));u++);const a=new Uint8Array(this.blockLength);for(let u=0;u<this.blockLength;u++)a[u]=this.valueHexView[u];return this.valueHexView=a,s[this.blockLength-1]&128?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=Pt(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){Kr();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;const i=new Uint8Array(t.length/7);for(let n=0;n<i.length;n++)i[n]=parseInt(t.slice(n*7,n*7+7),2)+(n+1<i.length?128:0);this.fromBER(i.buffer,0,i.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const n=this.valueHexView,s=new Uint8Array(this.blockLength);for(let a=0;a<this.blockLength-1;a++)s[a]=n[a]|128;return s[this.blockLength-1]=n[this.blockLength-1],s.buffer}const t=pt(this.valueDec,7);if(t.byteLength===0)return this.error="Error during encoding SID value",Oe;const i=new Uint8Array(t.byteLength);if(!e){const n=new Uint8Array(t),s=t.byteLength-1;for(let a=0;a<s;a++)i[a]=n[a]|128;i[s]=n[s]}return i}toString(){let e="";if(this.isHexOnly)e=R.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}Un.NAME="sidBlock";class sl extends ue{constructor({value:e=he,...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,i){let n=t;for(;i>0;){const s=new Un;if(n=s.fromBER(e,n,i),n===-1)return this.blockLength=0,this.error=s.error,n;this.value.length===0&&(s.isFirstSid=!0),this.blockLength+=s.blockLength,i-=s.blockLength,this.value.push(s)}return n}toBER(e){const t=[];for(let i=0;i<this.value.length;i++){const n=this.value[i].toBER(e);if(n.byteLength===0)return this.error=this.value[i].error,Oe;t.push(n)}return to(t)}fromString(e){this.value=[];let t=0,i=0,n="",s=!1;do if(i=e.indexOf(".",t),i===-1?n=e.substring(t):n=e.substring(t,i),t=i+1,s){const a=this.value[0];let u=0;switch(a.valueDec){case 0:break;case 1:u=40;break;case 2:u=80;break;default:this.value=[];return}const l=parseInt(n,10);if(isNaN(l))return;a.valueDec=l+u,s=!1}else{const a=new Un;if(n>Number.MAX_SAFE_INTEGER){Kr();const u=BigInt(n);a.valueBigInt=u}else if(a.valueDec=parseInt(n,10),isNaN(a.valueDec))return;this.value.length||(a.isFirstSid=!0,s=!0),this.value.push(a)}while(i!==-1)}toString(){let e="",t=!1;for(let i=0;i<this.value.length;i++){t=this.value[i].isHexOnly;let n=this.value[i].toString();i!==0&&(e=`${e}.`),t?(n=`{${n}}`,this.value[i].isFirstSid?e=`2.{${n} - 80}`:e+=n):e+=n}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}sl.NAME="ObjectIdentifierValueBlock";var ol;class ji extends ne{constructor(e={}){super(e,sl),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}ol=ji;T.ObjectIdentifier=ol;ji.NAME="OBJECT IDENTIFIER";class $n extends _e(xt){constructor({valueDec:e=0,...t}={}){super(t),this.valueDec=e}fromBER(e,t,i){if(i===0)return t;const n=C.toUint8Array(e);if(!Je(this,n,t,i))return-1;const s=n.subarray(t,t+i);this.valueHexView=new Uint8Array(i);for(let u=0;u<i&&(this.valueHexView[u]=s[u]&127,this.blockLength++,!!(s[u]&128));u++);const a=new Uint8Array(this.blockLength);for(let u=0;u<this.blockLength;u++)a[u]=this.valueHexView[u];return this.valueHexView=a,s[this.blockLength-1]&128?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=Pt(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const n=this.valueHexView,s=new Uint8Array(this.blockLength);for(let a=0;a<this.blockLength-1;a++)s[a]=n[a]|128;return s[this.blockLength-1]=n[this.blockLength-1],s.buffer}const t=pt(this.valueDec,7);if(t.byteLength===0)return this.error="Error during encoding SID value",Oe;const i=new Uint8Array(t.byteLength);if(!e){const n=new Uint8Array(t),s=t.byteLength-1;for(let a=0;a<s;a++)i[a]=n[a]|128;i[s]=n[s]}return i.buffer}toString(){let e="";return this.isHexOnly?e=R.ToHex(this.valueHexView):e=this.valueDec.toString(),e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}$n.NAME="relativeSidBlock";class al extends ue{constructor({value:e=he,...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,i){let n=t;for(;i>0;){const s=new $n;if(n=s.fromBER(e,n,i),n===-1)return this.blockLength=0,this.error=s.error,n;this.blockLength+=s.blockLength,i-=s.blockLength,this.value.push(s)}return n}toBER(e,t){const i=[];for(let n=0;n<this.value.length;n++){const s=this.value[n].toBER(e);if(s.byteLength===0)return this.error=this.value[n].error,Oe;i.push(s)}return to(i)}fromString(e){this.value=[];let t=0,i=0,n="";do{i=e.indexOf(".",t),i===-1?n=e.substring(t):n=e.substring(t,i),t=i+1;const s=new $n;if(s.valueDec=parseInt(n,10),isNaN(s.valueDec))return!0;this.value.push(s)}while(i!==-1);return!0}toString(){let e="",t=!1;for(let i=0;i<this.value.length;i++){t=this.value[i].isHexOnly;let n=this.value[i].toString();i!==0&&(e=`${e}.`),t&&(n=`{${n}}`),e+=n}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}al.NAME="RelativeObjectIdentifierValueBlock";var cl;class so extends ne{constructor(e={}){super(e,al),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}cl=so;T.RelativeObjectIdentifier=cl;so.NAME="RelativeObjectIdentifier";var ll;class Le extends pe{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}ll=Le;T.Sequence=ll;Le.NAME="SEQUENCE";var ul;let Fe=class extends pe{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}};ul=Fe;T.Set=ul;Fe.NAME="SET";class fl extends _e(ue){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=he}toJSON(){return{...super.toJSON(),value:this.value}}}fl.NAME="StringValueBlock";class hl extends fl{}hl.NAME="SimpleStringValueBlock";class be extends ro{constructor({...e}={}){super(e,hl)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,C.toUint8Array(e))}fromString(e){const t=e.length,i=this.valueBlock.valueHexView=new Uint8Array(t);for(let n=0;n<t;n++)i[n]=e.charCodeAt(n);this.valueBlock.value=e}}be.NAME="SIMPLE STRING";class pl extends be{fromBuffer(e){this.valueBlock.valueHexView=C.toUint8Array(e);try{this.valueBlock.value=R.ToUtf8String(e)}catch(t){this.warnings.push(`Error during "decodeURIComponent": ${t}, using raw string`),this.valueBlock.value=R.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(R.FromUtf8String(e)),this.valueBlock.value=e}}pl.NAME="Utf8StringValueBlock";var dl;class Ye extends pl{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}dl=Ye;T.Utf8String=dl;Ye.NAME="UTF8String";class yl extends be{fromBuffer(e){this.valueBlock.value=R.ToUtf16String(e),this.valueBlock.valueHexView=C.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(R.FromUtf16String(e))}}yl.NAME="BmpStringValueBlock";var vl;class Ti extends yl{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}vl=Ti;T.BmpString=vl;Ti.NAME="BMPString";class gl extends be{fromBuffer(e){const t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),i=new Uint8Array(t);for(let n=0;n<i.length;n+=4)i[n]=i[n+3],i[n+1]=i[n+2],i[n+2]=0,i[n+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){const t=e.length,i=this.valueBlock.valueHexView=new Uint8Array(t*4);for(let n=0;n<t;n++){const s=pt(e.charCodeAt(n),8),a=new Uint8Array(s);if(a.length>4)continue;const u=4-a.length;for(let l=a.length-1;l>=0;l--)i[n*4+l+u]=a[l]}this.valueBlock.value=e}}gl.NAME="UniversalStringValueBlock";var ml;class Pi extends gl{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}ml=Pi;T.UniversalString=ml;Pi.NAME="UniversalString";var bl;class Vi extends be{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}bl=Vi;T.NumericString=bl;Vi.NAME="NumericString";var wl;class Ri extends be{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}wl=Ri;T.PrintableString=wl;Ri.NAME="PrintableString";var Al;class Di extends be{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}Al=Di;T.TeletexString=Al;Di.NAME="TeletexString";var Sl;class Mi extends be{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}Sl=Mi;T.VideotexString=Sl;Mi.NAME="VideotexString";var xl;class _i extends be{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}xl=_i;T.IA5String=xl;_i.NAME="IA5String";var Bl;class Ui extends be{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}Bl=Ui;T.GraphicString=Bl;Ui.NAME="GraphicString";var Il;class xr extends be{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}Il=xr;T.VisibleString=Il;xr.NAME="VisibleString";var kl;class $i extends be{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}kl=$i;T.GeneralString=kl;$i.NAME="GeneralString";var Cl;class Hi extends be{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}Cl=Hi;T.CharacterString=Cl;Hi.NAME="CharacterString";var El;class Br extends xr{constructor({value:e,valueDate:t,...i}={}){if(super(i),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,e){this.fromString(e),this.valueBlock.valueHexView=new Uint8Array(e.length);for(let n=0;n<e.length;n++)this.valueBlock.valueHexView[n]=e.charCodeAt(n)}t&&(this.fromDate(t),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,C.toUint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),i=new Uint8Array(t);for(let n=0;n<e.length;n++)i[n]=e.charCodeAt(n);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){const i=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/ig.exec(e);if(i===null){this.error="Wrong input string for conversion";return}const n=parseInt(i[1],10);n>=50?this.year=1900+n:this.year=2e3+n,this.month=parseInt(i[2],10),this.day=parseInt(i[3],10),this.hour=parseInt(i[4],10),this.minute=parseInt(i[5],10),this.second=parseInt(i[6],10)}toString(e="iso"){if(e==="iso"){const t=new Array(7);return t[0]=ge(this.year<2e3?this.year-1900:this.year-2e3,2),t[1]=ge(this.month,2),t[2]=ge(this.day,2),t[3]=ge(this.hour,2),t[4]=ge(this.minute,2),t[5]=ge(this.second,2),t[6]="Z",t.join("")}return super.toString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}El=Br;T.UTCTime=El;Br.NAME="UTCTime";var Nl;class Li extends Br{constructor(e={}){var t;super(e),(t=this.millisecond)!==null&&t!==void 0||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(e){super.fromDate(e),this.millisecond=e.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(e){let t=!1,i="",n="",s=0,a,u=0,l=0;if(e[e.length-1]==="Z")i=e.substring(0,e.length-1),t=!0;else{const S=new Number(e[e.length-1]);if(isNaN(S.valueOf()))throw new Error("Wrong input string for conversion");i=e}if(t){if(i.indexOf("+")!==-1)throw new Error("Wrong input string for conversion");if(i.indexOf("-")!==-1)throw new Error("Wrong input string for conversion")}else{let S=1,z=i.indexOf("+"),N="";if(z===-1&&(z=i.indexOf("-"),S=-1),z!==-1){if(N=i.substring(z+1),i=i.substring(0,z),N.length!==2&&N.length!==4)throw new Error("Wrong input string for conversion");let f=parseInt(N.substring(0,2),10);if(isNaN(f.valueOf()))throw new Error("Wrong input string for conversion");if(u=S*f,N.length===4){if(f=parseInt(N.substring(2,4),10),isNaN(f.valueOf()))throw new Error("Wrong input string for conversion");l=S*f}}}let p=i.indexOf(".");if(p===-1&&(p=i.indexOf(",")),p!==-1){const S=new Number(`0${i.substring(p)}`);if(isNaN(S.valueOf()))throw new Error("Wrong input string for conversion");s=S.valueOf(),n=i.substring(0,p)}else n=i;switch(!0){case n.length===8:if(a=/(\d{4})(\d{2})(\d{2})/ig,p!==-1)throw new Error("Wrong input string for conversion");break;case n.length===10:if(a=/(\d{4})(\d{2})(\d{2})(\d{2})/ig,p!==-1){let S=60*s;this.minute=Math.floor(S),S=60*(S-this.minute),this.second=Math.floor(S),S=1e3*(S-this.second),this.millisecond=Math.floor(S)}break;case n.length===12:if(a=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/ig,p!==-1){let S=60*s;this.second=Math.floor(S),S=1e3*(S-this.second),this.millisecond=Math.floor(S)}break;case n.length===14:if(a=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/ig,p!==-1){const S=1e3*s;this.millisecond=Math.floor(S)}break;default:throw new Error("Wrong input string for conversion")}const A=a.exec(n);if(A===null)throw new Error("Wrong input string for conversion");for(let S=1;S<A.length;S++)switch(S){case 1:this.year=parseInt(A[S],10);break;case 2:this.month=parseInt(A[S],10);break;case 3:this.day=parseInt(A[S],10);break;case 4:this.hour=parseInt(A[S],10)+u;break;case 5:this.minute=parseInt(A[S],10)+l;break;case 6:this.second=parseInt(A[S],10);break;default:throw new Error("Wrong input string for conversion")}if(t===!1){const S=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=S.getUTCFullYear(),this.month=S.getUTCMonth(),this.day=S.getUTCDay(),this.hour=S.getUTCHours(),this.minute=S.getUTCMinutes(),this.second=S.getUTCSeconds(),this.millisecond=S.getUTCMilliseconds()}}toString(e="iso"){if(e==="iso"){const t=[];return t.push(ge(this.year,4)),t.push(ge(this.month,2)),t.push(ge(this.day,2)),t.push(ge(this.hour,2)),t.push(ge(this.minute,2)),t.push(ge(this.second,2)),this.millisecond!==0&&(t.push("."),t.push(ge(this.millisecond,3))),t.push("Z"),t.join("")}return super.toString(e)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}Nl=Li;T.GeneralizedTime=Nl;Li.NAME="GeneralizedTime";var Ol;class oo extends Ye{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}Ol=oo;T.DATE=Ol;oo.NAME="DATE";var jl;class ao extends Ye{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}jl=ao;T.TimeOfDay=jl;ao.NAME="TimeOfDay";var Tl;class co extends Ye{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}Tl=co;T.DateTime=Tl;co.NAME="DateTime";var Pl;class lo extends Ye{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}Pl=lo;T.Duration=Pl;lo.NAME="Duration";var Vl;class uo extends Ye{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}Vl=uo;T.TIME=Vl;uo.NAME="TIME";class yt{constructor({name:e=he,optional:t=!1}={}){this.name=e,this.optional=t}}class fo extends yt{constructor({value:e=[],...t}={}){super(t),this.value=e}}class Jr extends yt{constructor({value:e=new yt,local:t=!1,...i}={}){super(i),this.value=e,this.local=t}}class Bf{constructor({data:e=Ei}={}){this.dataView=C.toUint8Array(e)}get data(){return this.dataView.slice().buffer}set data(e){this.dataView=C.toUint8Array(e)}fromBER(e,t,i){const n=t+i;return this.dataView=C.toUint8Array(e).subarray(t,n),n}toBER(e){return this.dataView.slice().buffer}}function lt(r,e,t){if(t instanceof fo){for(let s=0;s<t.value.length;s++)if(lt(r,e,t.value[s]).verified)return{verified:!0,result:r};{const s={verified:!1,result:{error:"Wrong values for Choice type"}};return t.hasOwnProperty(kn)&&(s.name=t.name),s}}if(t instanceof yt)return t.hasOwnProperty(kn)&&(r[t.name]=e),{verified:!0,result:r};if(!(r instanceof Object))return{verified:!1,result:{error:"Wrong root object"}};if(!(e instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(!(t instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(pf in t))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(gf in t.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(mf in t.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const i=t.idBlock.toBER(!1);if(i.byteLength===0)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(t.idBlock.fromBER(i,0,i.byteLength)===-1)return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(t.idBlock.hasOwnProperty(df)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(t.idBlock.tagClass!==e.idBlock.tagClass)return{verified:!1,result:r};if(t.idBlock.hasOwnProperty(yf)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(t.idBlock.tagNumber!==e.idBlock.tagNumber)return{verified:!1,result:r};if(t.idBlock.hasOwnProperty(vf)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(t.idBlock.isConstructed!==e.idBlock.isConstructed)return{verified:!1,result:r};if(!(hf in t.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(t.idBlock.isHexOnly!==e.idBlock.isHexOnly)return{verified:!1,result:r};if(t.idBlock.isHexOnly){if(!(aa in t.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const s=t.idBlock.valueHexView,a=e.idBlock.valueHexView;if(s.length!==a.length)return{verified:!1,result:r};for(let u=0;u<s.length;u++)if(s[u]!==a[1])return{verified:!1,result:r}}if(t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,he),t.name&&(r[t.name]=e)),t instanceof T.Constructed){let s=0,a={verified:!1,result:{error:"Unknown error"}},u=t.valueBlock.value.length;if(u>0&&t.valueBlock.value[0]instanceof Jr&&(u=e.valueBlock.value.length),u===0)return{verified:!0,result:r};if(e.valueBlock.value.length===0&&t.valueBlock.value.length!==0){let l=!0;for(let p=0;p<t.valueBlock.value.length;p++)l=l&&(t.valueBlock.value[p].optional||!1);return l?{verified:!0,result:r}:(t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,he),t.name&&delete r[t.name]),r.error="Inconsistent object length",{verified:!1,result:r})}for(let l=0;l<u;l++)if(l-s>=e.valueBlock.value.length){if(t.valueBlock.value[l].optional===!1){const p={verified:!1,result:r};return r.error="Inconsistent length between ASN.1 data and schema",t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,he),t.name&&(delete r[t.name],p.name=t.name)),p}}else if(t.valueBlock.value[0]instanceof Jr){if(a=lt(r,e.valueBlock.value[l],t.valueBlock.value[0].value),a.verified===!1)if(t.valueBlock.value[0].optional)s++;else return t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,he),t.name&&delete r[t.name]),a;if(kn in t.valueBlock.value[0]&&t.valueBlock.value[0].name.length>0){let p={};bf in t.valueBlock.value[0]&&t.valueBlock.value[0].local?p=e:p=r,typeof p[t.valueBlock.value[0].name]>"u"&&(p[t.valueBlock.value[0].name]=[]),p[t.valueBlock.value[0].name].push(e.valueBlock.value[l])}}else if(a=lt(r,e.valueBlock.value[l-s],t.valueBlock.value[l]),a.verified===!1)if(t.valueBlock.value[l].optional)s++;else return t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,he),t.name&&delete r[t.name]),a;if(a.verified===!1){const l={verified:!1,result:r};return t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,he),t.name&&(delete r[t.name],l.name=t.name)),l}return{verified:!0,result:r}}if(t.primitiveSchema&&aa in e.valueBlock){const s=qt(e.valueBlock.valueHexView);if(s.offset===-1){const a={verified:!1,result:s.result};return t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,he),t.name&&(delete r[t.name],a.name=t.name)),a}return lt(r,s.result,t.primitiveSchema)}return{verified:!0,result:r}}function If(r,e){if(!(e instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};const t=qt(C.toUint8Array(r));return t.offset===-1?{verified:!1,result:t.result}:lt(t.result,t.result,e)}const Rl=Object.freeze(Object.defineProperty({__proto__:null,Any:yt,BaseBlock:ne,BaseStringBlock:ro,BitString:ht,BmpString:Ti,Boolean:Ni,CharacterString:Hi,Choice:fo,Constructed:pe,DATE:oo,DateTime:co,Duration:lo,EndOfContent:io,Enumerated:Oi,GeneralString:$i,GeneralizedTime:Li,GraphicString:Ui,HexBlock:_e,IA5String:_i,Integer:Re,Null:dt,NumericString:Vi,ObjectIdentifier:ji,OctetString:ft,Primitive:Sr,PrintableString:Ri,RawData:Bf,RelativeObjectIdentifier:so,Repeated:Jr,Sequence:Le,Set:Fe,TIME:uo,TeletexString:Di,TimeOfDay:ao,UTCTime:Br,UniversalString:Pi,Utf8String:Ye,ValueBlock:ue,VideotexString:Mi,ViewWriter:Ci,VisibleString:xr,compareSchema:lt,fromBER:jt,verifySchema:If},Symbol.toStringTag,{value:"Module"}));var w;(function(r){r[r.Sequence=0]="Sequence",r[r.Set=1]="Set",r[r.Choice=2]="Choice"})(w||(w={}));var h;(function(r){r[r.Any=1]="Any",r[r.Boolean=2]="Boolean",r[r.OctetString=3]="OctetString",r[r.BitString=4]="BitString",r[r.Integer=5]="Integer",r[r.Enumerated=6]="Enumerated",r[r.ObjectIdentifier=7]="ObjectIdentifier",r[r.Utf8String=8]="Utf8String",r[r.BmpString=9]="BmpString",r[r.UniversalString=10]="UniversalString",r[r.NumericString=11]="NumericString",r[r.PrintableString=12]="PrintableString",r[r.TeletexString=13]="TeletexString",r[r.VideotexString=14]="VideotexString",r[r.IA5String=15]="IA5String",r[r.GraphicString=16]="GraphicString",r[r.VisibleString=17]="VisibleString",r[r.GeneralString=18]="GeneralString",r[r.CharacterString=19]="CharacterString",r[r.UTCTime=20]="UTCTime",r[r.GeneralizedTime=21]="GeneralizedTime",r[r.DATE=22]="DATE",r[r.TimeOfDay=23]="TimeOfDay",r[r.DateTime=24]="DateTime",r[r.Duration=25]="Duration",r[r.TIME=26]="TIME",r[r.Null=27]="Null"})(h||(h={}));class Fi{constructor(e,t=0){if(this.unusedBits=0,this.value=new ArrayBuffer(0),e)if(typeof e=="number")this.fromNumber(e);else if(C.isBufferSource(e))this.unusedBits=t,this.value=C.toArrayBuffer(e);else throw TypeError("Unsupported type of 'params' argument for BitString")}fromASN(e){if(!(e instanceof ht))throw new TypeError("Argument 'asn' is not instance of ASN.1 BitString");return this.unusedBits=e.valueBlock.unusedBits,this.value=e.valueBlock.valueHex,this}toASN(){return new ht({unusedBits:this.unusedBits,valueHex:this.value})}toSchema(e){return new ht({name:e})}toNumber(){let e="";const t=new Uint8Array(this.value);for(const i of t)e+=i.toString(2).padStart(8,"0");return e=e.split("").reverse().join(""),this.unusedBits&&(e=e.slice(this.unusedBits).padStart(this.unusedBits,"0")),parseInt(e,2)}fromNumber(e){let t=e.toString(2);const i=t.length+7>>3;this.unusedBits=(i<<3)-t.length;const n=new Uint8Array(i);t=t.padStart(i<<3,"0").split("").reverse().join("");let s=0;for(;s<i;)n[s]=parseInt(t.slice(s<<3,(s<<3)+8),2),s++;this.value=n.buffer}}class F{get byteLength(){return this.buffer.byteLength}get byteOffset(){return 0}constructor(e){typeof e=="number"?this.buffer=new ArrayBuffer(e):C.isBufferSource(e)?this.buffer=C.toArrayBuffer(e):Array.isArray(e)?this.buffer=new Uint8Array(e):this.buffer=new ArrayBuffer(0)}fromASN(e){if(!(e instanceof ft))throw new TypeError("Argument 'asn' is not instance of ASN.1 OctetString");return this.buffer=e.valueBlock.valueHex,this}toASN(){return new ft({valueHex:this.buffer})}toSchema(e){return new ft({name:e})}}const kf={fromASN:r=>r instanceof dt?null:r.valueBeforeDecodeView,toASN:r=>{if(r===null)return new dt;const e=jt(r);if(e.result.error)throw new Error(e.result.error);return e.result}},Cf={fromASN:r=>r.valueBlock.valueHexView.byteLength>=4?r.valueBlock.toString():r.valueBlock.valueDec,toASN:r=>new Re({value:+r})},Ef={fromASN:r=>r.valueBlock.valueDec,toASN:r=>new Oi({value:r})},J={fromASN:r=>r.valueBlock.valueHexView,toASN:r=>new Re({valueHex:r})},Nf={fromASN:r=>r.valueBlock.valueHexView,toASN:r=>new ht({valueHex:r})},Of={fromASN:r=>r.valueBlock.toString(),toASN:r=>new ji({value:r})},jf={fromASN:r=>r.valueBlock.value,toASN:r=>new Ni({value:r})},Yr={fromASN:r=>r.valueBlock.valueHexView,toASN:r=>new ft({valueHex:r})},Tf={fromASN:r=>new F(r.getValue()),toASN:r=>r.toASN()};function Se(r){return{fromASN:e=>e.valueBlock.value,toASN:e=>new r({value:e})}}const Dl=Se(Ye),Pf=Se(Ti),Vf=Se(Pi),Rf=Se(Vi),Df=Se(Ri),Mf=Se(Di),_f=Se(Mi),Uf=Se(_i),$f=Se(Ui),Hf=Se(xr),Lf=Se($i),Ff=Se(Hi),zf={fromASN:r=>r.toDate(),toASN:r=>new Br({valueDate:r})},Gf={fromASN:r=>r.toDate(),toASN:r=>new Li({valueDate:r})},Wf={fromASN:()=>null,toASN:()=>new dt};function ho(r){switch(r){case h.Any:return kf;case h.BitString:return Nf;case h.BmpString:return Pf;case h.Boolean:return jf;case h.CharacterString:return Ff;case h.Enumerated:return Ef;case h.GeneralString:return Lf;case h.GeneralizedTime:return Gf;case h.GraphicString:return $f;case h.IA5String:return Uf;case h.Integer:return Cf;case h.Null:return Wf;case h.NumericString:return Rf;case h.ObjectIdentifier:return Of;case h.OctetString:return Yr;case h.PrintableString:return Df;case h.TeletexString:return Mf;case h.UTCTime:return zf;case h.UniversalString:return Vf;case h.Utf8String:return Dl;case h.VideotexString:return _f;case h.VisibleString:return Hf;default:return null}}function He(r){return typeof r=="function"&&r.prototype?r.prototype.toASN&&r.prototype.fromASN?!0:He(r.prototype):!!(r&&typeof r=="object"&&"toASN"in r&&"fromASN"in r)}function Ml(r){var e;if(r){const t=Object.getPrototypeOf(r);return((e=t==null?void 0:t.prototype)===null||e===void 0?void 0:e.constructor)===Array?!0:Ml(t)}return!1}function qf(r,e){if(!(r&&e)||r.byteLength!==e.byteLength)return!1;const t=new Uint8Array(r),i=new Uint8Array(e);for(let n=0;n<r.byteLength;n++)if(t[n]!==i[n])return!1;return!0}class Kf{constructor(){this.items=new WeakMap}has(e){return this.items.has(e)}get(e,t=!1){const i=this.items.get(e);if(!i)throw new Error(`Cannot get schema for '${e.prototype.constructor.name}' target`);if(t&&!i.schema)throw new Error(`Schema '${e.prototype.constructor.name}' doesn't contain ASN.1 schema. Call 'AsnSchemaStorage.cache'.`);return i}cache(e){const t=this.get(e);t.schema||(t.schema=this.create(e,!0))}createDefault(e){const t={type:w.Sequence,items:{}},i=this.findParentSchema(e);return i&&(Object.assign(t,i),t.items=Object.assign({},t.items,i.items)),t}create(e,t){const i=this.items.get(e)||this.createDefault(e),n=[];for(const s in i.items){const a=i.items[s],u=t?s:"";let l;if(typeof a.type=="number"){const A=h[a.type],S=Rl[A];if(!S)throw new Error(`Cannot get ASN1 class by name '${A}'`);l=new S({name:u})}else He(a.type)?l=new a.type().toSchema(u):a.optional?this.get(a.type).type===w.Choice?l=new yt({name:u}):(l=this.create(a.type,!1),l.name=u):l=new yt({name:u});const p=!!a.optional||a.defaultValue!==void 0;if(a.repeated){l.name="";const A=a.repeated==="set"?Fe:Le;l=new A({name:"",value:[new Jr({name:u,value:l})]})}if(a.context!==null&&a.context!==void 0)if(a.implicit)if(typeof a.type=="number"||He(a.type)){const A=a.repeated?pe:Sr;n.push(new A({name:u,optional:p,idBlock:{tagClass:3,tagNumber:a.context}}))}else{this.cache(a.type);const A=!!a.repeated;let S=A?l:this.get(a.type,!0).schema;S="valueBlock"in S?S.valueBlock.value:S.value,n.push(new pe({name:A?"":u,optional:p,idBlock:{tagClass:3,tagNumber:a.context},value:S}))}else n.push(new pe({optional:p,idBlock:{tagClass:3,tagNumber:a.context},value:[l]}));else l.optional=p,n.push(l)}switch(i.type){case w.Sequence:return new Le({value:n,name:""});case w.Set:return new Fe({value:n,name:""});case w.Choice:return new fo({value:n,name:""});default:throw new Error("Unsupported ASN1 type in use")}}set(e,t){return this.items.set(e,t),this}findParentSchema(e){const t=Object.getPrototypeOf(e);return t?this.items.get(t)||this.findParentSchema(t):null}}const we=new Kf,x=r=>e=>{let t;we.has(e)?t=we.get(e):(t=we.createDefault(e),we.set(e,t)),Object.assign(t,r)},c=r=>(e,t)=>{let i;we.has(e.constructor)?i=we.get(e.constructor):(i=we.createDefault(e.constructor),we.set(e.constructor,i));const n=Object.assign({},r);if(typeof n.type=="number"&&!n.converter){const s=ho(r.type);if(!s)throw new Error(`Cannot get default converter for property '${t}' of ${e.constructor.name}`);n.converter=s}i.items[t]=n};class la extends Error{constructor(){super(...arguments),this.schemas=[]}}class Jf{static parse(e,t){const i=jt(e);if(i.result.error)throw new Error(i.result.error);return this.fromASN(i.result,t)}static fromASN(e,t){var i;try{if(He(t))return new t().fromASN(e);const n=we.get(t);we.cache(t);let s=n.schema;if(e.constructor===pe&&n.type!==w.Choice){s=new pe({idBlock:{tagClass:3,tagNumber:e.idBlock.tagNumber},value:n.schema.valueBlock.value});for(const l in n.items)delete e[l]}const a=lt({},e,s);if(!a.verified)throw new la(`Data does not match to ${t.name} ASN1 schema. ${a.result.error}`);const u=new t;if(Ml(t)){if(!("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)))throw new Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");const l=n.itemType;if(typeof l=="number"){const p=ho(l);if(!p)throw new Error(`Cannot get default converter for array item of ${t.name} ASN1 schema`);return t.from(e.valueBlock.value,A=>p.fromASN(A))}else return t.from(e.valueBlock.value,p=>this.fromASN(p,l))}for(const l in n.items){const p=a.result[l];if(!p)continue;const A=n.items[l],S=A.type;if(typeof S=="number"||He(S)){const z=(i=A.converter)!==null&&i!==void 0?i:He(S)?new S:null;if(!z)throw new Error("Converter is empty");if(A.repeated)if(A.implicit){const N=A.repeated==="sequence"?Le:Fe,f=new N;f.valueBlock=p.valueBlock;const y=jt(f.toBER(!1));if(y.offset===-1)throw new Error(`Cannot parse the child item. ${y.result.error}`);if(!("value"in y.result.valueBlock&&Array.isArray(y.result.valueBlock.value)))throw new Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");const b=y.result.valueBlock.value;u[l]=Array.from(b,m=>z.fromASN(m))}else u[l]=Array.from(p,N=>z.fromASN(N));else{let N=p;if(A.implicit){let f;if(He(S))f=new S().toSchema("");else{const y=h[S],b=Rl[y];if(!b)throw new Error(`Cannot get '${y}' class from asn1js module`);f=new b}f.valueBlock=N.valueBlock,N=jt(f.toBER(!1)).result}u[l]=z.fromASN(N)}}else if(A.repeated){if(!Array.isArray(p))throw new Error("Cannot get list of items from the ASN.1 parsed value. ASN.1 value should be iterable.");u[l]=Array.from(p,z=>this.fromASN(z,S))}else u[l]=this.fromASN(p,S)}return u}catch(n){throw n instanceof la&&n.schemas.push(t.name),n}}}class po{static serialize(e){return e instanceof ne?e.toBER(!1):this.toASN(e).toBER(!1)}static toASN(e){if(e&&typeof e=="object"&&He(e))return e.toASN();if(!(e&&typeof e=="object"))throw new TypeError("Parameter 1 should be type of Object.");const t=e.constructor,i=we.get(t);we.cache(t);let n=[];if(i.itemType){if(!Array.isArray(e))throw new TypeError("Parameter 1 should be type of Array.");if(typeof i.itemType=="number"){const a=ho(i.itemType);if(!a)throw new Error(`Cannot get default converter for array item of ${t.name} ASN1 schema`);n=e.map(u=>a.toASN(u))}else n=e.map(a=>this.toAsnItem({type:i.itemType},"[]",t,a))}else for(const a in i.items){const u=i.items[a],l=e[a];if(l===void 0||u.defaultValue===l||typeof u.defaultValue=="object"&&typeof l=="object"&&qf(this.serialize(u.defaultValue),this.serialize(l)))continue;const p=po.toAsnItem(u,a,t,l);if(typeof u.context=="number")if(u.implicit)if(!u.repeated&&(typeof u.type=="number"||He(u.type))){const A={};A.valueHex=p instanceof dt?p.valueBeforeDecodeView:p.valueBlock.toBER(),n.push(new Sr({optional:u.optional,idBlock:{tagClass:3,tagNumber:u.context},...A}))}else n.push(new pe({optional:u.optional,idBlock:{tagClass:3,tagNumber:u.context},value:p.valueBlock.value}));else n.push(new pe({optional:u.optional,idBlock:{tagClass:3,tagNumber:u.context},value:[p]}));else u.repeated?n=n.concat(p):n.push(p)}let s;switch(i.type){case w.Sequence:s=new Le({value:n});break;case w.Set:s=new Fe({value:n});break;case w.Choice:if(!n[0])throw new Error(`Schema '${t.name}' has wrong data. Choice cannot be empty.`);s=n[0];break}return s}static toAsnItem(e,t,i,n){let s;if(typeof e.type=="number"){const a=e.converter;if(!a)throw new Error(`Property '${t}' doesn't have converter for type ${h[e.type]} in schema '${i.name}'`);if(e.repeated){if(!Array.isArray(n))throw new TypeError("Parameter 'objProp' should be type of Array.");const u=Array.from(n,p=>a.toASN(p)),l=e.repeated==="sequence"?Le:Fe;s=new l({value:u})}else s=a.toASN(n)}else if(e.repeated){if(!Array.isArray(n))throw new TypeError("Parameter 'objProp' should be type of Array.");const a=Array.from(n,l=>this.toASN(l)),u=e.repeated==="sequence"?Le:Fe;s=new u({value:a})}else s=this.toASN(n);return s}}class W extends Array{constructor(e=[]){if(typeof e=="number")super(e);else{super();for(const t of e)this.push(t)}}}class E{static serialize(e){return po.serialize(e)}static parse(e,t){return Jf.parse(e,t)}static toString(e){const t=C.isBufferSource(e)?C.toArrayBuffer(e):E.serialize(e),i=jt(t);if(i.offset===-1)throw new Error(`Cannot decode ASN.1 data. ${i.result.error}`);return i.result.toString()}}function o(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var u=r.length-1;u>=0;u--)(a=r[u])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s}var _l={exports:{}};(function(r){(function(e){const t="(0?\\d+|0x[a-f0-9]+)",i={fourOctet:new RegExp(`^${t}\\.${t}\\.${t}\\.${t}$`,"i"),threeOctet:new RegExp(`^${t}\\.${t}\\.${t}$`,"i"),twoOctet:new RegExp(`^${t}\\.${t}$`,"i"),longValue:new RegExp(`^${t}$`,"i")},n=new RegExp("^0[0-7]+$","i"),s=new RegExp("^0x[a-f0-9]+$","i"),a="%[0-9a-z]{1,}",u="(?:[0-9a-f]+::?)+",l={zoneIndex:new RegExp(a,"i"),native:new RegExp(`^(::)?(${u})?([0-9a-f]+)?(::)?(${a})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${t}\\.${t}\\.${t}\\.${t}(${a})?)$`,"i"),transitional:new RegExp(`^((?:${u})|(?:::)(?:${u})?)${t}\\.${t}\\.${t}\\.${t}(${a})?$`,"i")};function p(f,y){if(f.indexOf("::")!==f.lastIndexOf("::"))return null;let b=0,m=-1,k=(f.match(l.zoneIndex)||[])[0],I,q;for(k&&(k=k.substring(1),f=f.replace(/%.+$/,""));(m=f.indexOf(":",m+1))>=0;)b++;if(f.substr(0,2)==="::"&&b--,f.substr(-2,2)==="::"&&b--,b>y)return null;for(q=y-b,I=":";q--;)I+="0:";return f=f.replace("::",I),f[0]===":"&&(f=f.slice(1)),f[f.length-1]===":"&&(f=f.slice(0,-1)),y=function(){const Mr=f.split(":"),_r=[];for(let ir=0;ir<Mr.length;ir++)_r.push(parseInt(Mr[ir],16));return _r}(),{parts:y,zoneId:k}}function A(f,y,b,m){if(f.length!==y.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let k=0,I;for(;m>0;){if(I=b-m,I<0&&(I=0),f[k]>>I!==y[k]>>I)return!1;m-=b,k+=1}return!0}function S(f){if(s.test(f))return parseInt(f,16);if(f[0]==="0"&&!isNaN(parseInt(f[1],10))){if(n.test(f))return parseInt(f,8);throw new Error(`ipaddr: cannot parse ${f} as octal`)}return parseInt(f,10)}function z(f,y){for(;f.length<y;)f=`0${f}`;return f}const N={};N.IPv4=function(){function f(y){if(y.length!==4)throw new Error("ipaddr: ipv4 octet count should be 4");let b,m;for(b=0;b<y.length;b++)if(m=y[b],!(0<=m&&m<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=y}return f.prototype.SpecialRanges={unspecified:[[new f([0,0,0,0]),8]],broadcast:[[new f([255,255,255,255]),32]],multicast:[[new f([224,0,0,0]),4]],linkLocal:[[new f([169,254,0,0]),16]],loopback:[[new f([127,0,0,0]),8]],carrierGradeNat:[[new f([100,64,0,0]),10]],private:[[new f([10,0,0,0]),8],[new f([172,16,0,0]),12],[new f([192,168,0,0]),16]],reserved:[[new f([192,0,0,0]),24],[new f([192,0,2,0]),24],[new f([192,88,99,0]),24],[new f([198,18,0,0]),15],[new f([198,51,100,0]),24],[new f([203,0,113,0]),24],[new f([240,0,0,0]),4]],as112:[[new f([192,175,48,0]),24],[new f([192,31,196,0]),24]],amt:[[new f([192,52,193,0]),24]]},f.prototype.kind=function(){return"ipv4"},f.prototype.match=function(y,b){let m;if(b===void 0&&(m=y,y=m[0],b=m[1]),y.kind()!=="ipv4")throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return A(this.octets,y.octets,8,b)},f.prototype.prefixLengthFromSubnetMask=function(){let y=0,b=!1;const m={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let k,I,q;for(k=3;k>=0;k-=1)if(I=this.octets[k],I in m){if(q=m[I],b&&q!==0)return null;q!==8&&(b=!0),y+=q}else return null;return 32-y},f.prototype.range=function(){return N.subnetMatch(this,this.SpecialRanges)},f.prototype.toByteArray=function(){return this.octets.slice(0)},f.prototype.toIPv4MappedAddress=function(){return N.IPv6.parse(`::ffff:${this.toString()}`)},f.prototype.toNormalizedString=function(){return this.toString()},f.prototype.toString=function(){return this.octets.join(".")},f}(),N.IPv4.broadcastAddressFromCIDR=function(f){try{const y=this.parseCIDR(f),b=y[0].toByteArray(),m=this.subnetMaskFromPrefixLength(y[1]).toByteArray(),k=[];let I=0;for(;I<4;)k.push(parseInt(b[I],10)|parseInt(m[I],10)^255),I++;return new this(k)}catch{throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},N.IPv4.isIPv4=function(f){return this.parser(f)!==null},N.IPv4.isValid=function(f){try{return new this(this.parser(f)),!0}catch{return!1}},N.IPv4.isValidCIDR=function(f){try{return this.parseCIDR(f),!0}catch{return!1}},N.IPv4.isValidFourPartDecimal=function(f){return!!(N.IPv4.isValid(f)&&f.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},N.IPv4.networkAddressFromCIDR=function(f){let y,b,m,k,I;try{for(y=this.parseCIDR(f),m=y[0].toByteArray(),I=this.subnetMaskFromPrefixLength(y[1]).toByteArray(),k=[],b=0;b<4;)k.push(parseInt(m[b],10)&parseInt(I[b],10)),b++;return new this(k)}catch{throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},N.IPv4.parse=function(f){const y=this.parser(f);if(y===null)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(y)},N.IPv4.parseCIDR=function(f){let y;if(y=f.match(/^(.+)\/(\d+)$/)){const b=parseInt(y[2]);if(b>=0&&b<=32){const m=[this.parse(y[1]),b];return Object.defineProperty(m,"toString",{value:function(){return this.join("/")}}),m}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},N.IPv4.parser=function(f){let y,b,m;if(y=f.match(i.fourOctet))return function(){const k=y.slice(1,6),I=[];for(let q=0;q<k.length;q++)b=k[q],I.push(S(b));return I}();if(y=f.match(i.longValue)){if(m=S(y[1]),m>4294967295||m<0)throw new Error("ipaddr: address outside defined range");return function(){const k=[];let I;for(I=0;I<=24;I+=8)k.push(m>>I&255);return k}().reverse()}else return(y=f.match(i.twoOctet))?function(){const k=y.slice(1,4),I=[];if(m=S(k[1]),m>16777215||m<0)throw new Error("ipaddr: address outside defined range");return I.push(S(k[0])),I.push(m>>16&255),I.push(m>>8&255),I.push(m&255),I}():(y=f.match(i.threeOctet))?function(){const k=y.slice(1,5),I=[];if(m=S(k[2]),m>65535||m<0)throw new Error("ipaddr: address outside defined range");return I.push(S(k[0])),I.push(S(k[1])),I.push(m>>8&255),I.push(m&255),I}():null},N.IPv4.subnetMaskFromPrefixLength=function(f){if(f=parseInt(f),f<0||f>32)throw new Error("ipaddr: invalid IPv4 prefix length");const y=[0,0,0,0];let b=0;const m=Math.floor(f/8);for(;b<m;)y[b]=255,b++;return m<4&&(y[m]=Math.pow(2,f%8)-1<<8-f%8),new this(y)},N.IPv6=function(){function f(y,b){let m,k;if(y.length===16)for(this.parts=[],m=0;m<=14;m+=2)this.parts.push(y[m]<<8|y[m+1]);else if(y.length===8)this.parts=y;else throw new Error("ipaddr: ipv6 part count should be 8 or 16");for(m=0;m<this.parts.length;m++)if(k=this.parts[m],!(0<=k&&k<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");b&&(this.zoneId=b)}return f.prototype.SpecialRanges={unspecified:[new f([0,0,0,0,0,0,0,0]),128],linkLocal:[new f([65152,0,0,0,0,0,0,0]),10],multicast:[new f([65280,0,0,0,0,0,0,0]),8],loopback:[new f([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new f([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new f([0,0,0,0,0,65535,0,0]),96],discard:[new f([256,0,0,0,0,0,0,0]),64],rfc6145:[new f([0,0,0,0,65535,0,0,0]),96],rfc6052:[new f([100,65435,0,0,0,0,0,0]),96],"6to4":[new f([8194,0,0,0,0,0,0,0]),16],teredo:[new f([8193,0,0,0,0,0,0,0]),32],benchmarking:[new f([8193,2,0,0,0,0,0,0]),48],amt:[new f([8193,3,0,0,0,0,0,0]),32],as112v6:[[new f([8193,4,274,0,0,0,0,0]),48],[new f([9760,79,32768,0,0,0,0,0]),48]],deprecated:[new f([8193,16,0,0,0,0,0,0]),28],orchid2:[new f([8193,32,0,0,0,0,0,0]),28],droneRemoteIdProtocolEntityTags:[new f([8193,48,0,0,0,0,0,0]),28],reserved:[[new f([8193,0,0,0,0,0,0,0]),23],[new f([8193,3512,0,0,0,0,0,0]),32]]},f.prototype.isIPv4MappedAddress=function(){return this.range()==="ipv4Mapped"},f.prototype.kind=function(){return"ipv6"},f.prototype.match=function(y,b){let m;if(b===void 0&&(m=y,y=m[0],b=m[1]),y.kind()!=="ipv6")throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return A(this.parts,y.parts,16,b)},f.prototype.prefixLengthFromSubnetMask=function(){let y=0,b=!1;const m={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let k,I;for(let q=7;q>=0;q-=1)if(k=this.parts[q],k in m){if(I=m[k],b&&I!==0)return null;I!==16&&(b=!0),y+=I}else return null;return 128-y},f.prototype.range=function(){return N.subnetMatch(this,this.SpecialRanges)},f.prototype.toByteArray=function(){let y;const b=[],m=this.parts;for(let k=0;k<m.length;k++)y=m[k],b.push(y>>8),b.push(y&255);return b},f.prototype.toFixedLengthString=function(){const y=(function(){const m=[];for(let k=0;k<this.parts.length;k++)m.push(z(this.parts[k].toString(16),4));return m}).call(this).join(":");let b="";return this.zoneId&&(b=`%${this.zoneId}`),y+b},f.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");const y=this.parts.slice(-2),b=y[0],m=y[1];return new N.IPv4([b>>8,b&255,m>>8,m&255])},f.prototype.toNormalizedString=function(){const y=(function(){const m=[];for(let k=0;k<this.parts.length;k++)m.push(this.parts[k].toString(16));return m}).call(this).join(":");let b="";return this.zoneId&&(b=`%${this.zoneId}`),y+b},f.prototype.toRFC5952String=function(){const y=/((^|:)(0(:|$)){2,})/g,b=this.toNormalizedString();let m=0,k=-1,I;for(;I=y.exec(b);)I[0].length>k&&(m=I.index,k=I[0].length);return k<0?b:`${b.substring(0,m)}::${b.substring(m+k)}`},f.prototype.toString=function(){return this.toRFC5952String()},f}(),N.IPv6.broadcastAddressFromCIDR=function(f){try{const y=this.parseCIDR(f),b=y[0].toByteArray(),m=this.subnetMaskFromPrefixLength(y[1]).toByteArray(),k=[];let I=0;for(;I<16;)k.push(parseInt(b[I],10)|parseInt(m[I],10)^255),I++;return new this(k)}catch(y){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${y})`)}},N.IPv6.isIPv6=function(f){return this.parser(f)!==null},N.IPv6.isValid=function(f){if(typeof f=="string"&&f.indexOf(":")===-1)return!1;try{const y=this.parser(f);return new this(y.parts,y.zoneId),!0}catch{return!1}},N.IPv6.isValidCIDR=function(f){if(typeof f=="string"&&f.indexOf(":")===-1)return!1;try{return this.parseCIDR(f),!0}catch{return!1}},N.IPv6.networkAddressFromCIDR=function(f){let y,b,m,k,I;try{for(y=this.parseCIDR(f),m=y[0].toByteArray(),I=this.subnetMaskFromPrefixLength(y[1]).toByteArray(),k=[],b=0;b<16;)k.push(parseInt(m[b],10)&parseInt(I[b],10)),b++;return new this(k)}catch(q){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${q})`)}},N.IPv6.parse=function(f){const y=this.parser(f);if(y.parts===null)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(y.parts,y.zoneId)},N.IPv6.parseCIDR=function(f){let y,b,m;if((b=f.match(/^(.+)\/(\d+)$/))&&(y=parseInt(b[2]),y>=0&&y<=128))return m=[this.parse(b[1]),y],Object.defineProperty(m,"toString",{value:function(){return this.join("/")}}),m;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},N.IPv6.parser=function(f){let y,b,m,k,I,q;if(m=f.match(l.deprecatedTransitional))return this.parser(`::ffff:${m[1]}`);if(l.native.test(f))return p(f,8);if((m=f.match(l.transitional))&&(q=m[6]||"",y=m[1],m[1].endsWith("::")||(y=y.slice(0,-1)),y=p(y+q,6),y.parts)){for(I=[parseInt(m[2]),parseInt(m[3]),parseInt(m[4]),parseInt(m[5])],b=0;b<I.length;b++)if(k=I[b],!(0<=k&&k<=255))return null;return y.parts.push(I[0]<<8|I[1]),y.parts.push(I[2]<<8|I[3]),{parts:y.parts,zoneId:y.zoneId}}return null},N.IPv6.subnetMaskFromPrefixLength=function(f){if(f=parseInt(f),f<0||f>128)throw new Error("ipaddr: invalid IPv6 prefix length");const y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let b=0;const m=Math.floor(f/8);for(;b<m;)y[b]=255,b++;return m<16&&(y[m]=Math.pow(2,f%8)-1<<8-f%8),new this(y)},N.fromByteArray=function(f){const y=f.length;if(y===4)return new N.IPv4(f);if(y===16)return new N.IPv6(f);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},N.isValid=function(f){return N.IPv6.isValid(f)||N.IPv4.isValid(f)},N.isValidCIDR=function(f){return N.IPv6.isValidCIDR(f)||N.IPv4.isValidCIDR(f)},N.parse=function(f){if(N.IPv6.isValid(f))return N.IPv6.parse(f);if(N.IPv4.isValid(f))return N.IPv4.parse(f);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},N.parseCIDR=function(f){try{return N.IPv6.parseCIDR(f)}catch{try{return N.IPv4.parseCIDR(f)}catch{throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},N.process=function(f){const y=this.parse(f);return y.kind()==="ipv6"&&y.isIPv4MappedAddress()?y.toIPv4Address():y},N.subnetMatch=function(f,y,b){let m,k,I,q;b==null&&(b="unicast");for(k in y)if(Object.prototype.hasOwnProperty.call(y,k)){for(I=y[k],I[0]&&!(I[0]instanceof Array)&&(I=[I]),m=0;m<I.length;m++)if(q=I[m],f.kind()===q[0].kind()&&f.match.apply(f,q))return k}return b},r.exports?r.exports=N:e.ipaddr=N})(Mn)})(_l);var ua=_l.exports;class fa{static decodeIP(e){if(e.length===64&&parseInt(e,16)===0)return"::/0";if(e.length!==16)return e;const t=parseInt(e.slice(8),16).toString(2).split("").reduce((n,s)=>n+ +s,0);let i=e.slice(0,8).replace(/(.{2})/g,n=>`${parseInt(n,16)}.`);return i=i.slice(0,-1),`${i}/${t}`}static toString(e){if(e.byteLength===4||e.byteLength===16){const t=new Uint8Array(e);return ua.fromByteArray(Array.from(t)).toString()}return this.decodeIP(R.ToHex(e))}static fromString(e){const t=ua.parse(e);return new Uint8Array(t.toByteArray()).buffer}}var Hn,Ln,Fn;let se=class{constructor(e={}){Object.assign(this,e)}toString(){return this.bmpString||this.printableString||this.teletexString||this.universalString||this.utf8String||""}};o([c({type:h.TeletexString})],se.prototype,"teletexString",void 0);o([c({type:h.PrintableString})],se.prototype,"printableString",void 0);o([c({type:h.UniversalString})],se.prototype,"universalString",void 0);o([c({type:h.Utf8String})],se.prototype,"utf8String",void 0);o([c({type:h.BmpString})],se.prototype,"bmpString",void 0);se=o([x({type:w.Choice})],se);let Vt=class extends se{constructor(e={}){super(e),Object.assign(this,e)}toString(){return this.ia5String||(this.anyValue?R.ToHex(this.anyValue):super.toString())}};o([c({type:h.IA5String})],Vt.prototype,"ia5String",void 0);o([c({type:h.Any})],Vt.prototype,"anyValue",void 0);Vt=o([x({type:w.Choice})],Vt);class zi{constructor(e={}){this.type="",this.value=new Vt,Object.assign(this,e)}}o([c({type:h.ObjectIdentifier})],zi.prototype,"type",void 0);o([c({type:Vt})],zi.prototype,"value",void 0);let Rt=Hn=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,Hn.prototype)}};Rt=Hn=o([x({type:w.Set,itemType:zi})],Rt);let zn=Ln=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,Ln.prototype)}};zn=Ln=o([x({type:w.Sequence,itemType:Rt})],zn);let ee=Fn=class extends zn{constructor(e){super(e),Object.setPrototypeOf(this,Fn.prototype)}};ee=Fn=o([x({type:w.Sequence})],ee);const Yf={fromASN:r=>fa.toString(Yr.fromASN(r)),toASN:r=>Yr.toASN(fa.fromString(r))};class fr{constructor(e={}){this.typeId="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}o([c({type:h.ObjectIdentifier})],fr.prototype,"typeId",void 0);o([c({type:h.Any,context:0})],fr.prototype,"value",void 0);class yo{constructor(e={}){this.partyName=new se,Object.assign(this,e)}}o([c({type:se,optional:!0,context:0,implicit:!0})],yo.prototype,"nameAssigner",void 0);o([c({type:se,context:1,implicit:!0})],yo.prototype,"partyName",void 0);let U=class{constructor(e={}){Object.assign(this,e)}};o([c({type:fr,context:0,implicit:!0})],U.prototype,"otherName",void 0);o([c({type:h.IA5String,context:1,implicit:!0})],U.prototype,"rfc822Name",void 0);o([c({type:h.IA5String,context:2,implicit:!0})],U.prototype,"dNSName",void 0);o([c({type:h.Any,context:3,implicit:!0})],U.prototype,"x400Address",void 0);o([c({type:ee,context:4,implicit:!1})],U.prototype,"directoryName",void 0);o([c({type:yo,context:5})],U.prototype,"ediPartyName",void 0);o([c({type:h.IA5String,context:6,implicit:!0})],U.prototype,"uniformResourceIdentifier",void 0);o([c({type:h.OctetString,context:7,implicit:!0,converter:Yf})],U.prototype,"iPAddress",void 0);o([c({type:h.ObjectIdentifier,context:8,implicit:!0})],U.prototype,"registeredID",void 0);U=o([x({type:w.Choice})],U);const vo="1.3.6.1.5.5.7",Qf=`${vo}.1`,Kt=`${vo}.3`,Gi=`${vo}.48`,ha=`${Gi}.1`,pa=`${Gi}.2`,da=`${Gi}.3`,ya=`${Gi}.5`,st="2.5.29";var Gn;const Wn=`${Qf}.1`;class Ir{constructor(e={}){this.accessMethod="",this.accessLocation=new U,Object.assign(this,e)}}o([c({type:h.ObjectIdentifier})],Ir.prototype,"accessMethod",void 0);o([c({type:U})],Ir.prototype,"accessLocation",void 0);let Ot=Gn=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,Gn.prototype)}};Ot=Gn=o([x({type:w.Sequence,itemType:Ir})],Ot);const qn=`${st}.35`;class go extends F{}class ut{constructor(e={}){e&&Object.assign(this,e)}}o([c({type:go,context:0,optional:!0,implicit:!0})],ut.prototype,"keyIdentifier",void 0);o([c({type:U,context:1,optional:!0,implicit:!0,repeated:"sequence"})],ut.prototype,"authorityCertIssuer",void 0);o([c({type:h.Integer,context:2,optional:!0,implicit:!0,converter:J})],ut.prototype,"authorityCertSerialNumber",void 0);const Ul=`${st}.19`;class Qr{constructor(e={}){this.cA=!1,Object.assign(this,e)}}o([c({type:h.Boolean,defaultValue:!1})],Qr.prototype,"cA",void 0);o([c({type:h.Integer,optional:!0})],Qr.prototype,"pathLenConstraint",void 0);var Kn;let ce=Kn=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,Kn.prototype)}};ce=Kn=o([x({type:w.Sequence,itemType:U})],ce);var Jn;let va=Jn=class extends ce{constructor(e){super(e),Object.setPrototypeOf(this,Jn.prototype)}};va=Jn=o([x({type:w.Sequence})],va);var Yn;const $l=`${st}.32`;let ze=class{constructor(e={}){Object.assign(this,e)}toString(){return this.ia5String||this.visibleString||this.bmpString||this.utf8String||""}};o([c({type:h.IA5String})],ze.prototype,"ia5String",void 0);o([c({type:h.VisibleString})],ze.prototype,"visibleString",void 0);o([c({type:h.BmpString})],ze.prototype,"bmpString",void 0);o([c({type:h.Utf8String})],ze.prototype,"utf8String",void 0);ze=o([x({type:w.Choice})],ze);class mo{constructor(e={}){this.organization=new ze,this.noticeNumbers=[],Object.assign(this,e)}}o([c({type:ze})],mo.prototype,"organization",void 0);o([c({type:h.Integer,repeated:"sequence"})],mo.prototype,"noticeNumbers",void 0);class bo{constructor(e={}){Object.assign(this,e)}}o([c({type:mo,optional:!0})],bo.prototype,"noticeRef",void 0);o([c({type:ze,optional:!0})],bo.prototype,"explicitText",void 0);let Zr=class{constructor(e={}){Object.assign(this,e)}};o([c({type:h.IA5String})],Zr.prototype,"cPSuri",void 0);o([c({type:bo})],Zr.prototype,"userNotice",void 0);Zr=o([x({type:w.Choice})],Zr);class wo{constructor(e={}){this.policyQualifierId="",this.qualifier=new ArrayBuffer(0),Object.assign(this,e)}}o([c({type:h.ObjectIdentifier})],wo.prototype,"policyQualifierId",void 0);o([c({type:h.Any})],wo.prototype,"qualifier",void 0);class Wi{constructor(e={}){this.policyIdentifier="",Object.assign(this,e)}}o([c({type:h.ObjectIdentifier})],Wi.prototype,"policyIdentifier",void 0);o([c({type:wo,repeated:"sequence",optional:!0})],Wi.prototype,"policyQualifiers",void 0);let Xr=Yn=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,Yn.prototype)}};Xr=Yn=o([x({type:w.Sequence,itemType:Wi})],Xr);let ei=class{constructor(e=0){this.value=e}};o([c({type:h.Integer})],ei.prototype,"value",void 0);ei=o([x({type:w.Choice})],ei);let ga=class extends ei{};ga=o([x({type:w.Choice})],ga);var Qn;const Zn=`${st}.31`;var Ce;(function(r){r[r.unused=1]="unused",r[r.keyCompromise=2]="keyCompromise",r[r.cACompromise=4]="cACompromise",r[r.affiliationChanged=8]="affiliationChanged",r[r.superseded=16]="superseded",r[r.cessationOfOperation=32]="cessationOfOperation",r[r.certificateHold=64]="certificateHold",r[r.privilegeWithdrawn=128]="privilegeWithdrawn",r[r.aACompromise=256]="aACompromise"})(Ce||(Ce={}));class Hl extends Fi{toJSON(){const e=[],t=this.toNumber();return t&Ce.aACompromise&&e.push("aACompromise"),t&Ce.affiliationChanged&&e.push("affiliationChanged"),t&Ce.cACompromise&&e.push("cACompromise"),t&Ce.certificateHold&&e.push("certificateHold"),t&Ce.cessationOfOperation&&e.push("cessationOfOperation"),t&Ce.keyCompromise&&e.push("keyCompromise"),t&Ce.privilegeWithdrawn&&e.push("privilegeWithdrawn"),t&Ce.superseded&&e.push("superseded"),t&Ce.unused&&e.push("unused"),e}toString(){return`[${this.toJSON().join(", ")}]`}}let vt=class{constructor(e={}){Object.assign(this,e)}};o([c({type:U,context:0,repeated:"sequence",implicit:!0})],vt.prototype,"fullName",void 0);o([c({type:Rt,context:1,implicit:!0})],vt.prototype,"nameRelativeToCRLIssuer",void 0);vt=o([x({type:w.Choice})],vt);class Jt{constructor(e={}){Object.assign(this,e)}}o([c({type:vt,context:0,optional:!0})],Jt.prototype,"distributionPoint",void 0);o([c({type:Hl,context:1,optional:!0,implicit:!0})],Jt.prototype,"reasons",void 0);o([c({type:U,context:2,optional:!0,repeated:"sequence",implicit:!0})],Jt.prototype,"cRLIssuer",void 0);let Tt=Qn=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,Qn.prototype)}};Tt=Qn=o([x({type:w.Sequence,itemType:Jt})],Tt);var Xn;let ma=Xn=class extends Tt{constructor(e){super(e),Object.setPrototypeOf(this,Xn.prototype)}};ma=Xn=o([x({type:w.Sequence,itemType:Jt})],ma);class oe{constructor(e={}){this.onlyContainsUserCerts=oe.ONLY,this.onlyContainsCACerts=oe.ONLY,this.indirectCRL=oe.ONLY,this.onlyContainsAttributeCerts=oe.ONLY,Object.assign(this,e)}}oe.ONLY=!1;o([c({type:vt,context:0,optional:!0})],oe.prototype,"distributionPoint",void 0);o([c({type:h.Boolean,context:1,defaultValue:oe.ONLY,implicit:!0})],oe.prototype,"onlyContainsUserCerts",void 0);o([c({type:h.Boolean,context:2,defaultValue:oe.ONLY,implicit:!0})],oe.prototype,"onlyContainsCACerts",void 0);o([c({type:Hl,context:3,optional:!0,implicit:!0})],oe.prototype,"onlySomeReasons",void 0);o([c({type:h.Boolean,context:4,defaultValue:oe.ONLY,implicit:!0})],oe.prototype,"indirectCRL",void 0);o([c({type:h.Boolean,context:5,defaultValue:oe.ONLY,implicit:!0})],oe.prototype,"onlyContainsAttributeCerts",void 0);var or;(function(r){r[r.unspecified=0]="unspecified",r[r.keyCompromise=1]="keyCompromise",r[r.cACompromise=2]="cACompromise",r[r.affiliationChanged=3]="affiliationChanged",r[r.superseded=4]="superseded",r[r.cessationOfOperation=5]="cessationOfOperation",r[r.certificateHold=6]="certificateHold",r[r.removeFromCRL=8]="removeFromCRL",r[r.privilegeWithdrawn=9]="privilegeWithdrawn",r[r.aACompromise=10]="aACompromise"})(or||(or={}));let es=class{constructor(e=or.unspecified){this.reason=or.unspecified,this.reason=e}toJSON(){return or[this.reason]}toString(){return this.toJSON()}};o([c({type:h.Enumerated})],es.prototype,"reason",void 0);es=o([x({type:w.Choice})],es);var ts;const Ll=`${st}.37`;let ti=ts=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,ts.prototype)}};ti=ts=o([x({type:w.Sequence,itemType:h.ObjectIdentifier})],ti);const Zf=`${Kt}.1`,Xf=`${Kt}.2`,eh=`${Kt}.3`,th=`${Kt}.4`,rh=`${Kt}.8`,ih=`${Kt}.9`;let rs=class{constructor(e=new ArrayBuffer(0)){this.value=e}};o([c({type:h.Integer,converter:J})],rs.prototype,"value",void 0);rs=o([x({type:w.Choice})],rs);let is=class{constructor(e){this.value=new Date,e&&(this.value=e)}};o([c({type:h.GeneralizedTime})],is.prototype,"value",void 0);is=o([x({type:w.Choice})],is);var ns;let ba=ns=class extends ce{constructor(e){super(e),Object.setPrototypeOf(this,ns.prototype)}};ba=ns=o([x({type:w.Sequence})],ba);const Fl=`${st}.15`;var Ee;(function(r){r[r.digitalSignature=1]="digitalSignature",r[r.nonRepudiation=2]="nonRepudiation",r[r.keyEncipherment=4]="keyEncipherment",r[r.dataEncipherment=8]="dataEncipherment",r[r.keyAgreement=16]="keyAgreement",r[r.keyCertSign=32]="keyCertSign",r[r.cRLSign=64]="cRLSign",r[r.encipherOnly=128]="encipherOnly",r[r.decipherOnly=256]="decipherOnly"})(Ee||(Ee={}));class Cn extends Fi{toJSON(){const e=this.toNumber(),t=[];return e&Ee.cRLSign&&t.push("crlSign"),e&Ee.dataEncipherment&&t.push("dataEncipherment"),e&Ee.decipherOnly&&t.push("decipherOnly"),e&Ee.digitalSignature&&t.push("digitalSignature"),e&Ee.encipherOnly&&t.push("encipherOnly"),e&Ee.keyAgreement&&t.push("keyAgreement"),e&Ee.keyCertSign&&t.push("keyCertSign"),e&Ee.keyEncipherment&&t.push("keyEncipherment"),e&Ee.nonRepudiation&&t.push("nonRepudiation"),t}toString(){return`[${this.toJSON().join(", ")}]`}}var ss;class qi{constructor(e={}){this.base=new U,this.minimum=0,Object.assign(this,e)}}o([c({type:U})],qi.prototype,"base",void 0);o([c({type:h.Integer,context:0,defaultValue:0,implicit:!0})],qi.prototype,"minimum",void 0);o([c({type:h.Integer,context:1,optional:!0,implicit:!0})],qi.prototype,"maximum",void 0);let ri=ss=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,ss.prototype)}};ri=ss=o([x({type:w.Sequence,itemType:qi})],ri);class zl{constructor(e={}){Object.assign(this,e)}}o([c({type:ri,context:0,optional:!0,implicit:!0})],zl.prototype,"permittedSubtrees",void 0);o([c({type:ri,context:1,optional:!0,implicit:!0})],zl.prototype,"excludedSubtrees",void 0);class Gl{constructor(e={}){Object.assign(this,e)}}o([c({type:h.Integer,context:0,implicit:!0,optional:!0,converter:J})],Gl.prototype,"requireExplicitPolicy",void 0);o([c({type:h.Integer,context:1,implicit:!0,optional:!0,converter:J})],Gl.prototype,"inhibitPolicyMapping",void 0);var os;class Ao{constructor(e={}){this.issuerDomainPolicy="",this.subjectDomainPolicy="",Object.assign(this,e)}}o([c({type:h.ObjectIdentifier})],Ao.prototype,"issuerDomainPolicy",void 0);o([c({type:h.ObjectIdentifier})],Ao.prototype,"subjectDomainPolicy",void 0);let wa=os=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,os.prototype)}};wa=os=o([x({type:w.Sequence,itemType:Ao})],wa);var as;const Wl=`${st}.17`;let cs=as=class extends ce{constructor(e){super(e),Object.setPrototypeOf(this,as.prototype)}};cs=as=o([x({type:w.Sequence})],cs);let Ge=class{constructor(e={}){this.type="",this.values=[],Object.assign(this,e)}};o([c({type:h.ObjectIdentifier})],Ge.prototype,"type",void 0);o([c({type:h.Any,repeated:"set"})],Ge.prototype,"values",void 0);var ls;let Aa=ls=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,ls.prototype)}};Aa=ls=o([x({type:w.Sequence,itemType:Ge})],Aa);const ql=`${st}.14`;class tt extends go{}class Kl{constructor(e={}){Object.assign(this,e)}}o([c({type:h.GeneralizedTime,context:0,implicit:!0,optional:!0})],Kl.prototype,"notBefore",void 0);o([c({type:h.GeneralizedTime,context:1,implicit:!0,optional:!0})],Kl.prototype,"notAfter",void 0);var ar;(function(r){r[r.keyUpdateAllowed=1]="keyUpdateAllowed",r[r.newExtensions=2]="newExtensions",r[r.pKIXCertificate=4]="pKIXCertificate"})(ar||(ar={}));class Jl extends Fi{toJSON(){const e=[],t=this.toNumber();return t&ar.pKIXCertificate&&e.push("pKIXCertificate"),t&ar.newExtensions&&e.push("newExtensions"),t&ar.keyUpdateAllowed&&e.push("keyUpdateAllowed"),e}toString(){return`[${this.toJSON().join(", ")}]`}}class Yl{constructor(e={}){this.entrustVers="",this.entrustInfoFlags=new Jl,Object.assign(this,e)}}o([c({type:h.GeneralString})],Yl.prototype,"entrustVers",void 0);o([c({type:Jl})],Yl.prototype,"entrustInfoFlags",void 0);var us;let Sa=us=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,us.prototype)}};Sa=us=o([x({type:w.Sequence,itemType:Ir})],Sa);class j{constructor(e={}){this.algorithm="",Object.assign(this,e)}isEqual(e){return e instanceof j&&e.algorithm==this.algorithm&&(e.parameters&&this.parameters&&Dc(e.parameters,this.parameters)||e.parameters===this.parameters)}}o([c({type:h.ObjectIdentifier})],j.prototype,"algorithm",void 0);o([c({type:h.Any,optional:!0})],j.prototype,"parameters",void 0);class Ve{constructor(e={}){this.algorithm=new j,this.subjectPublicKey=new ArrayBuffer(0),Object.assign(this,e)}}o([c({type:j})],Ve.prototype,"algorithm",void 0);o([c({type:h.BitString})],Ve.prototype,"subjectPublicKey",void 0);let ie=class{constructor(e){if(e)if(typeof e=="string"||typeof e=="number"||e instanceof Date){const t=new Date(e);t.getUTCFullYear()>2049?this.generalTime=t:this.utcTime=t}else Object.assign(this,e)}getTime(){const e=this.utcTime||this.generalTime;if(!e)throw new Error("Cannot get time from CHOICE object");return e}};o([c({type:h.UTCTime})],ie.prototype,"utcTime",void 0);o([c({type:h.GeneralizedTime})],ie.prototype,"generalTime",void 0);ie=o([x({type:w.Choice})],ie);class Ki{constructor(e){this.notBefore=new ie(new Date),this.notAfter=new ie(new Date),e&&(this.notBefore=new ie(e.notBefore),this.notAfter=new ie(e.notAfter))}}o([c({type:ie})],Ki.prototype,"notBefore",void 0);o([c({type:ie})],Ki.prototype,"notAfter",void 0);var fs;let Ne=class Ql{constructor(e={}){this.extnID="",this.critical=Ql.CRITICAL,this.extnValue=new F,Object.assign(this,e)}};Ne.CRITICAL=!1;o([c({type:h.ObjectIdentifier})],Ne.prototype,"extnID",void 0);o([c({type:h.Boolean,defaultValue:Ne.CRITICAL})],Ne.prototype,"critical",void 0);o([c({type:F})],Ne.prototype,"extnValue",void 0);let gt=fs=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,fs.prototype)}};gt=fs=o([x({type:w.Sequence,itemType:Ne})],gt);var Dt;(function(r){r[r.v1=0]="v1",r[r.v2=1]="v2",r[r.v3=2]="v3"})(Dt||(Dt={}));class xe{constructor(e={}){this.version=Dt.v1,this.serialNumber=new ArrayBuffer(0),this.signature=new j,this.issuer=new ee,this.validity=new Ki,this.subject=new ee,this.subjectPublicKeyInfo=new Ve,Object.assign(this,e)}}o([c({type:h.Integer,context:0,defaultValue:Dt.v1})],xe.prototype,"version",void 0);o([c({type:h.Integer,converter:J})],xe.prototype,"serialNumber",void 0);o([c({type:j})],xe.prototype,"signature",void 0);o([c({type:ee})],xe.prototype,"issuer",void 0);o([c({type:Ki})],xe.prototype,"validity",void 0);o([c({type:ee})],xe.prototype,"subject",void 0);o([c({type:Ve})],xe.prototype,"subjectPublicKeyInfo",void 0);o([c({type:h.BitString,context:1,implicit:!0,optional:!0})],xe.prototype,"issuerUniqueID",void 0);o([c({type:h.BitString,context:2,implicit:!0,optional:!0})],xe.prototype,"subjectUniqueID",void 0);o([c({type:gt,context:3,optional:!0})],xe.prototype,"extensions",void 0);class Mt{constructor(e={}){this.tbsCertificate=new xe,this.signatureAlgorithm=new j,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}o([c({type:xe})],Mt.prototype,"tbsCertificate",void 0);o([c({type:j})],Mt.prototype,"signatureAlgorithm",void 0);o([c({type:h.BitString})],Mt.prototype,"signatureValue",void 0);class Ji{constructor(e={}){this.userCertificate=new ArrayBuffer(0),this.revocationDate=new ie,Object.assign(this,e)}}o([c({type:h.Integer,converter:J})],Ji.prototype,"userCertificate",void 0);o([c({type:ie})],Ji.prototype,"revocationDate",void 0);o([c({type:Ne,optional:!0,repeated:"sequence"})],Ji.prototype,"crlEntryExtensions",void 0);class Qe{constructor(e={}){this.signature=new j,this.issuer=new ee,this.thisUpdate=new ie,Object.assign(this,e)}}o([c({type:h.Integer,optional:!0})],Qe.prototype,"version",void 0);o([c({type:j})],Qe.prototype,"signature",void 0);o([c({type:ee})],Qe.prototype,"issuer",void 0);o([c({type:ie})],Qe.prototype,"thisUpdate",void 0);o([c({type:ie,optional:!0})],Qe.prototype,"nextUpdate",void 0);o([c({type:Ji,repeated:"sequence",optional:!0})],Qe.prototype,"revokedCertificates",void 0);o([c({type:Ne,optional:!0,context:0,repeated:"sequence"})],Qe.prototype,"crlExtensions",void 0);class So{constructor(e={}){this.tbsCertList=new Qe,this.signatureAlgorithm=new j,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}o([c({type:Qe})],So.prototype,"tbsCertList",void 0);o([c({type:j})],So.prototype,"signatureAlgorithm",void 0);o([c({type:h.BitString})],So.prototype,"signature",void 0);class Yt{constructor(e={}){this.issuer=new ee,this.serialNumber=new ArrayBuffer(0),Object.assign(this,e)}}o([c({type:ee})],Yt.prototype,"issuer",void 0);o([c({type:h.Integer,converter:J})],Yt.prototype,"serialNumber",void 0);let _t=class{constructor(e={}){Object.assign(this,e)}};o([c({type:tt,context:0,implicit:!0})],_t.prototype,"subjectKeyIdentifier",void 0);o([c({type:Yt})],_t.prototype,"issuerAndSerialNumber",void 0);_t=o([x({type:w.Choice})],_t);var We;(function(r){r[r.v0=0]="v0",r[r.v1=1]="v1",r[r.v2=2]="v2",r[r.v3=3]="v3",r[r.v4=4]="v4",r[r.v5=5]="v5"})(We||(We={}));let hr=class extends j{};hr=o([x({type:w.Sequence})],hr);let ii=class extends j{};ii=o([x({type:w.Sequence})],ii);let Me=class extends j{};Me=o([x({type:w.Sequence})],Me);let ni=class extends j{};ni=o([x({type:w.Sequence})],ni);let xa=class extends j{};xa=o([x({type:w.Sequence})],xa);let hs=class extends j{};hs=o([x({type:w.Sequence})],hs);let Qt=class{constructor(e={}){this.attrType="",this.attrValues=[],Object.assign(this,e)}};o([c({type:h.ObjectIdentifier})],Qt.prototype,"attrType",void 0);o([c({type:h.Any,repeated:"set"})],Qt.prototype,"attrValues",void 0);var ps;class Ue{constructor(e={}){this.version=We.v0,this.sid=new _t,this.digestAlgorithm=new hr,this.signatureAlgorithm=new ii,this.signature=new F,Object.assign(this,e)}}o([c({type:h.Integer})],Ue.prototype,"version",void 0);o([c({type:_t})],Ue.prototype,"sid",void 0);o([c({type:hr})],Ue.prototype,"digestAlgorithm",void 0);o([c({type:Qt,repeated:"set",context:0,implicit:!0,optional:!0})],Ue.prototype,"signedAttrs",void 0);o([c({type:ii})],Ue.prototype,"signatureAlgorithm",void 0);o([c({type:F})],Ue.prototype,"signature",void 0);o([c({type:Qt,repeated:"set",context:1,implicit:!0,optional:!0})],Ue.prototype,"unsignedAttrs",void 0);let si=ps=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,ps.prototype)}};si=ps=o([x({type:w.Set,itemType:Ue})],si);let Ba=class extends ie{};Ba=o([x({type:w.Choice})],Ba);let Ia=class extends Ue{};Ia=o([x({type:w.Sequence})],Ia);class xo{constructor(e={}){this.acIssuer=new U,this.acSerial=0,this.attrs=[],Object.assign(this,e)}}o([c({type:U})],xo.prototype,"acIssuer",void 0);o([c({type:h.Integer})],xo.prototype,"acSerial",void 0);o([c({type:Ge,repeated:"sequence"})],xo.prototype,"attrs",void 0);var ds;let oi=ds=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,ds.prototype)}};oi=ds=o([x({type:w.Sequence,itemType:h.ObjectIdentifier})],oi);class Yi{constructor(e={}){this.permitUnSpecified=!0,Object.assign(this,e)}}o([c({type:h.Integer,optional:!0})],Yi.prototype,"pathLenConstraint",void 0);o([c({type:oi,implicit:!0,context:0,optional:!0})],Yi.prototype,"permittedAttrs",void 0);o([c({type:oi,implicit:!0,context:1,optional:!0})],Yi.prototype,"excludedAttrs",void 0);o([c({type:h.Boolean,defaultValue:!0})],Yi.prototype,"permitUnSpecified",void 0);class Bt{constructor(e={}){this.issuer=new ce,this.serial=new ArrayBuffer(0),this.issuerUID=new ArrayBuffer(0),Object.assign(this,e)}}o([c({type:ce})],Bt.prototype,"issuer",void 0);o([c({type:h.Integer,converter:J})],Bt.prototype,"serial",void 0);o([c({type:h.BitString,optional:!0})],Bt.prototype,"issuerUID",void 0);var ys;(function(r){r[r.publicKey=0]="publicKey",r[r.publicKeyCert=1]="publicKeyCert",r[r.otherObjectTypes=2]="otherObjectTypes"})(ys||(ys={}));class It{constructor(e={}){this.digestedObjectType=ys.publicKey,this.digestAlgorithm=new j,this.objectDigest=new ArrayBuffer(0),Object.assign(this,e)}}o([c({type:h.Enumerated})],It.prototype,"digestedObjectType",void 0);o([c({type:h.ObjectIdentifier,optional:!0})],It.prototype,"otherObjectTypeID",void 0);o([c({type:j})],It.prototype,"digestAlgorithm",void 0);o([c({type:h.BitString})],It.prototype,"objectDigest",void 0);class Qi{constructor(e={}){Object.assign(this,e)}}o([c({type:ce,optional:!0})],Qi.prototype,"issuerName",void 0);o([c({type:Bt,context:0,implicit:!0,optional:!0})],Qi.prototype,"baseCertificateID",void 0);o([c({type:It,context:1,implicit:!0,optional:!0})],Qi.prototype,"objectDigestInfo",void 0);let Ut=class{constructor(e={}){Object.assign(this,e)}};o([c({type:U,repeated:"sequence"})],Ut.prototype,"v1Form",void 0);o([c({type:Qi,context:0,implicit:!0})],Ut.prototype,"v2Form",void 0);Ut=o([x({type:w.Choice})],Ut);class Zi{constructor(e={}){this.notBeforeTime=new Date,this.notAfterTime=new Date,Object.assign(this,e)}}o([c({type:h.GeneralizedTime})],Zi.prototype,"notBeforeTime",void 0);o([c({type:h.GeneralizedTime})],Zi.prototype,"notAfterTime",void 0);class kr{constructor(e={}){Object.assign(this,e)}}o([c({type:Bt,implicit:!0,context:0,optional:!0})],kr.prototype,"baseCertificateID",void 0);o([c({type:ce,implicit:!0,context:1,optional:!0})],kr.prototype,"entityName",void 0);o([c({type:It,implicit:!0,context:2,optional:!0})],kr.prototype,"objectDigestInfo",void 0);var vs;(function(r){r[r.v2=1]="v2"})(vs||(vs={}));class je{constructor(e={}){this.version=vs.v2,this.holder=new kr,this.issuer=new Ut,this.signature=new j,this.serialNumber=new ArrayBuffer(0),this.attrCertValidityPeriod=new Zi,this.attributes=[],Object.assign(this,e)}}o([c({type:h.Integer})],je.prototype,"version",void 0);o([c({type:kr})],je.prototype,"holder",void 0);o([c({type:Ut})],je.prototype,"issuer",void 0);o([c({type:j})],je.prototype,"signature",void 0);o([c({type:h.Integer,converter:J})],je.prototype,"serialNumber",void 0);o([c({type:Zi})],je.prototype,"attrCertValidityPeriod",void 0);o([c({type:Ge,repeated:"sequence"})],je.prototype,"attributes",void 0);o([c({type:h.BitString,optional:!0})],je.prototype,"issuerUniqueID",void 0);o([c({type:gt,optional:!0})],je.prototype,"extensions",void 0);class Xi{constructor(e={}){this.acinfo=new je,this.signatureAlgorithm=new j,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}o([c({type:je})],Xi.prototype,"acinfo",void 0);o([c({type:j})],Xi.prototype,"signatureAlgorithm",void 0);o([c({type:h.BitString})],Xi.prototype,"signatureValue",void 0);var ai;(function(r){r[r.unmarked=1]="unmarked",r[r.unclassified=2]="unclassified",r[r.restricted=4]="restricted",r[r.confidential=8]="confidential",r[r.secret=16]="secret",r[r.topSecret=32]="topSecret"})(ai||(ai={}));class gs extends Fi{}class Bo{constructor(e={}){this.type="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}o([c({type:h.ObjectIdentifier,implicit:!0,context:0})],Bo.prototype,"type",void 0);o([c({type:h.Any,implicit:!0,context:1})],Bo.prototype,"value",void 0);class Io{constructor(e={}){this.policyId="",this.classList=new gs(ai.unclassified),Object.assign(this,e)}}o([c({type:h.ObjectIdentifier})],Io.prototype,"policyId",void 0);o([c({type:gs,defaultValue:new gs(ai.unclassified)})],Io.prototype,"classList",void 0);o([c({type:Bo,repeated:"set"})],Io.prototype,"securityCategories",void 0);class en{constructor(e={}){Object.assign(this,e)}}o([c({type:F})],en.prototype,"cotets",void 0);o([c({type:h.ObjectIdentifier})],en.prototype,"oid",void 0);o([c({type:h.Utf8String})],en.prototype,"string",void 0);class Zl{constructor(e={}){this.values=[],Object.assign(this,e)}}o([c({type:ce,implicit:!0,context:0,optional:!0})],Zl.prototype,"policyAuthority",void 0);o([c({type:en,repeated:"sequence"})],Zl.prototype,"values",void 0);var ms;class tn{constructor(e={}){this.targetCertificate=new Bt,Object.assign(this,e)}}o([c({type:Bt})],tn.prototype,"targetCertificate",void 0);o([c({type:U,optional:!0})],tn.prototype,"targetName",void 0);o([c({type:It,optional:!0})],tn.prototype,"certDigestInfo",void 0);let $t=class{constructor(e={}){Object.assign(this,e)}};o([c({type:U,context:0,implicit:!0})],$t.prototype,"targetName",void 0);o([c({type:U,context:1,implicit:!0})],$t.prototype,"targetGroup",void 0);o([c({type:tn,context:2,implicit:!0})],$t.prototype,"targetCert",void 0);$t=o([x({type:w.Choice})],$t);let bs=ms=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,ms.prototype)}};bs=ms=o([x({type:w.Sequence,itemType:$t})],bs);var ws;let ka=ws=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,ws.prototype)}};ka=ws=o([x({type:w.Sequence,itemType:bs})],ka);class Xl{constructor(e={}){Object.assign(this,e)}}o([c({type:ce,implicit:!0,context:0,optional:!0})],Xl.prototype,"roleAuthority",void 0);o([c({type:U,implicit:!0,context:1})],Xl.prototype,"roleName",void 0);class ko{constructor(e={}){this.service=new U,this.ident=new U,Object.assign(this,e)}}o([c({type:U})],ko.prototype,"service",void 0);o([c({type:U})],ko.prototype,"ident",void 0);o([c({type:F,optional:!0})],ko.prototype,"authInfo",void 0);var As;class Co{constructor(e={}){this.otherCertFormat="",this.otherCert=new ArrayBuffer(0),Object.assign(this,e)}}o([c({type:h.ObjectIdentifier})],Co.prototype,"otherCertFormat",void 0);o([c({type:h.Any})],Co.prototype,"otherCert",void 0);let Ht=class{constructor(e={}){Object.assign(this,e)}};o([c({type:Mt})],Ht.prototype,"certificate",void 0);o([c({type:Xi,context:2,implicit:!0})],Ht.prototype,"v2AttrCert",void 0);o([c({type:Co,context:3,implicit:!0})],Ht.prototype,"other",void 0);Ht=o([x({type:w.Choice})],Ht);let ci=As=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,As.prototype)}};ci=As=o([x({type:w.Set,itemType:Ht})],ci);class Zt{constructor(e={}){this.contentType="",this.content=new ArrayBuffer(0),Object.assign(this,e)}}o([c({type:h.ObjectIdentifier})],Zt.prototype,"contentType",void 0);o([c({type:h.Any,context:0})],Zt.prototype,"content",void 0);let pr=class{constructor(e={}){Object.assign(this,e)}};o([c({type:F})],pr.prototype,"single",void 0);o([c({type:h.Any})],pr.prototype,"any",void 0);pr=o([x({type:w.Choice})],pr);class rn{constructor(e={}){this.eContentType="",Object.assign(this,e)}}o([c({type:h.ObjectIdentifier})],rn.prototype,"eContentType",void 0);o([c({type:pr,context:0,optional:!0})],rn.prototype,"eContent",void 0);let dr=class{constructor(e={}){Object.assign(this,e)}};o([c({type:F,context:0,implicit:!0,optional:!0})],dr.prototype,"value",void 0);o([c({type:F,converter:Tf,context:0,implicit:!0,optional:!0,repeated:"sequence"})],dr.prototype,"constructedValue",void 0);dr=o([x({type:w.Choice})],dr);class Cr{constructor(e={}){this.contentType="",this.contentEncryptionAlgorithm=new ni,Object.assign(this,e)}}o([c({type:h.ObjectIdentifier})],Cr.prototype,"contentType",void 0);o([c({type:ni})],Cr.prototype,"contentEncryptionAlgorithm",void 0);o([c({type:dr,optional:!0})],Cr.prototype,"encryptedContent",void 0);class nn{constructor(e={}){this.keyAttrId="",Object.assign(this,e)}}o([c({type:h.ObjectIdentifier})],nn.prototype,"keyAttrId",void 0);o([c({type:h.Any,optional:!0})],nn.prototype,"keyAttr",void 0);var Ss;class sn{constructor(e={}){this.subjectKeyIdentifier=new tt,Object.assign(this,e)}}o([c({type:tt})],sn.prototype,"subjectKeyIdentifier",void 0);o([c({type:h.GeneralizedTime,optional:!0})],sn.prototype,"date",void 0);o([c({type:nn,optional:!0})],sn.prototype,"other",void 0);let Lt=class{constructor(e={}){Object.assign(this,e)}};o([c({type:sn,context:0,implicit:!0,optional:!0})],Lt.prototype,"rKeyId",void 0);o([c({type:Yt,optional:!0})],Lt.prototype,"issuerAndSerialNumber",void 0);Lt=o([x({type:w.Choice})],Lt);class Eo{constructor(e={}){this.rid=new Lt,this.encryptedKey=new F,Object.assign(this,e)}}o([c({type:Lt})],Eo.prototype,"rid",void 0);o([c({type:F})],Eo.prototype,"encryptedKey",void 0);let li=Ss=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,Ss.prototype)}};li=Ss=o([x({type:w.Sequence,itemType:Eo})],li);class No{constructor(e={}){this.algorithm=new j,this.publicKey=new ArrayBuffer(0),Object.assign(this,e)}}o([c({type:j})],No.prototype,"algorithm",void 0);o([c({type:h.BitString})],No.prototype,"publicKey",void 0);let mt=class{constructor(e={}){Object.assign(this,e)}};o([c({type:tt,context:0,implicit:!0,optional:!0})],mt.prototype,"subjectKeyIdentifier",void 0);o([c({type:No,context:1,implicit:!0,optional:!0})],mt.prototype,"originatorKey",void 0);o([c({type:Yt,optional:!0})],mt.prototype,"issuerAndSerialNumber",void 0);mt=o([x({type:w.Choice})],mt);class Xt{constructor(e={}){this.version=We.v3,this.originator=new mt,this.keyEncryptionAlgorithm=new Me,this.recipientEncryptedKeys=new li,Object.assign(this,e)}}o([c({type:h.Integer})],Xt.prototype,"version",void 0);o([c({type:mt,context:0})],Xt.prototype,"originator",void 0);o([c({type:F,context:1,optional:!0})],Xt.prototype,"ukm",void 0);o([c({type:Me})],Xt.prototype,"keyEncryptionAlgorithm",void 0);o([c({type:li})],Xt.prototype,"recipientEncryptedKeys",void 0);let Ft=class{constructor(e={}){Object.assign(this,e)}};o([c({type:tt,context:0,implicit:!0})],Ft.prototype,"subjectKeyIdentifier",void 0);o([c({type:Yt})],Ft.prototype,"issuerAndSerialNumber",void 0);Ft=o([x({type:w.Choice})],Ft);class Er{constructor(e={}){this.version=We.v0,this.rid=new Ft,this.keyEncryptionAlgorithm=new Me,this.encryptedKey=new F,Object.assign(this,e)}}o([c({type:h.Integer})],Er.prototype,"version",void 0);o([c({type:Ft})],Er.prototype,"rid",void 0);o([c({type:Me})],Er.prototype,"keyEncryptionAlgorithm",void 0);o([c({type:F})],Er.prototype,"encryptedKey",void 0);class Nr{constructor(e={}){this.keyIdentifier=new F,Object.assign(this,e)}}o([c({type:F})],Nr.prototype,"keyIdentifier",void 0);o([c({type:h.GeneralizedTime,optional:!0})],Nr.prototype,"date",void 0);o([c({type:nn,optional:!0})],Nr.prototype,"other",void 0);class Or{constructor(e={}){this.version=We.v4,this.kekid=new Nr,this.keyEncryptionAlgorithm=new Me,this.encryptedKey=new F,Object.assign(this,e)}}o([c({type:h.Integer})],Or.prototype,"version",void 0);o([c({type:Nr})],Or.prototype,"kekid",void 0);o([c({type:Me})],Or.prototype,"keyEncryptionAlgorithm",void 0);o([c({type:F})],Or.prototype,"encryptedKey",void 0);class jr{constructor(e={}){this.version=We.v0,this.keyEncryptionAlgorithm=new Me,this.encryptedKey=new F,Object.assign(this,e)}}o([c({type:h.Integer})],jr.prototype,"version",void 0);o([c({type:hs,context:0,optional:!0})],jr.prototype,"keyDerivationAlgorithm",void 0);o([c({type:Me})],jr.prototype,"keyEncryptionAlgorithm",void 0);o([c({type:F})],jr.prototype,"encryptedKey",void 0);class Oo{constructor(e={}){this.oriType="",this.oriValue=new ArrayBuffer(0),Object.assign(this,e)}}o([c({type:h.ObjectIdentifier})],Oo.prototype,"oriType",void 0);o([c({type:h.Any})],Oo.prototype,"oriValue",void 0);let it=class{constructor(e={}){Object.assign(this,e)}};o([c({type:Er,optional:!0})],it.prototype,"ktri",void 0);o([c({type:Xt,context:1,implicit:!0,optional:!0})],it.prototype,"kari",void 0);o([c({type:Or,context:2,implicit:!0,optional:!0})],it.prototype,"kekri",void 0);o([c({type:jr,context:3,implicit:!0,optional:!0})],it.prototype,"pwri",void 0);o([c({type:Oo,context:4,implicit:!0,optional:!0})],it.prototype,"ori",void 0);it=o([x({type:w.Choice})],it);var xs;let ui=xs=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,xs.prototype)}};ui=xs=o([x({type:w.Set,itemType:it})],ui);var Bs;class on{constructor(e={}){this.otherRevInfoFormat="",this.otherRevInfo=new ArrayBuffer(0),Object.assign(this,e)}}o([c({type:h.ObjectIdentifier})],on.prototype,"otherRevInfoFormat",void 0);o([c({type:h.Any})],on.prototype,"otherRevInfo",void 0);let fi=class{constructor(e={}){this.other=new on,Object.assign(this,e)}};o([c({type:on,context:1,implicit:!0})],fi.prototype,"other",void 0);fi=o([x({type:w.Choice})],fi);let hi=Bs=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,Bs.prototype)}};hi=Bs=o([x({type:w.Set,itemType:fi})],hi);class jo{constructor(e={}){Object.assign(this,e)}}o([c({type:ci,context:0,implicit:!0,optional:!0})],jo.prototype,"certs",void 0);o([c({type:hi,context:1,implicit:!0,optional:!0})],jo.prototype,"crls",void 0);var Is;let ks=Is=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,Is.prototype)}};ks=Is=o([x({type:w.Set,itemType:Qt})],ks);class Tr{constructor(e={}){this.version=We.v0,this.recipientInfos=new ui,this.encryptedContentInfo=new Cr,Object.assign(this,e)}}o([c({type:h.Integer})],Tr.prototype,"version",void 0);o([c({type:jo,context:0,implicit:!0,optional:!0})],Tr.prototype,"originatorInfo",void 0);o([c({type:ui})],Tr.prototype,"recipientInfos",void 0);o([c({type:Cr})],Tr.prototype,"encryptedContentInfo",void 0);o([c({type:ks,context:1,implicit:!0,optional:!0})],Tr.prototype,"unprotectedAttrs",void 0);const nh="1.2.840.113549.1.7.2";var Cs;let pi=Cs=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,Cs.prototype)}};pi=Cs=o([x({type:w.Set,itemType:hr})],pi);class er{constructor(e={}){this.version=We.v0,this.digestAlgorithms=new pi,this.encapContentInfo=new rn,this.signerInfos=new si,Object.assign(this,e)}}o([c({type:h.Integer})],er.prototype,"version",void 0);o([c({type:pi})],er.prototype,"digestAlgorithms",void 0);o([c({type:rn})],er.prototype,"encapContentInfo",void 0);o([c({type:ci,context:0,implicit:!0,optional:!0})],er.prototype,"certificates",void 0);o([c({type:hi,context:1,implicit:!0,optional:!0})],er.prototype,"crls",void 0);o([c({type:si})],er.prototype,"signerInfos",void 0);const yr="1.2.840.10045.2.1",To="1.2.840.10045.4.1",eu="1.2.840.10045.4.3.1",Po="1.2.840.10045.4.3.2",Vo="1.2.840.10045.4.3.3",Ro="1.2.840.10045.4.3.4",Ca="1.2.840.10045.3.1.7",Ea="1.3.132.0.34",Na="1.3.132.0.35";function Pr(r){return new j({algorithm:r})}const sh=Pr(To);Pr(eu);const oh=Pr(Po),ah=Pr(Vo),ch=Pr(Ro);let vr=class{constructor(e={}){Object.assign(this,e)}};o([c({type:h.ObjectIdentifier})],vr.prototype,"fieldType",void 0);o([c({type:h.Any})],vr.prototype,"parameters",void 0);vr=o([x({type:w.Sequence})],vr);class lh extends F{}let zt=class{constructor(e={}){Object.assign(this,e)}};o([c({type:h.OctetString})],zt.prototype,"a",void 0);o([c({type:h.OctetString})],zt.prototype,"b",void 0);o([c({type:h.BitString,optional:!0})],zt.prototype,"seed",void 0);zt=o([x({type:w.Sequence})],zt);var Es;(function(r){r[r.ecpVer1=1]="ecpVer1"})(Es||(Es={}));let qe=class{constructor(e={}){this.version=Es.ecpVer1,Object.assign(this,e)}};o([c({type:h.Integer})],qe.prototype,"version",void 0);o([c({type:vr})],qe.prototype,"fieldID",void 0);o([c({type:zt})],qe.prototype,"curve",void 0);o([c({type:lh})],qe.prototype,"base",void 0);o([c({type:h.Integer,converter:J})],qe.prototype,"order",void 0);o([c({type:h.Integer,optional:!0})],qe.prototype,"cofactor",void 0);qe=o([x({type:w.Sequence})],qe);let nt=class{constructor(e={}){Object.assign(this,e)}};o([c({type:h.ObjectIdentifier})],nt.prototype,"namedCurve",void 0);o([c({type:h.Null})],nt.prototype,"implicitCurve",void 0);o([c({type:qe})],nt.prototype,"specifiedCurve",void 0);nt=o([x({type:w.Choice})],nt);class an{constructor(e={}){this.version=1,this.privateKey=new F,Object.assign(this,e)}}o([c({type:h.Integer})],an.prototype,"version",void 0);o([c({type:F})],an.prototype,"privateKey",void 0);o([c({type:nt,context:0,optional:!0})],an.prototype,"parameters",void 0);o([c({type:h.BitString,context:1,optional:!0})],an.prototype,"publicKey",void 0);class di{constructor(e={}){this.r=new ArrayBuffer(0),this.s=new ArrayBuffer(0),Object.assign(this,e)}}o([c({type:h.Integer,converter:J})],di.prototype,"r",void 0);o([c({type:h.Integer,converter:J})],di.prototype,"s",void 0);const ye="1.2.840.113549.1.1",bt=`${ye}.1`,uh=`${ye}.7`,fh=`${ye}.9`,cr=`${ye}.10`,hh=`${ye}.2`,ph=`${ye}.4`,yi=`${ye}.5`,dh=`${ye}.14`,Ns=`${ye}.11`,vi=`${ye}.12`,gi=`${ye}.13`,tu=`${ye}.15`,ru=`${ye}.16`,mi="1.3.14.3.2.26",iu="2.16.840.1.101.3.4.2.4",bi="2.16.840.1.101.3.4.2.1",wi="2.16.840.1.101.3.4.2.2",Ai="2.16.840.1.101.3.4.2.3",yh="2.16.840.1.101.3.4.2.5",vh="2.16.840.1.101.3.4.2.6",gh="1.2.840.113549.2.2",mh="1.2.840.113549.2.5",cn=`${ye}.8`;function te(r){return new j({algorithm:r,parameters:null})}te(gh);te(mh);const wt=te(mi);te(iu);te(bi);te(wi);te(Ai);te(yh);te(vh);const nu=new j({algorithm:cn,parameters:E.serialize(wt)}),su=new j({algorithm:fh,parameters:E.serialize(Yr.toASN(new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer))});te(bt);te(hh);te(ph);te(yi);te(tu);te(ru);te(vi);te(gi);te(tu);te(ru);class ln{constructor(e={}){this.hashAlgorithm=new j(wt),this.maskGenAlgorithm=new j({algorithm:cn,parameters:E.serialize(wt)}),this.pSourceAlgorithm=new j(su),Object.assign(this,e)}}o([c({type:j,context:0,defaultValue:wt})],ln.prototype,"hashAlgorithm",void 0);o([c({type:j,context:1,defaultValue:nu})],ln.prototype,"maskGenAlgorithm",void 0);o([c({type:j,context:2,defaultValue:su})],ln.prototype,"pSourceAlgorithm",void 0);new j({algorithm:uh,parameters:E.serialize(new ln)});class At{constructor(e={}){this.hashAlgorithm=new j(wt),this.maskGenAlgorithm=new j({algorithm:cn,parameters:E.serialize(wt)}),this.saltLength=20,this.trailerField=1,Object.assign(this,e)}}o([c({type:j,context:0,defaultValue:wt})],At.prototype,"hashAlgorithm",void 0);o([c({type:j,context:1,defaultValue:nu})],At.prototype,"maskGenAlgorithm",void 0);o([c({type:h.Integer,context:2,defaultValue:20})],At.prototype,"saltLength",void 0);o([c({type:h.Integer,context:3,defaultValue:1})],At.prototype,"trailerField",void 0);new j({algorithm:cr,parameters:E.serialize(new At)});class un{constructor(e={}){this.digestAlgorithm=new j,this.digest=new F,Object.assign(this,e)}}o([c({type:j})],un.prototype,"digestAlgorithm",void 0);o([c({type:F})],un.prototype,"digest",void 0);var Os;class fn{constructor(e={}){this.prime=new ArrayBuffer(0),this.exponent=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}o([c({type:h.Integer,converter:J})],fn.prototype,"prime",void 0);o([c({type:h.Integer,converter:J})],fn.prototype,"exponent",void 0);o([c({type:h.Integer,converter:J})],fn.prototype,"coefficient",void 0);let js=Os=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,Os.prototype)}};js=Os=o([x({type:w.Sequence,itemType:fn})],js);class $e{constructor(e={}){this.version=0,this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),this.privateExponent=new ArrayBuffer(0),this.prime1=new ArrayBuffer(0),this.prime2=new ArrayBuffer(0),this.exponent1=new ArrayBuffer(0),this.exponent2=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}o([c({type:h.Integer})],$e.prototype,"version",void 0);o([c({type:h.Integer,converter:J})],$e.prototype,"modulus",void 0);o([c({type:h.Integer,converter:J})],$e.prototype,"publicExponent",void 0);o([c({type:h.Integer,converter:J})],$e.prototype,"privateExponent",void 0);o([c({type:h.Integer,converter:J})],$e.prototype,"prime1",void 0);o([c({type:h.Integer,converter:J})],$e.prototype,"prime2",void 0);o([c({type:h.Integer,converter:J})],$e.prototype,"exponent1",void 0);o([c({type:h.Integer,converter:J})],$e.prototype,"exponent2",void 0);o([c({type:h.Integer,converter:J})],$e.prototype,"coefficient",void 0);o([c({type:js,optional:!0})],$e.prototype,"otherPrimeInfos",void 0);class Do{constructor(e={}){this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),Object.assign(this,e)}}o([c({type:h.Integer,converter:J})],Do.prototype,"modulus",void 0);o([c({type:h.Integer,converter:J})],Do.prototype,"publicExponent",void 0);var Ts;(function(r){r[r.Transient=0]="Transient",r[r.Singleton=1]="Singleton",r[r.ResolutionScoped=2]="ResolutionScoped",r[r.ContainerScoped=3]="ContainerScoped"})(Ts||(Ts={}));const fe=Ts;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ps=function(r,e){return Ps=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},Ps(r,e)};function Mo(r,e){Ps(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function bh(r,e,t,i){function n(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function u(A){try{p(i.next(A))}catch(S){a(S)}}function l(A){try{p(i.throw(A))}catch(S){a(S)}}function p(A){A.done?s(A.value):n(A.value).then(u,l)}p((i=i.apply(r,[])).next())})}function wh(r,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(p){return function(A){return l([p,A])}}function l(p){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,n&&(s=p[0]&2?n.return:p[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,p[1])).done)return s;switch(n=0,s&&(p=[p[0]&2,s.value]),p[0]){case 0:case 1:s=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,n=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!s||p[1]>s[0]&&p[1]<s[3])){t.label=p[1];break}if(p[0]===6&&t.label<s[1]){t.label=s[1],s=p;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(p);break}s[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(r,t)}catch(A){p=[6,A],n=0}finally{i=s=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function $r(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Si(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var i=t.call(r),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(u){a={error:u}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(a)throw a.error}}return s}function ct(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(Si(arguments[e]));return r}var Ah="injectionTokens";function Sh(r){var e=Reflect.getMetadata("design:paramtypes",r)||[],t=Reflect.getOwnMetadata(Ah,r)||{};return Object.keys(t).forEach(function(i){e[+i]=t[i]}),e}function ou(r){return!!r.useClass}function Vs(r){return!!r.useFactory}var au=function(){function r(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return r.prototype.createProxy=function(e){var t=this,i={},n=!1,s,a=function(){return n||(s=e(t.wrap()),n=!0),s};return new Proxy(i,this.createHandler(a))},r.prototype.createHandler=function(e){var t={},i=function(n){t[n]=function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];s[0]=e();var u=Reflect[n];return u.apply(void 0,ct(s))}};return this.reflectMethods.forEach(i),t},r}();function Nt(r){return typeof r=="string"||typeof r=="symbol"}function xh(r){return typeof r=="object"&&"token"in r&&"multiple"in r}function Oa(r){return typeof r=="object"&&"token"in r&&"transform"in r}function Bh(r){return typeof r=="function"||r instanceof au}function zr(r){return!!r.useToken}function Gr(r){return r.useValue!=null}function Ih(r){return ou(r)||Gr(r)||zr(r)||Vs(r)}var _o=function(){function r(){this._registryMap=new Map}return r.prototype.entries=function(){return this._registryMap.entries()},r.prototype.getAll=function(e){return this.ensure(e),this._registryMap.get(e)},r.prototype.get=function(e){this.ensure(e);var t=this._registryMap.get(e);return t[t.length-1]||null},r.prototype.set=function(e,t){this.ensure(e),this._registryMap.get(e).push(t)},r.prototype.setAll=function(e,t){this._registryMap.set(e,t)},r.prototype.has=function(e){return this.ensure(e),this._registryMap.get(e).length>0},r.prototype.clear=function(){this._registryMap.clear()},r.prototype.ensure=function(e){this._registryMap.has(e)||this._registryMap.set(e,[])},r}(),kh=function(r){Mo(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e}(_o),ja=function(){function r(){this.scopedResolutions=new Map}return r}();function Ch(r,e){if(r===null)return"at position #"+e;var t=r.split(",")[e].trim();return'"'+t+'" at position #'+e}function Eh(r,e,t){return t===void 0&&(t="    "),ct([r],e.message.split(`
`).map(function(i){return t+i})).join(`
`)}function Nh(r,e,t){var i=Si(r.toString().match(/constructor\(([\w, ]+)\)/)||[],2),n=i[1],s=n===void 0?null:n,a=Ch(s,e);return Eh("Cannot inject the dependency "+a+' of "'+r.name+'" constructor. Reason:',t)}function Oh(r){if(typeof r.dispose!="function")return!1;var e=r.dispose;return!(e.length>0)}var jh=function(r){Mo(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e}(_o),Th=function(r){Mo(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e}(_o),Ph=function(){function r(){this.preResolution=new jh,this.postResolution=new Th}return r}(),cu=new Map,Vh=function(){function r(e){this.parent=e,this._registry=new kh,this.interceptors=new Ph,this.disposed=!1,this.disposables=new Set}return r.prototype.register=function(e,t,i){i===void 0&&(i={lifecycle:fe.Transient}),this.ensureNotDisposed();var n;if(Ih(t)?n=t:n={useClass:t},zr(n))for(var s=[e],a=n;a!=null;){var u=a.useToken;if(s.includes(u))throw new Error("Token registration cycle detected! "+ct(s,[u]).join(" -> "));s.push(u);var l=this._registry.get(u);l&&zr(l.provider)?a=l.provider:a=null}if((i.lifecycle===fe.Singleton||i.lifecycle==fe.ContainerScoped||i.lifecycle==fe.ResolutionScoped)&&(Gr(n)||Vs(n)))throw new Error('Cannot use lifecycle "'+fe[i.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(e,{provider:n,options:i}),this},r.prototype.registerType=function(e,t){return this.ensureNotDisposed(),Nt(t)?this.register(e,{useToken:t}):this.register(e,{useClass:t})},r.prototype.registerInstance=function(e,t){return this.ensureNotDisposed(),this.register(e,{useValue:t})},r.prototype.registerSingleton=function(e,t){if(this.ensureNotDisposed(),Nt(e)){if(Nt(t))return this.register(e,{useToken:t},{lifecycle:fe.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:fe.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}var i=e;return t&&!Nt(t)&&(i=t),this.register(e,{useClass:i},{lifecycle:fe.Singleton})},r.prototype.resolve=function(e,t){t===void 0&&(t=new ja),this.ensureNotDisposed();var i=this.getRegistration(e);if(!i&&Nt(e))throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"Single"),i){var n=this.resolveRegistration(i,t);return this.executePostResolutionInterceptor(e,n,"Single"),n}if(Bh(e)){var n=this.construct(e,t);return this.executePostResolutionInterceptor(e,n,"Single"),n}throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},r.prototype.executePreResolutionInterceptor=function(e,t){var i,n;if(this.interceptors.preResolution.has(e)){var s=[];try{for(var a=$r(this.interceptors.preResolution.getAll(e)),u=a.next();!u.done;u=a.next()){var l=u.value;l.options.frequency!="Once"&&s.push(l),l.callback(e,t)}}catch(p){i={error:p}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}this.interceptors.preResolution.setAll(e,s)}},r.prototype.executePostResolutionInterceptor=function(e,t,i){var n,s;if(this.interceptors.postResolution.has(e)){var a=[];try{for(var u=$r(this.interceptors.postResolution.getAll(e)),l=u.next();!l.done;l=u.next()){var p=l.value;p.options.frequency!="Once"&&a.push(p),p.callback(e,t,i)}}catch(A){n={error:A}}finally{try{l&&!l.done&&(s=u.return)&&s.call(u)}finally{if(n)throw n.error}}this.interceptors.postResolution.setAll(e,a)}},r.prototype.resolveRegistration=function(e,t){if(this.ensureNotDisposed(),e.options.lifecycle===fe.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);var i=e.options.lifecycle===fe.Singleton,n=e.options.lifecycle===fe.ContainerScoped,s=i||n,a;return Gr(e.provider)?a=e.provider.useValue:zr(e.provider)?a=s?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):ou(e.provider)?a=s?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):Vs(e.provider)?a=e.provider.useFactory(this):a=this.construct(e.provider,t),e.options.lifecycle===fe.ResolutionScoped&&t.scopedResolutions.set(e,a),a},r.prototype.resolveAll=function(e,t){var i=this;t===void 0&&(t=new ja),this.ensureNotDisposed();var n=this.getAllRegistrations(e);if(!n&&Nt(e))throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"All"),n){var s=n.map(function(u){return i.resolveRegistration(u,t)});return this.executePostResolutionInterceptor(e,s,"All"),s}var a=[this.construct(e,t)];return this.executePostResolutionInterceptor(e,a,"All"),a},r.prototype.isRegistered=function(e,t){return t===void 0&&(t=!1),this.ensureNotDisposed(),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)},r.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},r.prototype.clearInstances=function(){var e,t;this.ensureNotDisposed();try{for(var i=$r(this._registry.entries()),n=i.next();!n.done;n=i.next()){var s=Si(n.value,2),a=s[0],u=s[1];this._registry.setAll(a,u.filter(function(l){return!Gr(l.provider)}).map(function(l){return l.instance=void 0,l}))}}catch(l){e={error:l}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},r.prototype.createChildContainer=function(){var e,t;this.ensureNotDisposed();var i=new r(this);try{for(var n=$r(this._registry.entries()),s=n.next();!s.done;s=n.next()){var a=Si(s.value,2),u=a[0],l=a[1];l.some(function(p){var A=p.options;return A.lifecycle===fe.ContainerScoped})&&i._registry.setAll(u,l.map(function(p){return p.options.lifecycle===fe.ContainerScoped?{provider:p.provider,options:p.options}:p}))}}catch(p){e={error:p}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return i},r.prototype.beforeResolution=function(e,t,i){i===void 0&&(i={frequency:"Always"}),this.interceptors.preResolution.set(e,{callback:t,options:i})},r.prototype.afterResolution=function(e,t,i){i===void 0&&(i={frequency:"Always"}),this.interceptors.postResolution.set(e,{callback:t,options:i})},r.prototype.dispose=function(){return bh(this,void 0,void 0,function(){var e;return wh(this,function(t){switch(t.label){case 0:return this.disposed=!0,e=[],this.disposables.forEach(function(i){var n=i.dispose();n&&e.push(n)}),[4,Promise.all(e)];case 1:return t.sent(),[2]}})})},r.prototype.getRegistration=function(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null},r.prototype.getAllRegistrations=function(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null},r.prototype.construct=function(e,t){var i=this;if(e instanceof au)return e.createProxy(function(s){return i.resolve(s,t)});var n=function(){var s=cu.get(e);if(!s||s.length===0){if(e.length===0)return new e;throw new Error('TypeInfo not known for "'+e.name+'"')}var a=s.map(i.resolveParams(t,e));return new(e.bind.apply(e,ct([void 0],a)))}();return Oh(n)&&this.disposables.add(n),n},r.prototype.resolveParams=function(e,t){var i=this;return function(n,s){var a,u,l;try{return xh(n)?Oa(n)?n.multiple?(a=i.resolve(n.transform)).transform.apply(a,ct([i.resolveAll(n.token)],n.transformArgs)):(u=i.resolve(n.transform)).transform.apply(u,ct([i.resolve(n.token,e)],n.transformArgs)):n.multiple?i.resolveAll(n.token):i.resolve(n.token,e):Oa(n)?(l=i.resolve(n.transform,e)).transform.apply(l,ct([i.resolve(n.token,e)],n.transformArgs)):i.resolve(n,e)}catch(p){throw new Error(Nh(t,s,p))}}},r.prototype.ensureNotDisposed=function(){if(this.disposed)throw new Error("This container has been disposed, you cannot interact with a disposed container")},r}(),le=new Vh;function hn(){return function(r){cu.set(r,Sh(r))}}if(typeof Reflect>"u"||!Reflect.getMetadata)throw new Error(`tsyringe requires a reflect polyfill. Please add 'import "reflect-metadata"' to the top of your entry point.`);var Rs;class pn{constructor(e={}){this.attrId="",this.attrValues=[],Object.assign(e)}}o([c({type:h.ObjectIdentifier})],pn.prototype,"attrId",void 0);o([c({type:h.Any,repeated:"set"})],pn.prototype,"attrValues",void 0);let Ta=Rs=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,Rs.prototype)}};Ta=Rs=o([x({type:w.Sequence,itemType:pn})],Ta);var Ds;let Pa=Ds=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,Ds.prototype)}};Pa=Ds=o([x({type:w.Sequence,itemType:Zt})],Pa);class lu{constructor(e={}){this.certId="",this.certValue=new ArrayBuffer(0),Object.assign(this,e)}}o([c({type:h.ObjectIdentifier})],lu.prototype,"certId",void 0);o([c({type:h.Any,context:0})],lu.prototype,"certValue",void 0);class uu{constructor(e={}){this.crlId="",this.crltValue=new ArrayBuffer(0),Object.assign(this,e)}}o([c({type:h.ObjectIdentifier})],uu.prototype,"crlId",void 0);o([c({type:h.Any,context:0})],uu.prototype,"crltValue",void 0);class fu extends F{}let dn=class{constructor(e={}){this.encryptionAlgorithm=new j,this.encryptedData=new fu,Object.assign(this,e)}};o([c({type:j})],dn.prototype,"encryptionAlgorithm",void 0);o([c({type:fu})],dn.prototype,"encryptedData",void 0);var Ms,_s;(function(r){r[r.v1=0]="v1"})(_s||(_s={}));class hu extends F{}let Us=Ms=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,Ms.prototype)}};Us=Ms=o([x({type:w.Sequence,itemType:Ge})],Us);class Vr{constructor(e={}){this.version=_s.v1,this.privateKeyAlgorithm=new j,this.privateKey=new hu,Object.assign(this,e)}}o([c({type:h.Integer})],Vr.prototype,"version",void 0);o([c({type:j})],Vr.prototype,"privateKeyAlgorithm",void 0);o([c({type:hu})],Vr.prototype,"privateKey",void 0);o([c({type:Us,implicit:!0,context:0,optional:!0})],Vr.prototype,"attributes",void 0);let Va=class extends Vr{};Va=o([x({type:w.Sequence})],Va);let Ra=class extends dn{};Ra=o([x({type:w.Sequence})],Ra);class pu{constructor(e={}){this.secretTypeId="",this.secretValue=new ArrayBuffer(0),Object.assign(this,e)}}o([c({type:h.ObjectIdentifier})],pu.prototype,"secretTypeId",void 0);o([c({type:h.Any,context:0})],pu.prototype,"secretValue",void 0);class Rr{constructor(e={}){this.mac=new un,this.macSalt=new F,this.iterations=1,Object.assign(this,e)}}o([c({type:un})],Rr.prototype,"mac",void 0);o([c({type:F})],Rr.prototype,"macSalt",void 0);o([c({type:h.Integer,defaultValue:1})],Rr.prototype,"iterations",void 0);class yn{constructor(e={}){this.version=3,this.authSafe=new Zt,this.macData=new Rr,Object.assign(this,e)}}o([c({type:h.Integer})],yn.prototype,"version",void 0);o([c({type:Zt})],yn.prototype,"authSafe",void 0);o([c({type:Rr,optional:!0})],yn.prototype,"macData",void 0);var $s;class vn{constructor(e={}){this.bagId="",this.bagValue=new ArrayBuffer(0),Object.assign(this,e)}}o([c({type:h.ObjectIdentifier})],vn.prototype,"bagId",void 0);o([c({type:h.Any,context:0})],vn.prototype,"bagValue",void 0);o([c({type:pn,repeated:"set",optional:!0})],vn.prototype,"bagAttributes",void 0);let Da=$s=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,$s.prototype)}};Da=$s=o([x({type:w.Sequence,itemType:vn})],Da);var Hs,Ls,Fs;const du="1.2.840.113549.1.9",yu=`${du}.7`,Uo=`${du}.14`;let xi=class extends se{constructor(e={}){super(e)}toString(){return this.ia5String||super.toString()}};o([c({type:h.IA5String})],xi.prototype,"ia5String",void 0);xi=o([x({type:w.Choice})],xi);let Ma=class extends Zt{};Ma=o([x({type:w.Sequence})],Ma);let _a=class extends yn{};_a=o([x({type:w.Sequence})],_a);let Ua=class extends dn{};Ua=o([x({type:w.Sequence})],Ua);let zs=class{constructor(e=""){this.value=e}toString(){return this.value}};o([c({type:h.IA5String})],zs.prototype,"value",void 0);zs=o([x({type:w.Choice})],zs);let $a=class extends xi{};$a=o([x({type:w.Choice})],$a);let Ha=class extends se{};Ha=o([x({type:w.Choice})],Ha);let Gs=class{constructor(e=new Date){this.value=e}};o([c({type:h.GeneralizedTime})],Gs.prototype,"value",void 0);Gs=o([x({type:w.Choice})],Gs);let La=class extends se{};La=o([x({type:w.Choice})],La);let Ws=class{constructor(e="M"){this.value=e}toString(){return this.value}};o([c({type:h.PrintableString})],Ws.prototype,"value",void 0);Ws=o([x({type:w.Choice})],Ws);let Bi=class{constructor(e=""){this.value=e}toString(){return this.value}};o([c({type:h.PrintableString})],Bi.prototype,"value",void 0);Bi=o([x({type:w.Choice})],Bi);let Fa=class extends Bi{};Fa=o([x({type:w.Choice})],Fa);let za=class extends se{};za=o([x({type:w.Choice})],za);let qs=class{constructor(e=""){this.value=e}toString(){return this.value}};o([c({type:h.ObjectIdentifier})],qs.prototype,"value",void 0);qs=o([x({type:w.Choice})],qs);let Ga=class extends ie{};Ga=o([x({type:w.Choice})],Ga);let Ks=class{constructor(e=0){this.value=e}toString(){return this.value.toString()}};o([c({type:h.Integer})],Ks.prototype,"value",void 0);Ks=o([x({type:w.Choice})],Ks);let Wa=class extends Ue{};Wa=o([x({type:w.Sequence})],Wa);let Ii=class extends se{};Ii=o([x({type:w.Choice})],Ii);let qa=Hs=class extends gt{constructor(e){super(e),Object.setPrototypeOf(this,Hs.prototype)}};qa=Hs=o([x({type:w.Sequence})],qa);let Ka=Ls=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,Ls.prototype)}};Ka=Ls=o([x({type:w.Set,itemType:Qt})],Ka);let Js=class{constructor(e=""){this.value=e}toString(){return this.value}};o([c({type:h.BmpString})],Js.prototype,"value",void 0);Js=o([x({type:w.Choice})],Js);let Ys=class extends j{};Ys=o([x({type:w.Sequence})],Ys);let Ja=Fs=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,Fs.prototype)}};Ja=Fs=o([x({type:w.Sequence,itemType:Ys})],Ja);var Qs;let ki=Qs=class extends W{constructor(e){super(e),Object.setPrototypeOf(this,Qs.prototype)}};ki=Qs=o([x({type:w.Sequence,itemType:Ge})],ki);class tr{constructor(e={}){this.version=0,this.subject=new ee,this.subjectPKInfo=new Ve,this.attributes=new ki,Object.assign(this,e)}}o([c({type:h.Integer})],tr.prototype,"version",void 0);o([c({type:ee})],tr.prototype,"subject",void 0);o([c({type:Ve})],tr.prototype,"subjectPKInfo",void 0);o([c({type:ki,implicit:!0,context:0})],tr.prototype,"attributes",void 0);class gr{constructor(e={}){this.certificationRequestInfo=new tr,this.signatureAlgorithm=new j,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}o([c({type:tr})],gr.prototype,"certificationRequestInfo",void 0);o([c({type:j})],gr.prototype,"signatureAlgorithm",void 0);o([c({type:h.BitString})],gr.prototype,"signature",void 0);/*!
 * MIT License
 * 
 * Copyright (c) Peculiar Ventures. All rights reserved.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */const Dr="crypto.algorithm";class Rh{getAlgorithms(){return le.resolveAll(Dr)}toAsnAlgorithm(e){({...e});for(const t of this.getAlgorithms()){const i=t.toAsnAlgorithm(e);if(i)return i}if(/^[0-9.]+$/.test(e.name)){const t=new j({algorithm:e.name});if("parameters"in e){const i=e;t.parameters=i.parameters}return t}throw new Error("Cannot convert WebCrypto algorithm to ASN.1 algorithm")}toWebAlgorithm(e){for(const i of this.getAlgorithms()){const n=i.toWebAlgorithm(e);if(n)return n}return{name:e.algorithm,parameters:e.parameters}}}const Gt="crypto.algorithmProvider";le.registerSingleton(Gt,Rh);var Wr;const ve="1.3.36.3.3.2.8.1.1",Ya=`${ve}.1`,Qa=`${ve}.2`,Za=`${ve}.3`,Xa=`${ve}.4`,ec=`${ve}.5`,tc=`${ve}.6`,rc=`${ve}.7`,ic=`${ve}.8`,nc=`${ve}.9`,sc=`${ve}.10`,oc=`${ve}.11`,ac=`${ve}.12`,cc=`${ve}.13`,lc=`${ve}.14`,uc="brainpoolP160r1",fc="brainpoolP160t1",hc="brainpoolP192r1",pc="brainpoolP192t1",dc="brainpoolP224r1",yc="brainpoolP224t1",vc="brainpoolP256r1",gc="brainpoolP256t1",mc="brainpoolP320r1",bc="brainpoolP320t1",wc="brainpoolP384r1",Ac="brainpoolP384t1",Sc="brainpoolP512r1",xc="brainpoolP512t1",Y="ECDSA";let mr=Wr=class{toAsnAlgorithm(e){switch(e.name.toLowerCase()){case Y.toLowerCase():if("hash"in e)switch((typeof e.hash=="string"?e.hash:e.hash.name).toLowerCase()){case"sha-1":return sh;case"sha-256":return oh;case"sha-384":return ah;case"sha-512":return ch}else if("namedCurve"in e){let t="";switch(e.namedCurve){case"P-256":t=Ca;break;case"K-256":t=Wr.SECP256K1;break;case"P-384":t=Ea;break;case"P-521":t=Na;break;case uc:t=Ya;break;case fc:t=Qa;break;case hc:t=Za;break;case pc:t=Xa;break;case dc:t=ec;break;case yc:t=tc;break;case vc:t=rc;break;case gc:t=ic;break;case mc:t=nc;break;case bc:t=sc;break;case wc:t=oc;break;case Ac:t=ac;break;case Sc:t=cc;break;case xc:t=lc;break}if(t)return new j({algorithm:yr,parameters:E.serialize(new nt({namedCurve:t}))})}}return null}toWebAlgorithm(e){switch(e.algorithm){case To:return{name:Y,hash:{name:"SHA-1"}};case Po:return{name:Y,hash:{name:"SHA-256"}};case Vo:return{name:Y,hash:{name:"SHA-384"}};case Ro:return{name:Y,hash:{name:"SHA-512"}};case yr:{if(!e.parameters)throw new TypeError("Cannot get required parameters from EC algorithm");switch(E.parse(e.parameters,nt).namedCurve){case Ca:return{name:Y,namedCurve:"P-256"};case Wr.SECP256K1:return{name:Y,namedCurve:"K-256"};case Ea:return{name:Y,namedCurve:"P-384"};case Na:return{name:Y,namedCurve:"P-521"};case Ya:return{name:Y,namedCurve:uc};case Qa:return{name:Y,namedCurve:fc};case Za:return{name:Y,namedCurve:hc};case Xa:return{name:Y,namedCurve:pc};case ec:return{name:Y,namedCurve:dc};case tc:return{name:Y,namedCurve:yc};case rc:return{name:Y,namedCurve:vc};case ic:return{name:Y,namedCurve:gc};case nc:return{name:Y,namedCurve:mc};case sc:return{name:Y,namedCurve:bc};case oc:return{name:Y,namedCurve:wc};case ac:return{name:Y,namedCurve:Ac};case cc:return{name:Y,namedCurve:Sc};case lc:return{name:Y,namedCurve:xc}}}}return null}};mr.SECP256K1="1.3.132.0.10";mr=Wr=o([hn()],mr);le.registerSingleton(Dr,mr);const vu=Symbol("name"),gu=Symbol("value");class G{constructor(e,t={},i=""){this[vu]=e,this[gu]=i;for(const n in t)this[n]=t[n]}}G.NAME=vu;G.VALUE=gu;class Dh{static toTextObject(e){const t=new G("Algorithm Identifier",{},ot.toString(e.algorithm));if(e.parameters)switch(e.algorithm){case yr:{const i=new mr().toWebAlgorithm(e);i&&"namedCurve"in i?t["Named Curve"]=i.namedCurve:t.Parameters=e.parameters;break}default:t.Parameters=e.parameters}return t}}class ot{static toString(e){const t=this.items[e];return t||e}}ot.items={[mi]:"sha1",[iu]:"sha224",[bi]:"sha256",[wi]:"sha384",[Ai]:"sha512",[bt]:"rsaEncryption",[yi]:"sha1WithRSAEncryption",[dh]:"sha224WithRSAEncryption",[Ns]:"sha256WithRSAEncryption",[vi]:"sha384WithRSAEncryption",[gi]:"sha512WithRSAEncryption",[yr]:"ecPublicKey",[To]:"ecdsaWithSHA1",[eu]:"ecdsaWithSHA224",[Po]:"ecdsaWithSHA256",[Vo]:"ecdsaWithSHA384",[Ro]:"ecdsaWithSHA512",[Zf]:"TLS WWW server authentication",[Xf]:"TLS WWW client authentication",[eh]:"Code Signing",[th]:"E-mail Protection",[rh]:"Time Stamping",[ih]:"OCSP Signing",[nh]:"Signed Data"};class St{static serialize(e){return this.serializeObj(e).join(`
`)}static pad(e=0){return"".padStart(2*e," ")}static serializeObj(e,t=0){const i=[];let n=this.pad(t++),s="";const a=e[G.VALUE];a&&(s=` ${a}`),i.push(`${n}${e[G.NAME]}:${s}`),n=this.pad(t);for(const u in e){if(typeof u=="symbol")continue;const l=e[u],p=u?`${u}: `:"";if(typeof l=="string"||typeof l=="number"||typeof l=="boolean")i.push(`${n}${p}${l}`);else if(l instanceof Date)i.push(`${n}${p}${l.toUTCString()}`);else if(Array.isArray(l))for(const A of l)A[G.NAME]=u,i.push(...this.serializeObj(A,t));else if(l instanceof G)l[G.NAME]=u,i.push(...this.serializeObj(l,t));else if(C.isBufferSource(l))u?(i.push(`${n}${p}`),i.push(...this.serializeBufferSource(l,t+1))):i.push(...this.serializeBufferSource(l,t));else if("toTextObject"in l){const A=l.toTextObject();A[G.NAME]=u,i.push(...this.serializeObj(A,t))}else throw new TypeError("Cannot serialize data in text format. Unsupported type.")}return i}static serializeBufferSource(e,t=0){const i=this.pad(t),n=C.toUint8Array(e),s=[];for(let a=0;a<n.length;){const u=[];for(let l=0;l<16&&a<n.length;l++){l===8&&u.push("");const p=n[a++].toString(16).padStart(2,"0");u.push(p)}s.push(`${i}${u.join(" ")}`)}return s}static serializeAlgorithm(e){return this.algorithmSerializer.toTextObject(e)}}St.oidSerializer=ot;St.algorithmSerializer=Dh;class at{constructor(...e){if(e.length===1){const t=e[0];this.rawData=E.serialize(t),this.onInit(t)}else{const t=E.parse(e[0],e[1]);this.rawData=C.toArrayBuffer(e[0]),this.onInit(t)}}equal(e){return e instanceof at?Dc(e.rawData,this.rawData):!1}toString(e="text"){switch(e){case"asn":return E.toString(this.rawData);case"text":return St.serialize(this.toTextObject());case"hex":return R.ToHex(this.rawData);case"base64":return R.ToBase64(this.rawData);case"base64url":return R.ToBase64Url(this.rawData);default:throw TypeError("Argument 'format' is unsupported value")}}getTextName(){return this.constructor.NAME}toTextObject(){const e=this.toTextObjectEmpty();return e[""]=this.rawData,e}toTextObjectEmpty(e){return new G(this.getTextName(),{},e)}}at.NAME="ASN";class Be extends at{constructor(...e){let t;C.isBufferSource(e[0])?t=C.toArrayBuffer(e[0]):t=E.serialize(new Ne({extnID:e[0],critical:e[1],extnValue:new F(C.toArrayBuffer(e[2]))})),super(t,Ne)}onInit(e){this.type=e.extnID,this.critical=e.critical,this.value=e.extnValue.buffer}toTextObject(){const e=this.toTextObjectWithoutValue();return e[""]=this.value,e}toTextObjectWithoutValue(){const e=this.toTextObjectEmpty(this.critical?"critical":void 0);return e[G.NAME]===Be.NAME&&(e[G.NAME]=ot.toString(this.type)),e}}var mu;class Ze{static isCryptoKeyPair(e){return e&&e.privateKey&&e.publicKey}static isCryptoKey(e){return e&&e.usages&&e.type&&e.algorithm&&e.extractable!==void 0}constructor(){this.items=new Map,this[mu]="CryptoProvider",typeof self<"u"&&typeof crypto<"u"?this.set(Ze.DEFAULT,crypto):typeof global<"u"&&global.crypto&&global.crypto.subtle&&this.set(Ze.DEFAULT,global.crypto)}clear(){this.items.clear()}delete(e){return this.items.delete(e)}forEach(e,t){return this.items.forEach(e,t)}has(e){return this.items.has(e)}get size(){return this.items.size}entries(){return this.items.entries()}keys(){return this.items.keys()}values(){return this.items.values()}[Symbol.iterator](){return this.items[Symbol.iterator]()}get(e=Ze.DEFAULT){const t=this.items.get(e.toLowerCase());if(!t)throw new Error(`Cannot get Crypto by name '${e}'`);return t}set(e,t){if(typeof e=="string"){if(!t)throw new TypeError("Argument 'value' is required");this.items.set(e.toLowerCase(),t)}else this.items.set(Ze.DEFAULT,e);return this}}mu=Symbol.toStringTag;Ze.DEFAULT="default";const ae=new Ze,Mh=/^[0-2](?:\.[1-9][0-9]*)+$/;function _h(r){return new RegExp(Mh).test(r)}class bu{constructor(e={}){this.items={};for(const t in e)this.register(t,e[t])}get(e){return this.items[e]||null}findId(e){return _h(e)?e:this.get(e)}register(e,t){this.items[e]=t,this.items[t]=e}}const de=new bu;de.register("CN","2.5.4.3");de.register("L","2.5.4.7");de.register("ST","2.5.4.8");de.register("O","2.5.4.10");de.register("OU","2.5.4.11");de.register("C","2.5.4.6");de.register("DC","0.9.2342.19200300.100.1.25");de.register("E","1.2.840.113549.1.9.1");de.register("G","2.5.4.42");de.register("I","2.5.4.43");de.register("SN","2.5.4.4");de.register("T","2.5.4.12");function Uh(r,e){return`\\${R.ToHex(R.FromUtf8String(e)).toUpperCase()}`}function $h(r){return r.replace(/([,+"\\<>;])/g,"\\$1").replace(/^([ #])/,"\\$1").replace(/([ ]$)/,"\\$1").replace(/([\r\n\t])/,Uh)}class rt{static isASCII(e){for(let t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return!1;return!0}static isPrintableString(e){return/^[A-Za-z0-9 '()+,-./:=?]*$/g.test(e)}constructor(e,t={}){this.extraNames=new bu,this.asn=new ee;for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i)){const n=t[i];this.extraNames.register(i,n)}typeof e=="string"?this.asn=this.fromString(e):e instanceof ee?this.asn=e:C.isBufferSource(e)?this.asn=E.parse(e,ee):this.asn=this.fromJSON(e)}getField(e){const t=this.extraNames.findId(e)||de.findId(e),i=[];for(const n of this.asn)for(const s of n)s.type===t&&i.push(s.value.toString());return i}getName(e){return this.extraNames.get(e)||de.get(e)}toString(){return this.asn.map(e=>e.map(t=>{const i=this.getName(t.type)||t.type,n=t.value.anyValue?`#${R.ToHex(t.value.anyValue)}`:$h(t.value.toString());return`${i}=${n}`}).join("+")).join(", ")}toJSON(){var e;const t=[];for(const i of this.asn){const n={};for(const s of i){const a=this.getName(s.type)||s.type;(e=n[a])!==null&&e!==void 0||(n[a]=[]),n[a].push(s.value.anyValue?`#${R.ToHex(s.value.anyValue)}`:s.value.toString())}t.push(n)}return t}fromString(e){const t=new ee,i=/(\d\.[\d.]*\d|[A-Za-z]+)=((?:"")|(?:".*?[^\\]")|(?:[^,+].*?(?:[^\\][,+]))|(?:))([,+])?/g;let n=null,s=",";for(;n=i.exec(`${e},`);){let[,a,u]=n;const l=u[u.length-1];(l===","||l==="+")&&(u=u.slice(0,u.length-1),n[3]=l);const p=n[3];a=this.getTypeOid(a);const A=this.createAttribute(a,u);s==="+"?t[t.length-1].push(A):t.push(new Rt([A])),s=p}return t}fromJSON(e){const t=new ee;for(const i of e){const n=new Rt;for(const s in i){const a=this.getTypeOid(s),u=i[s];for(const l of u){const p=this.createAttribute(a,l);n.push(p)}}t.push(n)}return t}getTypeOid(e){if(/[\d.]+/.test(e)||(e=this.getName(e)||""),!e)throw new Error(`Cannot get OID for name type '${e}'`);return e}createAttribute(e,t){const i=new zi({type:e});if(typeof t=="object")for(const n in t)switch(n){case"ia5String":i.value.ia5String=t[n];break;case"utf8String":i.value.utf8String=t[n];break;case"universalString":i.value.universalString=t[n];break;case"bmpString":i.value.bmpString=t[n];break;case"printableString":i.value.printableString=t[n];break}else if(t[0]==="#")i.value.anyValue=R.FromHex(t.slice(1));else{const n=this.processStringValue(t);e===this.getName("E")||e===this.getName("DC")?i.value.ia5String=n:rt.isPrintableString(n)?i.value.printableString=n:i.value.utf8String=n}return i}processStringValue(e){const t=/"(.*?[^\\])?"/.exec(e);return t&&(e=t[1]),e.replace(/\\0a/ig,`
`).replace(/\\0d/ig,"\r").replace(/\\0g/ig,"	").replace(/\\(.)/g,"$1")}toArrayBuffer(){return E.serialize(this.asn)}async getThumbprint(...e){var t;let i,n="SHA-1";return e.length>=1&&!(!((t=e[0])===null||t===void 0)&&t.subtle)?(n=e[0]||n,i=e[1]||ae.get()):i=e[0]||ae.get(),await i.subtle.digest(n,this.toArrayBuffer())}}const wu="Cannot initialize GeneralName from ASN.1 data.",Bc=`${wu} Unsupported string format in use.`,Hh=`${wu} Value doesn't match to GUID regular expression.`,Ic=/^([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})$/i,kc="1.3.6.1.4.1.311.25.1",Cc="1.3.6.1.4.1.311.20.2.3",En="dns",Nn="dn",On="email",jn="ip",Tn="url",Pn="guid",Vn="upn",Hr="id";class Xe extends at{constructor(...e){let t;if(e.length===2)switch(e[0]){case Nn:{const i=new rt(e[1]).toArrayBuffer(),n=E.parse(i,ee);t=new U({directoryName:n});break}case En:t=new U({dNSName:e[1]});break;case On:t=new U({rfc822Name:e[1]});break;case Pn:{const i=new RegExp(Ic,"i").exec(e[1]);if(!i)throw new Error("Cannot parse GUID value. Value doesn't match to regular expression");const n=i.slice(1).map((s,a)=>a<3?R.ToHex(new Uint8Array(R.FromHex(s)).reverse()):s).join("");t=new U({otherName:new fr({typeId:kc,value:E.serialize(new F(R.FromHex(n)))})});break}case jn:t=new U({iPAddress:e[1]});break;case Hr:t=new U({registeredID:e[1]});break;case Vn:{t=new U({otherName:new fr({typeId:Cc,value:E.serialize(Dl.toASN(e[1]))})});break}case Tn:t=new U({uniformResourceIdentifier:e[1]});break;default:throw new Error("Cannot create GeneralName. Unsupported type of the name")}else C.isBufferSource(e[0])?t=E.parse(e[0],U):t=e[0];super(t)}onInit(e){if(e.dNSName!=null)this.type=En,this.value=e.dNSName;else if(e.rfc822Name!=null)this.type=On,this.value=e.rfc822Name;else if(e.iPAddress!=null)this.type=jn,this.value=e.iPAddress;else if(e.uniformResourceIdentifier!=null)this.type=Tn,this.value=e.uniformResourceIdentifier;else if(e.registeredID!=null)this.type=Hr,this.value=e.registeredID;else if(e.directoryName!=null)this.type=Nn,this.value=new rt(e.directoryName).toString();else if(e.otherName!=null)if(e.otherName.typeId===kc){this.type=Pn;const t=E.parse(e.otherName.value,F),i=new RegExp(Ic,"i").exec(R.ToHex(t));if(!i)throw new Error(Hh);this.value=i.slice(1).map((n,s)=>s<3?R.ToHex(new Uint8Array(R.FromHex(n)).reverse()):n).join("-")}else if(e.otherName.typeId===Cc)this.type=Vn,this.value=E.parse(e.otherName.value,se).toString();else throw new Error(Bc);else throw new Error(Bc)}toJSON(){return{type:this.type,value:this.value}}toTextObject(){let e;switch(this.type){case Nn:case En:case Pn:case jn:case Hr:case Vn:case Tn:e=this.type.toUpperCase();break;case On:e="Email";break;default:throw new Error("Unsupported GeneralName type")}let t=this.value;return this.type===Hr&&(t=ot.toString(t)),new G(e,void 0,t)}}class br extends at{constructor(e){let t;if(e instanceof ce)t=e;else if(Array.isArray(e)){const i=[];for(const n of e)if(n instanceof U)i.push(n);else{const s=E.parse(new Xe(n.type,n.value).rawData,U);i.push(s)}t=new ce(i)}else if(C.isBufferSource(e))t=E.parse(e,ce);else throw new Error("Cannot initialize GeneralNames. Incorrect incoming arguments");super(t)}onInit(e){const t=[];for(const i of e){let n=null;try{n=new Xe(i)}catch{continue}t.push(n)}this.items=t}toJSON(){return this.items.map(e=>e.toJSON())}toTextObject(){const e=super.toTextObjectEmpty();for(const t of this.items){const i=t.toTextObject();let n=e[i[G.NAME]];Array.isArray(n)||(n=[],e[i[G.NAME]]=n),n.push(i)}return e}}br.NAME="GeneralNames";const lr="-{5}",wr="\\n",Lh=`[^${wr}]+`,Fh=`${lr}BEGIN (${Lh}(?=${lr}))${lr}`,zh=`${lr}END \\1${lr}`,Wt="\\n",Gh=`[^:${wr}]+`,Wh=`(?:[^${wr}]+${Wt}(?: +[^${wr}]+${Wt})*)`,qh="[a-zA-Z0-9=+/]+",Kh=`(?:${qh}${Wt})+`,Ec=`${Fh}${Wt}(?:((?:${Gh}: ${Wh})+))?${Wt}?(${Kh})${zh}`;class me{static isPem(e){return typeof e=="string"&&new RegExp(Ec,"g").test(e)}static decodeWithHeaders(e){e=e.replace(/\r/g,"");const t=new RegExp(Ec,"g"),i=[];let n=null;for(;n=t.exec(e);){const s=n[3].replace(new RegExp(`[${wr}]+`,"g"),""),a={type:n[1],headers:[],rawData:R.FromBase64(s)},u=n[2];if(u){const l=u.split(new RegExp(Wt,"g"));let p=null;for(const A of l){const[S,z]=A.split(/:(.*)/);if(z===void 0){if(!p)throw new Error("Cannot parse PEM string. Incorrect header value");p.value+=S.trim()}else p&&a.headers.push(p),p={key:S,value:z.trim()}}p&&a.headers.push(p)}i.push(a)}return i}static decode(e){return this.decodeWithHeaders(e).map(i=>i.rawData)}static decodeFirst(e){const t=this.decode(e);if(!t.length)throw new RangeError("PEM string doesn't contain any objects");return t[0]}static encode(e,t){if(Array.isArray(e)){const i=new Array;return t?e.forEach(n=>{if(!C.isBufferSource(n))throw new TypeError("Cannot encode array of BufferSource in PEM format. Not all items of the array are BufferSource");i.push(this.encodeStruct({type:t,rawData:C.toArrayBuffer(n)}))}):e.forEach(n=>{if(!("type"in n))throw new TypeError("Cannot encode array of PemStruct in PEM format. Not all items of the array are PemStrut");i.push(this.encodeStruct(n))}),i.join(`
`)}else{if(!t)throw new Error("Required argument 'tag' is missed");return this.encodeStruct({type:t,rawData:C.toArrayBuffer(e)})}}static encodeStruct(e){var t;const i=e.type.toLocaleUpperCase(),n=[];if(n.push(`-----BEGIN ${i}-----`),!((t=e.headers)===null||t===void 0)&&t.length){for(const p of e.headers)n.push(`${p.key}: ${p.value}`);n.push("")}const s=R.ToBase64(e.rawData);let a,u=0;const l=Array();for(;u<s.length&&(s.length-u<64?a=s.substring(u):(a=s.substring(u,u+64),u+=64),a.length!==0);)if(l.push(a),a.length<64)break;return n.push(...l),n.push(`-----END ${i}-----`),n.join(`
`)}}me.CertificateTag="CERTIFICATE";me.CrlTag="CRL";me.CertificateRequestTag="CERTIFICATE REQUEST";me.PublicKeyTag="PUBLIC KEY";me.PrivateKeyTag="PRIVATE KEY";class Ke extends at{static isAsnEncoded(e){return C.isBufferSource(e)||typeof e=="string"}static toArrayBuffer(e){if(typeof e=="string"){if(me.isPem(e))return me.decode(e)[0];if(R.isHex(e))return R.FromHex(e);if(R.isBase64(e))return R.FromBase64(e);if(R.isBase64Url(e))return R.FromBase64Url(e);throw new TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url")}else{const t=R.ToBinary(e);return me.isPem(t)?me.decode(t)[0]:R.isHex(t)?R.FromHex(t):R.isBase64(t)?R.FromBase64(t):R.isBase64Url(t)?R.FromBase64Url(t):C.toArrayBuffer(e)}}constructor(...e){Ke.isAsnEncoded(e[0])?super(Ke.toArrayBuffer(e[0]),e[1]):super(e[0])}toString(e="pem"){switch(e){case"pem":return me.encode(this.rawData,this.tag);default:return super.toString(e)}}}class De extends Ke{static async create(e,t=ae.get()){if(e instanceof De)return e;if(Ze.isCryptoKey(e)){if(e.type!=="public")throw new TypeError("Public key is required");const i=await t.subtle.exportKey("spki",e);return new De(i)}else{if(e.publicKey)return e.publicKey;if(C.isBufferSource(e))return new De(e);throw new TypeError("Unsupported PublicKeyType")}}constructor(e){Ke.isAsnEncoded(e)?super(e,Ve):super(e),this.tag=me.PublicKeyTag}async export(...e){let t,i=["verify"],n={hash:"SHA-256",...this.algorithm};e.length>1?(n=e[0]||n,i=e[1]||i,t=e[2]||ae.get()):t=e[0]||ae.get();let s=this.rawData;const a=E.parse(this.rawData,Ve);return a.algorithm.algorithm===cr&&(s=Jh(a,s)),t.subtle.importKey("spki",s,n,!0,i)}onInit(e){const t=le.resolve(Gt),i=this.algorithm=t.toWebAlgorithm(e.algorithm);switch(e.algorithm.algorithm){case bt:{const n=E.parse(e.subjectPublicKey,Do),s=C.toUint8Array(n.modulus);i.publicExponent=C.toUint8Array(n.publicExponent),i.modulusLength=(s[0]?s:s.slice(1)).byteLength<<3;break}}}async getThumbprint(...e){var t;let i,n="SHA-1";return e.length>=1&&!(!((t=e[0])===null||t===void 0)&&t.subtle)?(n=e[0]||n,i=e[1]||ae.get()):i=e[0]||ae.get(),await i.subtle.digest(n,this.rawData)}async getKeyIdentifier(...e){let t,i="SHA-1";e.length===1?typeof e[0]=="string"?(i=e[0],t=ae.get()):t=e[0]:e.length===2?(i=e[0],t=e[1]):t=ae.get();const n=E.parse(this.rawData,Ve);return await t.subtle.digest(i,n.subjectPublicKey)}toTextObject(){const e=this.toTextObjectEmpty(),t=E.parse(this.rawData,Ve);switch(e.Algorithm=St.serializeAlgorithm(t.algorithm),t.algorithm.algorithm){case yr:e["EC Point"]=t.subjectPublicKey;break;case bt:default:e["Raw Data"]=t.subjectPublicKey}return e}}function Jh(r,e){return r.algorithm=new j({algorithm:bt,parameters:null}),e=E.serialize(r),e}class Ar extends Be{static async create(e,t=!1,i=ae.get()){if("name"in e&&"serialNumber"in e)return new Ar(e,t);const s=await(await De.create(e,i)).getKeyIdentifier(i);return new Ar(R.ToHex(s),t)}constructor(...e){if(C.isBufferSource(e[0]))super(e[0]);else if(typeof e[0]=="string"){const t=new ut({keyIdentifier:new go(R.FromHex(e[0]))});super(qn,e[1],E.serialize(t))}else{const t=e[0],i=t.name instanceof br?E.parse(t.name.rawData,ce):t.name,n=new ut({authorityCertIssuer:i,authorityCertSerialNumber:R.FromHex(t.serialNumber)});super(qn,e[1],E.serialize(n))}}onInit(e){super.onInit(e);const t=E.parse(e.extnValue,ut);t.keyIdentifier&&(this.keyId=R.ToHex(t.keyIdentifier)),(t.authorityCertIssuer||t.authorityCertSerialNumber)&&(this.certId={name:t.authorityCertIssuer||[],serialNumber:t.authorityCertSerialNumber?R.ToHex(t.authorityCertSerialNumber):""})}toTextObject(){const e=this.toTextObjectWithoutValue(),t=E.parse(this.value,ut);return t.authorityCertIssuer&&(e["Authority Issuer"]=new br(t.authorityCertIssuer).toTextObject()),t.authorityCertSerialNumber&&(e["Authority Serial Number"]=t.authorityCertSerialNumber),t.keyIdentifier&&(e[""]=t.keyIdentifier),e}}Ar.NAME="Authority Key Identifier";class Au extends Be{constructor(...e){if(C.isBufferSource(e[0])){super(e[0]);const t=E.parse(this.value,Qr);this.ca=t.cA,this.pathLength=t.pathLenConstraint}else{const t=new Qr({cA:e[0],pathLenConstraint:e[1]});super(Ul,e[2],E.serialize(t)),this.ca=e[0],this.pathLength=e[1]}}toTextObject(){const e=this.toTextObjectWithoutValue();return this.ca&&(e.CA=this.ca),this.pathLength!==void 0&&(e["Path Length"]=this.pathLength),e}}Au.NAME="Basic Constraints";var Nc;(function(r){r.serverAuth="1.3.6.1.5.5.7.3.1",r.clientAuth="1.3.6.1.5.5.7.3.2",r.codeSigning="1.3.6.1.5.5.7.3.3",r.emailProtection="1.3.6.1.5.5.7.3.4",r.timeStamping="1.3.6.1.5.5.7.3.8",r.ocspSigning="1.3.6.1.5.5.7.3.9"})(Nc||(Nc={}));class Su extends Be{constructor(...e){if(C.isBufferSource(e[0])){super(e[0]);const t=E.parse(this.value,ti);this.usages=t.map(i=>i)}else{const t=new ti(e[0]);super(Ll,e[1],E.serialize(t)),this.usages=e[0]}}toTextObject(){const e=this.toTextObjectWithoutValue();return e[""]=this.usages.map(t=>ot.toString(t)).join(", "),e}}Su.NAME="Extended Key Usages";var Oc;(function(r){r[r.digitalSignature=1]="digitalSignature",r[r.nonRepudiation=2]="nonRepudiation",r[r.keyEncipherment=4]="keyEncipherment",r[r.dataEncipherment=8]="dataEncipherment",r[r.keyAgreement=16]="keyAgreement",r[r.keyCertSign=32]="keyCertSign",r[r.cRLSign=64]="cRLSign",r[r.encipherOnly=128]="encipherOnly",r[r.decipherOnly=256]="decipherOnly"})(Oc||(Oc={}));class xu extends Be{constructor(...e){if(C.isBufferSource(e[0])){super(e[0]);const t=E.parse(this.value,Cn);this.usages=t.toNumber()}else{const t=new Cn(e[0]);super(Fl,e[1],E.serialize(t)),this.usages=e[0]}}toTextObject(){const e=this.toTextObjectWithoutValue(),t=E.parse(this.value,Cn);return e[""]=t.toJSON().join(", "),e}}xu.NAME="Key Usages";class gn extends Be{static async create(e,t=!1,i=ae.get()){const s=await(await De.create(e,i)).getKeyIdentifier(i);return new gn(R.ToHex(s),t)}constructor(...e){if(C.isBufferSource(e[0])){super(e[0]);const t=E.parse(this.value,tt);this.keyId=R.ToHex(t)}else{const t=typeof e[0]=="string"?R.FromHex(e[0]):e[0],i=new tt(t);super(ql,e[1],E.serialize(i)),this.keyId=R.ToHex(t)}}toTextObject(){const e=this.toTextObjectWithoutValue(),t=E.parse(this.value,tt);return e[""]=t,e}}gn.NAME="Subject Key Identifier";class Bu extends Be{constructor(...e){C.isBufferSource(e[0])?super(e[0]):super(Wl,e[1],new br(e[0]||[]).rawData)}onInit(e){super.onInit(e);const t=E.parse(e.extnValue,cs);this.names=new br(t)}toTextObject(){const e=this.toTextObjectWithoutValue(),t=this.names.toTextObject();for(const i in t)e[i]=t[i];return e}}Bu.NAME="Subject Alternative Name";class Ie{static register(e,t){this.items.set(e,t)}static create(e){const t=new Be(e),i=this.items.get(t.type);return i?new i(e):t}}Ie.items=new Map;class Iu extends Be{constructor(...e){var t;if(C.isBufferSource(e[0])){super(e[0]);const i=E.parse(this.value,Xr);this.policies=i.map(n=>n.policyIdentifier)}else{const i=e[0],n=(t=e[1])!==null&&t!==void 0?t:!1,s=new Xr(i.map(a=>new Wi({policyIdentifier:a})));super($l,n,E.serialize(s)),this.policies=i}}toTextObject(){const e=this.toTextObjectWithoutValue();return e.Policy=this.policies.map(t=>new G("",{},ot.toString(t))),e}}Iu.NAME="Certificate Policies";Ie.register($l,Iu);class ku extends Be{constructor(...e){var t;if(C.isBufferSource(e[0]))super(e[0]);else if(Array.isArray(e[0])&&typeof e[0][0]=="string"){const n=e[0].map(a=>new Jt({distributionPoint:new vt({fullName:[new U({uniformResourceIdentifier:a})]})})),s=new Tt(n);super(Zn,e[1],E.serialize(s))}else{const i=new Tt(e[0]);super(Zn,e[1],E.serialize(i))}(t=this.distributionPoints)!==null&&t!==void 0||(this.distributionPoints=[])}onInit(e){super.onInit(e);const t=E.parse(e.extnValue,Tt);this.distributionPoints=t}toTextObject(){const e=this.toTextObjectWithoutValue();return e["Distribution Point"]=this.distributionPoints.map(t=>{var i;const n={};return t.distributionPoint&&(n[""]=(i=t.distributionPoint.fullName)===null||i===void 0?void 0:i.map(s=>new Xe(s).toString()).join(", ")),t.reasons&&(n.Reasons=t.reasons.toString()),t.cRLIssuer&&(n["CRL Issuer"]=t.cRLIssuer.map(s=>s.toString()).join(", ")),n}),e}}ku.NAME="CRL Distribution Points";class Cu extends Be{constructor(...e){var t,i,n,s;if(C.isBufferSource(e[0]))super(e[0]);else if(e[0]instanceof Ot){const a=new Ot(e[0]);super(Wn,e[1],E.serialize(a))}else{const a=e[0],u=new Ot;Fr(u,a,ha,"ocsp"),Fr(u,a,pa,"caIssuers"),Fr(u,a,da,"timeStamping"),Fr(u,a,ya,"caRepository"),super(Wn,e[1],E.serialize(u))}(t=this.ocsp)!==null&&t!==void 0||(this.ocsp=[]),(i=this.caIssuers)!==null&&i!==void 0||(this.caIssuers=[]),(n=this.timeStamping)!==null&&n!==void 0||(this.timeStamping=[]),(s=this.caRepository)!==null&&s!==void 0||(this.caRepository=[])}onInit(e){super.onInit(e),this.ocsp=[],this.caIssuers=[],this.timeStamping=[],this.caRepository=[],E.parse(e.extnValue,Ot).forEach(i=>{switch(i.accessMethod){case ha:this.ocsp.push(new Xe(i.accessLocation));break;case pa:this.caIssuers.push(new Xe(i.accessLocation));break;case da:this.timeStamping.push(new Xe(i.accessLocation));break;case ya:this.caRepository.push(new Xe(i.accessLocation));break}})}toTextObject(){const e=this.toTextObjectWithoutValue();return this.ocsp.length&&Lr(e,"OCSP",this.ocsp),this.caIssuers.length&&Lr(e,"CA Issuers",this.caIssuers),this.timeStamping.length&&Lr(e,"Time Stamping",this.timeStamping),this.caRepository.length&&Lr(e,"CA Repository",this.caRepository),e}}Cu.NAME="Authority Info Access";function Lr(r,e,t){if(t.length===1)r[e]=t[0].toTextObject();else{const i=new G("");t.forEach((n,s)=>{const a=n.toTextObject(),u=`${a[G.NAME]} ${s+1}`;let l=i[u];Array.isArray(l)||(l=[],i[u]=l),l.push(a)}),r[e]=i}}function Fr(r,e,t,i){const n=e[i];n&&(Array.isArray(n)?n:[n]).forEach(a=>{typeof a=="string"&&(a=new Xe("url",a)),r.push(new Ir({accessMethod:t,accessLocation:E.parse(a.rawData,U)}))})}class rr extends at{constructor(...e){let t;if(C.isBufferSource(e[0]))t=C.toArrayBuffer(e[0]);else{const i=e[0],n=Array.isArray(e[1])?e[1].map(s=>C.toArrayBuffer(s)):[];t=E.serialize(new Ge({type:i,values:n}))}super(t,Ge)}onInit(e){this.type=e.type,this.values=e.values}toTextObject(){const e=this.toTextObjectWithoutValue();return e.Value=this.values.map(t=>new G("",{"":t})),e}toTextObjectWithoutValue(){const e=this.toTextObjectEmpty();return e[G.NAME]===rr.NAME&&(e[G.NAME]=ot.toString(this.type)),e}}rr.NAME="Attribute";class Eu extends rr{constructor(...e){var t;if(C.isBufferSource(e[0]))super(e[0]);else{const i=new Ii({printableString:e[0]});super(yu,[E.serialize(i)])}(t=this.password)!==null&&t!==void 0||(this.password="")}onInit(e){if(super.onInit(e),this.values[0]){const t=E.parse(this.values[0],Ii);this.password=t.toString()}}toTextObject(){const e=this.toTextObjectWithoutValue();return e[G.VALUE]=this.password,e}}Eu.NAME="Challenge Password";class $o extends rr{constructor(...e){var t;if(C.isBufferSource(e[0]))super(e[0]);else{const i=e[0],n=new gt;for(const s of i)n.push(E.parse(s.rawData,Ne));super(Uo,[E.serialize(n)])}(t=this.items)!==null&&t!==void 0||(this.items=[])}onInit(e){if(super.onInit(e),this.values[0]){const t=E.parse(this.values[0],gt);this.items=t.map(i=>Ie.create(E.serialize(i)))}}toTextObject(){const e=this.toTextObjectWithoutValue(),t=this.items.map(i=>i.toTextObject());for(const i of t)e[i[G.NAME]]=i;return e}}$o.NAME="Extensions";class mn{static register(e,t){this.items.set(e,t)}static create(e){const t=new rr(e),i=this.items.get(t.type);return i?new i(e):t}}mn.items=new Map;const bn="crypto.signatureFormatter";class Yh{toAsnSignature(e,t){return C.toArrayBuffer(t)}toWebSignature(e,t){return C.toArrayBuffer(t)}}var qr;let Zs=qr=class{static createPssParams(e,t){const i=qr.getHashAlgorithm(e);return i?new At({hashAlgorithm:i,maskGenAlgorithm:new j({algorithm:cn,parameters:E.serialize(i)}),saltLength:t}):null}static getHashAlgorithm(e){const t=le.resolve(Gt);return typeof e=="string"?t.toAsnAlgorithm({name:e}):typeof e=="object"&&e&&"name"in e?t.toAsnAlgorithm(e):null}toAsnAlgorithm(e){switch(e.name.toLowerCase()){case"rsassa-pkcs1-v1_5":if("hash"in e){let t;if(typeof e.hash=="string")t=e.hash;else if(e.hash&&typeof e.hash=="object"&&"name"in e.hash&&typeof e.hash.name=="string")t=e.hash.name.toUpperCase();else throw new Error("Cannot get hash algorithm name");switch(t.toLowerCase()){case"sha-1":return new j({algorithm:yi,parameters:null});case"sha-256":return new j({algorithm:Ns,parameters:null});case"sha-384":return new j({algorithm:vi,parameters:null});case"sha-512":return new j({algorithm:gi,parameters:null})}}else return new j({algorithm:bt,parameters:null});break;case"rsa-pss":if("hash"in e){if(!("saltLength"in e&&typeof e.saltLength=="number"))throw new Error("Cannot get 'saltLength' from 'alg' argument");const t=qr.createPssParams(e.hash,e.saltLength);if(!t)throw new Error("Cannot create PSS parameters");return new j({algorithm:cr,parameters:E.serialize(t)})}else return new j({algorithm:cr,parameters:null})}return null}toWebAlgorithm(e){switch(e.algorithm){case bt:return{name:"RSASSA-PKCS1-v1_5"};case yi:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case Ns:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case vi:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case gi:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case cr:if(e.parameters){const t=E.parse(e.parameters,At);return{name:"RSA-PSS",hash:le.resolve(Gt).toWebAlgorithm(t.hashAlgorithm),saltLength:t.saltLength}}else return{name:"RSA-PSS"}}return null}};Zs=qr=o([hn()],Zs);le.registerSingleton(Dr,Zs);let Xs=class{toAsnAlgorithm(e){switch(e.name.toLowerCase()){case"sha-1":return new j({algorithm:mi});case"sha-256":return new j({algorithm:bi});case"sha-384":return new j({algorithm:wi});case"sha-512":return new j({algorithm:Ai})}return null}toWebAlgorithm(e){switch(e.algorithm){case mi:return{name:"SHA-1"};case bi:return{name:"SHA-256"};case wi:return{name:"SHA-384"};case Ai:return{name:"SHA-512"}}return null}};Xs=o([hn()],Xs);le.registerSingleton(Dr,Xs);class Ae{addPadding(e,t){const i=C.toUint8Array(t),n=new Uint8Array(e);return n.set(i,e-i.length),n}removePadding(e,t=!1){let i=C.toUint8Array(e);for(let n=0;n<i.length;n++)if(i[n]){i=i.slice(n);break}if(t&&i[0]>127){const n=new Uint8Array(i.length+1);return n.set(i,1),n.buffer}return i.buffer}toAsnSignature(e,t){if(e.name==="ECDSA"){const i=e.namedCurve,n=Ae.namedCurveSize.get(i)||Ae.defaultNamedCurveSize,s=new di,a=C.toUint8Array(t);return s.r=this.removePadding(a.slice(0,n),!0),s.s=this.removePadding(a.slice(n,n+n),!0),E.serialize(s)}return null}toWebSignature(e,t){if(e.name==="ECDSA"){const i=E.parse(t,di),n=e.namedCurve,s=Ae.namedCurveSize.get(n)||Ae.defaultNamedCurveSize,a=this.addPadding(s,this.removePadding(i.r)),u=this.addPadding(s,this.removePadding(i.s));return lf(a,u)}return null}}Ae.namedCurveSize=new Map;Ae.defaultNamedCurveSize=32;const Rn="1.3.101.110",jc="1.3.101.111",Dn="1.3.101.112",Tc="1.3.101.113";let eo=class{toAsnAlgorithm(e){let t=null;switch(e.name.toLowerCase()){case"ed25519":t=Dn;break;case"x25519":t=Rn;break;case"eddsa":switch(e.namedCurve.toLowerCase()){case"ed25519":t=Dn;break;case"ed448":t=Tc;break}break;case"ecdh-es":switch(e.namedCurve.toLowerCase()){case"x25519":t=Rn;break;case"x448":t=jc;break}}return t?new j({algorithm:t}):null}toWebAlgorithm(e){switch(e.algorithm){case Dn:return{name:"Ed25519"};case Tc:return{name:"EdDSA",namedCurve:"Ed448"};case Rn:return{name:"X25519"};case jc:return{name:"ECDH-ES",namedCurve:"X448"}}return null}};eo=o([hn()],eo);le.registerSingleton(Dr,eo);class Qh extends Ke{constructor(e){Ke.isAsnEncoded(e)?super(e,gr):super(e),this.tag=me.CertificateRequestTag}onInit(e){this.tbs=E.serialize(e.certificationRequestInfo),this.publicKey=new De(e.certificationRequestInfo.subjectPKInfo);const t=le.resolve(Gt);this.signatureAlgorithm=t.toWebAlgorithm(e.signatureAlgorithm),this.signature=e.signature,this.attributes=e.certificationRequestInfo.attributes.map(n=>mn.create(E.serialize(n)));const i=this.getAttribute(Uo);this.extensions=[],i instanceof $o&&(this.extensions=i.items),this.subjectName=new rt(e.certificationRequestInfo.subject),this.subject=this.subjectName.toString()}getAttribute(e){for(const t of this.attributes)if(t.type===e)return t;return null}getAttributes(e){return this.attributes.filter(t=>t.type===e)}getExtension(e){for(const t of this.extensions)if(t.type===e)return t;return null}getExtensions(e){return this.extensions.filter(t=>t.type===e)}async verify(e=ae.get()){const t={...this.publicKey.algorithm,...this.signatureAlgorithm},i=await this.publicKey.export(t,["verify"],e),n=le.resolveAll(bn).reverse();let s=null;for(const u of n)if(s=u.toWebSignature(t,this.signature),s)break;if(!s)throw Error("Cannot convert WebCrypto signature value to ASN.1 format");return await e.subtle.verify(this.signatureAlgorithm,i,s,this.tbs)}toTextObject(){const e=this.toTextObjectEmpty(),t=E.parse(this.rawData,gr),i=t.certificationRequestInfo,n=new G("",{Version:`${Dt[i.version]} (${i.version})`,Subject:this.subject,"Subject Public Key Info":this.publicKey});if(this.attributes.length){const s=new G("");for(const a of this.attributes){const u=a.toTextObject();s[u[G.NAME]]=u}n.Attributes=s}return e.Data=n,e.Signature=new G("",{Algorithm:St.serializeAlgorithm(t.signatureAlgorithm),"":t.signature}),e}}Qh.NAME="PKCS#10 Certificate Request";class Nu extends Ke{constructor(e){Ke.isAsnEncoded(e)?super(e,Mt):super(e),this.tag=me.CertificateTag}onInit(e){const t=e.tbsCertificate;this.tbs=E.serialize(t),this.serialNumber=R.ToHex(t.serialNumber),this.subjectName=new rt(t.subject),this.subject=new rt(t.subject).toString(),this.issuerName=new rt(t.issuer),this.issuer=this.issuerName.toString();const i=le.resolve(Gt);this.signatureAlgorithm=i.toWebAlgorithm(e.signatureAlgorithm),this.signature=e.signatureValue;const n=t.validity.notBefore.utcTime||t.validity.notBefore.generalTime;if(!n)throw new Error("Cannot get 'notBefore' value");this.notBefore=n;const s=t.validity.notAfter.utcTime||t.validity.notAfter.generalTime;if(!s)throw new Error("Cannot get 'notAfter' value");this.notAfter=s,this.extensions=[],t.extensions&&(this.extensions=t.extensions.map(a=>Ie.create(E.serialize(a)))),this.publicKey=new De(t.subjectPublicKeyInfo)}getExtension(e){for(const t of this.extensions)if(typeof e=="string"){if(t.type===e)return t}else if(t instanceof e)return t;return null}getExtensions(e){return this.extensions.filter(t=>typeof e=="string"?t.type===e:t instanceof e)}async verify(e={},t=ae.get()){let i,n;const s=e.publicKey;try{if(!s)i={...this.publicKey.algorithm,...this.signatureAlgorithm},n=await this.publicKey.export(i,["verify"],t);else if("publicKey"in s)i={...s.publicKey.algorithm,...this.signatureAlgorithm},n=await s.publicKey.export(i,["verify"],t);else if(s instanceof De)i={...s.algorithm,...this.signatureAlgorithm},n=await s.export(i,["verify"],t);else if(C.isBufferSource(s)){const p=new De(s);i={...p.algorithm,...this.signatureAlgorithm},n=await p.export(i,["verify"],t)}else i={...s.algorithm,...this.signatureAlgorithm},n=s}catch{return!1}const a=le.resolveAll(bn).reverse();let u=null;for(const p of a)if(u=p.toWebSignature(i,this.signature),u)break;if(!u)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");const l=await t.subtle.verify(this.signatureAlgorithm,n,u,this.tbs);if(e.signatureOnly)return l;{const A=(e.date||new Date).getTime();return l&&this.notBefore.getTime()<A&&A<this.notAfter.getTime()}}async getThumbprint(...e){let t,i="SHA-1";return e[0]&&(e[0].subtle?t=e[0]:(i=e[0]||i,t=e[1])),t??(t=ae.get()),await t.subtle.digest(i,this.rawData)}async isSelfSigned(e=ae.get()){return this.subject===this.issuer&&await this.verify({signatureOnly:!0},e)}toTextObject(){const e=this.toTextObjectEmpty(),t=E.parse(this.rawData,Mt),i=t.tbsCertificate,n=new G("",{Version:`${Dt[i.version]} (${i.version})`,"Serial Number":i.serialNumber,"Signature Algorithm":St.serializeAlgorithm(i.signature),Issuer:this.issuer,Validity:new G("",{"Not Before":i.validity.notBefore.getTime(),"Not After":i.validity.notAfter.getTime()}),Subject:this.subject,"Subject Public Key Info":this.publicKey});if(i.issuerUniqueID&&(n["Issuer Unique ID"]=i.issuerUniqueID),i.subjectUniqueID&&(n["Subject Unique ID"]=i.subjectUniqueID),this.extensions.length){const s=new G("");for(const a of this.extensions){const u=a.toTextObject();s[u[G.NAME]]=u}n.Extensions=s}return e.Data=n,e.Signature=new G("",{Algorithm:St.serializeAlgorithm(t.signatureAlgorithm),"":t.signatureValue}),e}}Nu.NAME="Certificate";var Pc;(function(r){r[r.unspecified=0]="unspecified",r[r.keyCompromise=1]="keyCompromise",r[r.cACompromise=2]="cACompromise",r[r.affiliationChanged=3]="affiliationChanged",r[r.superseded=4]="superseded",r[r.cessationOfOperation=5]="cessationOfOperation",r[r.certificateHold=6]="certificateHold",r[r.removeFromCRL=8]="removeFromCRL",r[r.privilegeWithdrawn=9]="privilegeWithdrawn",r[r.aACompromise=10]="aACompromise"})(Pc||(Pc={}));Ie.register(Ul,Au);Ie.register(Ll,Su);Ie.register(Fl,xu);Ie.register(ql,gn);Ie.register(qn,Ar);Ie.register(Wl,Bu);Ie.register(Zn,ku);Ie.register(Wn,Cu);mn.register(yu,Eu);mn.register(Uo,$o);le.registerSingleton(bn,Yh);le.registerSingleton(bn,Ae);Ae.namedCurveSize.set("P-256",32);Ae.namedCurveSize.set("K-256",32);Ae.namedCurveSize.set("P-384",48);Ae.namedCurveSize.set("P-521",66);const Vc=`-----BEGIN CERTIFICATE-----
MIID+zCCAuOgAwIBAgIJAPpM41+Ygd3NMA0GCSqGSIb3DQEBBQUAMIGTMQswCQYD
VQQGEwJVUzEQMA4GA1UECAwHQWxhYmFtYTETMBEGA1UEBwwKTW9udGdvbWVyeTEQ
MA4GA1UECgwHQ29tcGFueTERMA8GA1UECwwIRGl2aXNpb24xFDASBgNVBAMMC2V4
YW1wbGUuY29tMSIwIAYJKoZIhvcNAQkBFhNleGFtcGxlQGV4YW1wbGUuY29tMB4X
DTEyMTAwNDEyNDcxNVoXDTEzMTAwNDEyNDcxNVowgZMxCzAJBgNVBAYTAlVTMRAw
DgYDVQQIDAdBbGFiYW1hMRMwEQYDVQQHDApNb250Z29tZXJ5MRAwDgYDVQQKDAdD
b21wYW55MREwDwYDVQQLDAhEaXZpc2lvbjEUMBIGA1UEAwwLZXhhbXBsZS5jb20x
IjAgBgkqhkiG9w0BCQEWE2V4YW1wbGVAZXhhbXBsZS5jb20wggEiMA0GCSqGSIb3
DQEBAQUAA4IBDwAwggEKAoIBAQCg1v9sHFr/PFvsfmihDjEGLLj2i565QcP6SfTY
MbBvIVzBxggPiR1MsayYSBNVXN0w0brl5tACvf3i0FLJRzbwC+DntJw5SrcruEtv
KWhmtbVOD1ySgMneyN9deIGq32zhYHLRNTcIBWH/eaeB28U2NS8Kjes64K0sChC/
CvhxjCRWlMbYQz4DgoYwIVW4i6oC+mqJHp5alY8PALw2d06nfXyNZ6sZVO6Kvjdl
3BnouC1Ara4TrzQ0/ZIdmpMNoC7sfUr2q78bVLL8aL9SLGzj1D8iL6WV4puTbsCG
qHreDKEp/lM1XQxVcHR5CaACGqwzevcDgduNiSLJ90L/4t8DAgMBAAGjUDBOMB0G
A1UdDgQWBBSd9hMllhV94+3wc6QYb8V+N4IxKjAfBgNVHSMEGDAWgBSd9hMllhV9
4+3wc6QYb8V+N4IxKjAMBgNVHRMEBTADAQH/MA0GCSqGSIb3DQEBBQUAA4IBAQBS
9K+ti1NSU1Ix4JrlyzOHmOwVC78N78f5Hy/OrDehN1XMp6fqRBRAcOATKrpr88u0
xk3Wh0WD+5EA8lGJZ37ev57Bv4xzIi+YykzWLEbo3cIl1WgknaE4vg3TROV5yCJk
dKb5dvSLtYboz0EMsit0ci12yVgLKct55YwriwUlFFjQ7hQ3mmciQaZgtWXBLbx1
pqJoQEir62jjJ1avVHc/PMLhRfnd0VU0XcrAkoM0IZsocHWef4yvUZb1JqDixFjf
iIbOnKy3AsW+QnRsse7eOMsSj5EEwhAsCiXJD0GQFQMZo4Rn3zmBcB4prI+FsTdF
EnNNWeSwYR6zjRDWpr+Y
-----END CERTIFICATE-----`,oy=()=>{const r=Yu(),e=Bn.useRef(null),t=Bn.useRef({certificate:""}),i=()=>{var l;u(Vc),(l=e.current)==null||l.setValue(Vc)},[n,s]=Bn.useState(null),a=()=>{try{const l=new Nu(t.current.certificate),p={serialNumber:l.serialNumber,validFrom:l.notBefore.toString(),validTo:l.notAfter.toString(),subject:Rc(l.subjectName),issuer:Rc(l.issuerName)};s(p),r(Zu())}catch{r(Xu("Invalid certificate"))}},u=l=>{t.current.certificate=l};return L.jsx(ef,{InputToolbar:L.jsxs(rf,{children:[L.jsx(ia,{size:"large",onClick:i,children:"Sample"}),L.jsx(ia,{type:"primary",icon:L.jsx(nf,{}),size:"large",onClick:a,children:"Parse"})]}),InputView:L.jsx(tf,{ref:e,code:t.current.certificate,onChange:u}),OutputView:n===null?L.jsx("div",{className:"h-full min-h-[250px] flex items-center justify-center border border-solid border-gray-300",children:L.jsx(Qu,{})}):L.jsxs(L.Fragment,{children:[L.jsx(Ct.Title,{level:5,children:"General"}),L.jsx(Et,{bordered:!0,className:"mt-2 mb-8",dataSource:[{label:"Serial number",value:n.serialNumber},{label:"Valid from",value:n.validFrom},{label:"Valid to",value:n.validTo}],renderItem:({label:l,value:p})=>L.jsx(Et.Item,{children:L.jsxs("div",{children:[L.jsxs("div",{className:"font-semibold",children:[l,":"]}),p?L.jsx(Ct.Text,{copyable:!0,children:p}):L.jsx(L.Fragment,{})]})})}),L.jsx(Ct.Title,{level:5,children:"Subject"}),L.jsx(Et,{bordered:!0,className:"mt-2 mb-8",dataSource:[{label:"Common name",value:n.subject.commonName},{label:"Organization",value:n.subject.organization},{label:"Organization unit",value:n.subject.organizationUnit},{label:"Country",value:n.subject.country},{label:"State",value:n.subject.state},{label:"City",value:n.subject.city}],renderItem:({label:l,value:p})=>L.jsx(Et.Item,{children:L.jsxs("div",{children:[L.jsxs("div",{className:"font-semibold",children:[l,":"]}),p?L.jsx(Ct.Text,{copyable:!0,children:p}):L.jsx(L.Fragment,{})]})})}),L.jsx(Ct.Title,{level:5,children:"Issuer"}),L.jsx(Et,{bordered:!0,className:"mt-2 mb-8",dataSource:[{label:"Common name",value:n.issuer.commonName},{label:"Organization",value:n.issuer.organization},{label:"Organization unit",value:n.issuer.organizationUnit},{label:"Country",value:n.issuer.country},{label:"State",value:n.issuer.state},{label:"City",value:n.issuer.city}],renderItem:({label:l,value:p})=>L.jsx(Et.Item,{children:L.jsxs("div",{children:[L.jsxs("div",{className:"font-semibold",children:[l,":"]}),p?L.jsx(Ct.Text,{copyable:!0,children:p}):L.jsx(L.Fragment,{})]})})})]})})},Rc=r=>({commonName:r.getField("CN")[0]||"",organization:r.getField("O")[0]||"",organizationUnit:r.getField("OU")[0]||"",country:r.getField("C")[0]||"",state:r.getField("ST")[0]||"",city:r.getField("L")[0]||""});export{oy as default};
