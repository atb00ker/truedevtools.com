import{u as H,r as g,j as t,B as u,P as W,ah as M,s as A}from"./index-B29v6BxU.js";import{I as F}from"./InputOutputLayout.component-BoBRvJwD.js";import{b as p,U as B,R as O,i as x,I as w,a as P}from"./isBase64Valid.utils-CIofl64r.js";import{f as S,B as T}from"./fromBlob-CKbC3pDf.js";import{F as d}from"./index-B1ozlsfn.js";import{S as j}from"./index-DPoiLd4a.js";import{R as z}from"./ArrowRightOutlined-sZDoccLc.js";import{T as b}from"./index-BjvJYsUc.js";import{C}from"./index-tq7hfbY3.js";import"./useForceUpdate-DecOSriV.js";import"./row-BuWWOgRE.js";import"./gapSize-U1swVQyS.js";import"./DownOutlined-DP9_ryZt.js";import"./useBubbleLock-Bi2E1go0.js";import"./index-BsXqFl1l.js";const V=l=>new Promise(s=>{p(l).then(e=>{const r=new Image;r.onload=()=>{s({width:r.width,height:r.height})},r.src=e})}),E=async(l,s,e)=>new Promise(r=>{S(l,void 0,s,e).then(c=>{p(c).then(m=>{r(m)})})}),ei=()=>{const l=H(),[s]=d.useForm(),[e,r]=g.useState({file:null,originalWidth:null,originalHeight:null,width:null,height:null,lockAspectRatio:!0}),[c,m]=g.useState(""),[n,I]=g.useState(null),R=()=>{var f;if(!n)return;let i="png";const o=(f=/^data:image\/\w+;/.exec(n.base64))==null?void 0:f[0];o&&(i=o.slice(11,-1));const a=document.createElement("a");a.href=n.base64;const h=e.file.name.split(".");h.pop(),a.download=`${h.join(".")}.${i}`,a.click()},y=async()=>{if(!e.file){l(M("Need to select an image"));return}let i=e.width,o=e.height;i&&!o?o=Math.round(e.originalHeight/e.originalWidth*i):!i&&o?i=Math.round(e.originalWidth/e.originalHeight*o):!i&&!o&&(i=e.originalWidth,o=e.originalHeight);const a=await E(e.file,i,o);I({base64:a,width:i,height:o}),l(A())},k=async i=>{const o=i.file.originFileObj,a=await p(o),h=await V(o);m(a),r({...e,file:o,originalWidth:h.width,originalHeight:h.height,width:h.width,height:h.height})},N=i=>{e.lockAspectRatio&&(i.width===null||i.height===null)?i={...e,width:null,height:null}:(i={...e,...i},i.lockAspectRatio&&e.file&&(i.width&&!i.height?i.height=Math.round(e.originalHeight/e.originalWidth*i.width):!i.width&&i.height?i.width=Math.round(e.originalWidth/e.originalHeight*i.height):i.width&&i.height?i.width!==e.width?i.height=Math.round(e.originalHeight/e.originalWidth*i.width):i.height!==e.height?i.width=Math.round(e.originalWidth/e.originalHeight*i.height):e.lockAspectRatio||(i.height=Math.round(e.originalHeight/e.originalWidth*i.width)):(i.width=null,i.height=null))),r({...e,...i})};return g.useEffect(()=>{s.setFieldsValue(e)},[s,e]),t.jsx(F,{InputToolbar:t.jsx(j,{children:t.jsx(u,{type:"primary",icon:t.jsx(z,{}),size:"large",onClick:y,children:"Resize"})}),InputView:t.jsxs(d,{form:s,layout:"vertical",size:"large",requiredMark:"optional",initialValues:e,validateMessages:{required:"This field is required"},onValuesChange:N,children:[t.jsx(B,{name:"image",accept:"image/*",listType:"picture-card",showUploadList:!1,onChange:k,customRequest:()=>{},children:t.jsxs("button",{children:[t.jsx(O,{}),t.jsx("div",{className:"mt-2",children:"Select image"})]})}),x(c)&&t.jsx("div",{className:"mt-8 border border-solid border-gray-300 leading-0",children:t.jsx(w,{src:c})}),t.jsxs("div",{className:"flex gap-4",children:[t.jsx(d.Item,{label:"Width",name:"width",className:"mt-8",children:t.jsx(b,{min:1,precision:0,placeholder:"auto",className:"w-full",addonAfter:"px"})}),t.jsx(d.Item,{label:"Height",name:"height",className:"mt-8",children:t.jsx(b,{min:1,precision:0,placeholder:"auto",className:"w-full",addonAfter:"px"})})]}),t.jsx(d.Item,{name:"lockAspectRatio",valuePropName:"checked",children:t.jsx(C,{children:"Lock aspect ratio"})})]}),OutputToolbar:n===null?t.jsx(t.Fragment,{}):t.jsx(j,{children:t.jsx(u,{icon:t.jsx(P,{}),onClick:R,children:"Download"})}),OutputView:n&&x(n.base64)?t.jsx("div",{className:"border border-solid border-gray-300 leading-0",children:t.jsx(T.Ribbon,{color:"green",text:t.jsxs(t.Fragment,{children:["Width: ",n.width,"px",t.jsx("br",{}),"Height: ",n.height,"px"]}),children:t.jsx(w,{src:n.base64})})}):t.jsx("div",{className:"h-full min-h-[250px] flex items-center justify-center border border-solid border-gray-300",children:t.jsx(W,{})})})};export{ei as default};
