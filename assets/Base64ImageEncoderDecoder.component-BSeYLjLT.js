import{u as T,r,j as e,B as d,R as k,P as D,ah as f}from"./index-B29v6BxU.js";import{u as N}from"./useCopyText.hooks-ZnP4Qh_q.js";import{I as $}from"./InputOutputLayout.component-BoBRvJwD.js";import{C as j}from"./CodeEditor.component-B5BAun56.js";import{U as F,R as P,i as l,I as h,a as U,b}from"./isBase64Valid.utils-CIofl64r.js";import{S as y}from"./index-DPoiLd4a.js";import{R as u}from"./index-DcuTae_k.js";import{R as V}from"./ArrowRightOutlined-sZDoccLc.js";import"./editorWorker-CA1WEzK_.js";import"./useForceUpdate-DecOSriV.js";import"./gapSize-U1swVQyS.js";import"./useBubbleLock-Bi2E1go0.js";const X=()=>{const m=T(),I=N(),R=r.useRef(null),s=r.useRef({file:null,base64:""}),[a,v]=r.useState("encode"),[p,x]=r.useState(""),[t,n]=r.useState(null),w=()=>{I(t)},C=()=>{var g;if(!t)return;let o="png";const c=(g=/^data:image\/\w+;/.exec(t))==null?void 0:g[0];c&&(o=c.slice(11,-1));const i=document.createElement("a");i.href=t,i.download=`decoded_image.${o}`,i.click()},E=o=>{s.current={file:null,base64:""},x(""),n(null),v(o.target.value)},O=o=>{s.current.base64=o},S=async()=>{if(a==="decode"){let o=s.current.base64;if(o.includes(";base64,")||(o="data:image/png;base64,"+o),!l(o)){m(f("Invalid base64 text")),n(null);return}n(o)}else{if(!s.current.file){m(f("Need to select an image"));return}const o=await b(s.current.file);n(o)}},B=async o=>{s.current.file=o.file.originFileObj;const c=await b(s.current.file);x(c)};return e.jsx($,{InputToolbar:e.jsxs(y,{children:[e.jsxs(u.Group,{value:a,onChange:E,children:[e.jsx(u,{value:"encode",children:"Encode"}),e.jsx(u,{value:"decode",children:"Decode"})]}),e.jsx(d,{type:"primary",icon:e.jsx(V,{}),size:"large",onClick:S,children:a==="encode"?"Encode":"Decode"})]}),InputView:a==="decode"?e.jsx(j,{ref:R,code:"",language:"text",onChange:O}):e.jsxs(e.Fragment,{children:[e.jsx(F,{name:"image",accept:"image/*",listType:"picture-card",showUploadList:!1,onChange:B,customRequest:()=>{},children:e.jsxs("button",{children:[e.jsx(P,{}),e.jsx("div",{className:"mt-2",children:"Select image"})]})}),l(p)&&e.jsx("div",{className:"mt-8 border border-solid border-gray-300 leading-0",children:e.jsx(h,{src:p})})]}),OutputToolbar:t===null?e.jsx(e.Fragment,{}):e.jsx(y,{children:a==="decode"?e.jsx(d,{icon:e.jsx(U,{}),onClick:C,children:"Download"}):e.jsx(d,{icon:e.jsx(k,{}),onClick:w,children:"Copy"})}),OutputView:a==="decode"?t&&l(t)?e.jsx("div",{className:"border border-solid border-gray-300 leading-0",children:e.jsx(h,{src:t})}):e.jsx("div",{className:"h-full flex items-center justify-center border border-solid border-gray-300",children:e.jsx(D,{})}):e.jsx(j,{code:t,language:"text",readonly:!0})})};export{X as default};
