import{u as z,r as m,j as e,B as g,P as N,ah as C,s as B}from"./index-B29v6BxU.js";import{I as F}from"./InputOutputLayout.component-BoBRvJwD.js";import{b,U as R,R as O,i as f,I as j,a as T}from"./isBase64Valid.utils-CIofl64r.js";import{f as k,B as q}from"./fromBlob-CKbC3pDf.js";import{F as d}from"./index-B1ozlsfn.js";import{S as h}from"./index-DPoiLd4a.js";import{R as P}from"./ArrowRightOutlined-sZDoccLc.js";import{S as E}from"./index-Bpd2N4Oa.js";import{T as M}from"./index-BjvJYsUc.js";import"./useForceUpdate-DecOSriV.js";import"./row-BuWWOgRE.js";import"./gapSize-U1swVQyS.js";import"./DownOutlined-DP9_ryZt.js";const V=async(a,c)=>new Promise(s=>{k(a,1/c*90,void 0,void 0,a.type==="image/webp"?"webp":"jpg").then(o=>{b(o).then(l=>{s({base64:l,compressedSize:o.size})})})}),Z=()=>{const a=z(),[c]=d.useForm(),[s,o]=m.useState({file:null,level:7}),[l,v]=m.useState(""),[i,S]=m.useState(null),w=()=>{var x;if(!i)return;let r="png";const t=(x=/^data:image\/\w+;/.exec(i.base64))==null?void 0:x[0];t&&(r=t.slice(11,-1));const n=document.createElement("a");n.href=i.base64;const u=s.file.name.split(".");u.pop(),n.download=`${u.join(".")}.${r}`,n.click()},I=async()=>{if(!s.file){a(C("Need to select an image"));return}const r=await V(s.file,s.level);S({base64:r.base64,originalSize:s.file.size,compressedSize:r.compressedSize}),a(B())},y=async r=>{const t=r.file.originFileObj,n=await b(t);v(n),o({...s,file:t})},p=r=>{o({...s,level:r})};return e.jsx(F,{InputToolbar:e.jsx(h,{children:e.jsx(g,{type:"primary",icon:e.jsx(P,{}),size:"large",onClick:I,children:"Compress"})}),InputView:e.jsxs(d,{form:c,layout:"vertical",size:"large",requiredMark:"optional",initialValues:s,validateMessages:{required:"This field is required"},children:[e.jsx(R,{name:"image",accept:"image/*",listType:"picture-card",showUploadList:!1,onChange:y,customRequest:()=>{},children:e.jsxs("button",{children:[e.jsx(O,{}),e.jsx("div",{className:"mt-2",children:"Select image"})]})}),f(l)&&e.jsx("div",{className:"mt-8 border border-solid border-gray-300 leading-0",children:e.jsx(j,{src:l})}),e.jsx(d.Item,{label:"Compression level",name:"level",rules:[{required:!0}],className:"mt-8",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"grow",children:e.jsx(E,{min:1,max:10,value:s.level,onChange:p})}),e.jsx("div",{className:"basis-16",children:e.jsx(M,{min:1,max:10,value:s.level,onChange:p})})]})})]}),OutputToolbar:i===null?e.jsx(e.Fragment,{}):e.jsx(h,{children:e.jsx(g,{icon:e.jsx(T,{}),onClick:w,children:"Download"})}),OutputView:i&&f(i.base64)?e.jsx("div",{className:"border border-solid border-gray-300 leading-0",children:e.jsx(q.Ribbon,{color:"green",text:e.jsxs(e.Fragment,{children:[i.compressedSize>=i.originalSize?e.jsx(e.Fragment,{}):e.jsxs(e.Fragment,{children:["Saving: ",100-Math.floor(i.compressedSize*100/i.originalSize),"%",e.jsx("br",{})]}),"New size: ",Math.floor(i.compressedSize/1e3)," KB"]}),children:e.jsx(j,{src:i.base64})})}):e.jsx("div",{className:"h-full min-h-[250px] flex items-center justify-center border border-solid border-gray-300",children:e.jsx(N,{})})})};export{Z as default};
